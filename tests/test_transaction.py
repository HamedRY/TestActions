import unittest
import sys, os
import json
sys.path.append(os.getcwd())
os.environ['APP_RUN_ENV'] = 'development'

from services import transaction_service

class TransacrionTests(unittest.TestCase):
    # def __init__(self):
    #     pass
    def test_get_funded_accounts_mutation_0(self):
        task = transaction_service.get_funded_accounts.s(
            1611874800, None
        ).apply()
        self.assertEqual(task.result, {"total_elements": 13, "content": [{"_id": "6013f191d7b676a9305f3e39"}, {"_id": "6013f191d7b676a9305f3e38"}, {"_id": "6013f191d7b676a9305f3e36"}, {"_id": "6013f191d7b676a9305f3e35"}, {"_id": "6013f191d7b676a9305f3e34"}, {"_id": "6013f191d7b676a9305f3e32"}, {"_id": "6013f191d7b676a9305f3e31"}, {"_id": "6013f191d7b676a9305f3e30"}, {"_id": "6013f191d7b676a9305f3e2e"}, {"_id": "6013f191d7b676a9305f3e2d"}, {"_id": "6013f191d7b676a9305f3e2c"}, {"_id": "6013f191d7b676a9305f3e25"}, {"_id": "6013f191d7b676a9305f3e13"}]})

    def test_get_lost_accounts_count_mutation_0(self):
        task = transaction_service.get_lost_accounts_count.s(
            begin=None, end=None
        ).apply()
        self.assertEqual(task.result, [{"_id": "Lost accounts", "count": 1}])

    def test_get_funded_accounts_count_mutation_0(self):
        task = transaction_service.get_funded_accounts_count.s(
            begin=None, end=None
        ).apply()
        self.assertEqual(task.result, [{"_id": "Funded accounts", "count": 14}, {"_id": "Zero accounts", "count": 0}])

    def test_get_deposits_amount_mutation_0(self):
        task = transaction_service.get_deposits_amount.s(
            begin=None, end=None
        ).apply()
        self.assertEqual(task.result, {"deposit_count": 200, "deposit_total": 141900.0, "deposit_fee": 283.8})

    def test_get_withdrawals_amount_mutation_0(self):
        task = transaction_service.get_withdrawals_amount.s(
            begin=None, end=None
        ).apply()
        self.assertEqual(task.result, {"withdrawal_count": 21, "withdrawal_total": 8632.15, "withdrawal_fee": 129.48225})

    def test_get_periodical_transaction_amount_mutation_0(self):
        task = transaction_service.get_periodical_transaction_amount.s(
            type_='deposit'
        ).apply()
        self.assertEqual(task.result, {"daily": [{"date": "2020-11-28", "value": 250.0, "count": 3}, {"date": "2020-11-29", "value": 50.0, "count": 1}, {"date": "2020-11-30", "value": 450.0, "count": 1}, {"date": "2020-12-01", "value": 50.0, "count": 1}, {"date": "2020-12-06", "value": 100.0, "count": 1}, {"date": "2020-12-08", "value": 750.0, "count": 1}, {"date": "2020-12-09", "value": 2050.0, "count": 4}, {"date": "2020-12-10", "value": 200.0, "count": 3}, {"date": "2020-12-11", "value": 500.0, "count": 1}, {"date": "2020-12-12", "value": 250.0, "count": 3}, {"date": "2020-12-13", "value": 1000.0, "count": 2}, {"date": "2020-12-14", "value": 300.0, "count": 1}, {"date": "2020-12-15", "value": 300.0, "count": 3}, {"date": "2020-12-18", "value": 450.0, "count": 2}, {"date": "2020-12-22", "value": 100.0, "count": 1}, {"date": "2020-12-23", "value": 100.0, "count": 1}, {"date": "2020-12-25", "value": 100.0, "count": 1}, {"date": "2020-12-27", "value": 400.0, "count": 1}, {"date": "2020-12-29", "value": 100.0, "count": 1}, {"date": "2020-12-31", "value": 900.0, "count": 1}, {"date": "2021-01-04", "value": 150.0, "count": 2}, {"date": "2021-01-05", "value": 350.0, "count": 3}, {"date": "2021-01-06", "value": 4950.0, "count": 4}, {"date": "2021-01-07", "value": 1000.0, "count": 4}, {"date": "2021-01-09", "value": 11750.0, "count": 1}, {"date": "2021-01-10", "value": 150.0, "count": 2}, {"date": "2021-01-11", "value": 250.0, "count": 3}, {"date": "2021-01-14", "value": 1600.0, "count": 1}, {"date": "2021-01-16", "value": 200.0, "count": 2}, {"date": "2021-01-20", "value": 50.0, "count": 1}, {"date": "2021-01-23", "value": 250.0, "count": 1}, {"date": "2021-01-24", "value": 50.0, "count": 1}, {"date": "2021-01-26", "value": 200.0, "count": 1}, {"date": "2021-01-27", "value": 800.0, "count": 5}, {"date": "2021-01-28", "value": 150.0, "count": 2}, {"date": "2021-01-29", "value": 150.0, "count": 2}, {"date": "2021-01-30", "value": 1150.0, "count": 1}, {"date": "2021-01-31", "value": 500.0, "count": 5}, {"date": "2021-02-01", "value": 800.0, "count": 3}, {"date": "2021-02-03", "value": 19400.0, "count": 2}, {"date": "2021-02-04", "value": 1100.0, "count": 3}, {"date": "2021-02-05", "value": 1600.0, "count": 4}, {"date": "2021-02-06", "value": 150.0, "count": 3}, {"date": "2021-02-07", "value": 10400.0, "count": 4}, {"date": "2021-02-08", "value": 10750.0, "count": 7}, {"date": "2021-02-09", "value": 2700.0, "count": 9}, {"date": "2021-02-10", "value": 14750.0, "count": 7}, {"date": "2021-02-11", "value": 5350.0, "count": 5}, {"date": "2021-02-12", "value": 19700.0, "count": 5}, {"date": "2021-02-13", "value": 4100.0, "count": 6}, {"date": "2021-02-14", "value": 350.0, "count": 2}, {"date": "2021-02-15", "value": 3000.0, "count": 4}, {"date": "2021-02-16", "value": 2750.0, "count": 3}, {"date": "2021-02-17", "value": 50.0, "count": 1}, {"date": "2021-02-18", "value": 100.0, "count": 2}, {"date": "2021-02-19", "value": 50.0, "count": 1}, {"date": "2021-02-20", "value": 850.0, "count": 3}, {"date": "2021-02-21", "value": 350.0, "count": 4}, {"date": "2021-02-22", "value": 350.0, "count": 1}, {"date": "2021-02-24", "value": 450.0, "count": 1}, {"date": "2021-02-26", "value": 50.0, "count": 1}, {"date": "2021-02-27", "value": 950.0, "count": 2}, {"date": "2021-02-28", "value": 550.0, "count": 7}, {"date": "2021-03-01", "value": 250.0, "count": 4}, {"date": "2021-03-02", "value": 1200.0, "count": 2}, {"date": "2021-03-03", "value": 1800.0, "count": 6}, {"date": "2021-03-04", "value": 750.0, "count": 3}, {"date": "2021-03-05", "value": 250.0, "count": 2}, {"date": "2021-03-06", "value": 100.0, "count": 2}, {"date": "2021-03-07", "value": 1900.0, "count": 4}, {"date": "2021-03-08", "value": 350.0, "count": 2}, {"date": "2021-03-09", "value": 650.0, "count": 3}, {"date": "2021-03-10", "value": 550.0, "count": 2}, {"date": "2021-03-12", "value": 1200.0, "count": 4}, {"date": "2021-03-15", "value": 50.0, "count": 1}, {"date": "2021-03-17", "value": 100.0, "count": 1}], "weekly": [{"date": "2020-11-30", "value": 750.0, "count": 5}, {"date": "2020-12-07", "value": 150.0, "count": 2}, {"date": "2020-12-14", "value": 5050.0, "count": 15}, {"date": "2020-12-21", "value": 750.0, "count": 5}, {"date": "2020-12-28", "value": 700.0, "count": 4}, {"date": "2021-01-04", "value": 1150.0, "count": 4}, {"date": "2021-01-11", "value": 18450.0, "count": 17}, {"date": "2021-01-18", "value": 1800.0, "count": 3}, {"date": "2021-01-25", "value": 350.0, "count": 3}, {"date": "2021-02-01", "value": 3750.0, "count": 19}, {"date": "2021-02-08", "value": 43400.0, "count": 23}, {"date": "2021-02-15", "value": 49950.0, "count": 38}, {"date": "2021-02-22", "value": 4500.0, "count": 15}, {"date": "2021-03-01", "value": 2250.0, "count": 15}, {"date": "2021-03-08", "value": 6350.0, "count": 21}, {"date": "2021-03-15", "value": 2450.0, "count": 10}, {"date": "2021-03-22", "value": 100.0, "count": 1}], "monthly": [{"date": "February", "value": 100650.0, "count": 90}, {"date": "January", "value": 23700.0, "count": 41}, {"date": "March", "value": 9150.0, "count": 36}], "yearly": [{"date": "2020", "value": 8400.0, "count": 33}, {"date": "2021", "value": 133500.0, "count": 167}]})

    def test_get_periodical_transaction_amount_mutation_0(self):
        task = transaction_service.get_periodical_transaction_amount.s(
            type_='withdrwal'
        ).apply()
        self.assertEqual(task.result, {"daily": [{"date": "2021-02-25", "value": 35.1, "count": 1}, {"date": "2021-04-09", "value": 190.24, "count": 1}, {"date": "2021-05-17", "value": 89.75, "count": 1}, {"date": "2021-06-02", "value": 1051.88, "count": 1}, {"date": "2021-06-07", "value": 635.03, "count": 1}, {"date": "2021-07-08", "value": 347.98, "count": 1}, {"date": "2021-07-26", "value": 80.84, "count": 1}, {"date": "2021-08-27", "value": 183.2, "count": 1}, {"date": "2021-09-08", "value": 627.45, "count": 2}, {"date": "2021-09-26", "value": 480.56, "count": 1}, {"date": "2021-10-15", "value": 124.17, "count": 1}, {"date": "2021-10-16", "value": 2909.76, "count": 1}, {"date": "2021-10-20", "value": 312.47, "count": 1}, {"date": "2021-10-25", "value": 43.18, "count": 1}, {"date": "2021-11-12", "value": 34.89, "count": 1}, {"date": "2021-12-01", "value": 455.73, "count": 1}, {"date": "2021-12-07", "value": 241.87, "count": 1}, {"date": "2021-12-18", "value": 45.58, "count": 1}, {"date": "2022-01-01", "value": 418.18, "count": 1}, {"date": "2022-01-24", "value": 324.29, "count": 1}], "weekly": [{"date": "2021-03-01", "value": 35.1, "count": 1}, {"date": "2021-03-08", "value": 0.0, "count": 0}, {"date": "2021-03-15", "value": 0.0, "count": 0}, {"date": "2021-03-22", "value": 0.0, "count": 0}, {"date": "2021-03-29", "value": 0.0, "count": 0}, {"date": "2021-04-05", "value": 0.0, "count": 0}, {"date": "2021-04-12", "value": 190.24, "count": 1}, {"date": "2021-04-19", "value": 0.0, "count": 0}, {"date": "2021-04-26", "value": 0.0, "count": 0}, {"date": "2021-05-03", "value": 0.0, "count": 0}, {"date": "2021-05-10", "value": 0.0, "count": 0}, {"date": "2021-05-17", "value": 89.75, "count": 1}, {"date": "2021-05-24", "value": 0.0, "count": 0}, {"date": "2021-05-31", "value": 0.0, "count": 0}, {"date": "2021-06-07", "value": 1686.91, "count": 2}, {"date": "2021-06-14", "value": 0.0, "count": 0}, {"date": "2021-06-21", "value": 0.0, "count": 0}, {"date": "2021-06-28", "value": 0.0, "count": 0}, {"date": "2021-07-05", "value": 0.0, "count": 0}, {"date": "2021-07-12", "value": 347.98, "count": 1}, {"date": "2021-07-19", "value": 0.0, "count": 0}, {"date": "2021-07-26", "value": 80.84, "count": 1}, {"date": "2021-08-02", "value": 0.0, "count": 0}, {"date": "2021-08-09", "value": 0.0, "count": 0}, {"date": "2021-08-16", "value": 0.0, "count": 0}, {"date": "2021-08-23", "value": 0.0, "count": 0}, {"date": "2021-08-30", "value": 183.2, "count": 1}, {"date": "2021-09-06", "value": 0.0, "count": 0}, {"date": "2021-09-13", "value": 627.45, "count": 2}, {"date": "2021-09-20", "value": 0.0, "count": 0}, {"date": "2021-09-27", "value": 480.56, "count": 1}, {"date": "2021-10-04", "value": 0.0, "count": 0}, {"date": "2021-10-11", "value": 0.0, "count": 0}, {"date": "2021-10-18", "value": 3033.9300000000003, "count": 2}, {"date": "2021-10-25", "value": 355.65000000000003, "count": 2}, {"date": "2021-11-01", "value": 0.0, "count": 0}, {"date": "2021-11-08", "value": 0.0, "count": 0}, {"date": "2021-11-15", "value": 34.89, "count": 1}, {"date": "2021-11-22", "value": 0.0, "count": 0}, {"date": "2021-11-29", "value": 0.0, "count": 0}, {"date": "2021-12-06", "value": 455.73, "count": 1}, {"date": "2021-12-13", "value": 241.87, "count": 1}, {"date": "2021-12-20", "value": 45.58, "count": 1}, {"date": "2021-12-27", "value": 0.0, "count": 0}, {"date": "2022-01-03", "value": 418.18, "count": 1}, {"date": "2022-01-10", "value": 0.0, "count": 0}, {"date": "2022-01-17", "value": 0.0, "count": 0}, {"date": "2022-01-24", "value": 324.29, "count": 1}], "monthly": [{"date": "April", "value": 190.24, "count": 1}, {"date": "August", "value": 183.2, "count": 1}, {"date": "December", "value": 743.1800000000001, "count": 3}, {"date": "February", "value": 35.1, "count": 1}, {"date": "January", "value": 742.47, "count": 2}, {"date": "July", "value": 428.82000000000005, "count": 2}, {"date": "June", "value": 1686.91, "count": 2}, {"date": "May", "value": 89.75, "count": 1}, {"date": "November", "value": 34.89, "count": 1}, {"date": "October", "value": 3389.5800000000004, "count": 4}, {"date": "September", "value": 1108.01, "count": 3}], "yearly": [{"date": "2021", "value": 7889.680000000001, "count": 19}, {"date": "2022", "value": 742.47, "count": 2}]})

    def test_get_periodical_transaction_amount_mutation_0(self):
        task = transaction_service.get_periodical_transaction_amount.s(
            type_='withdrwal'
        ).apply()
        self.assertEqual(task.result, {"daily": [{"date": "2021-02-25", "value": 35.1, "count": 1}, {"date": "2021-04-09", "value": 190.24, "count": 1}, {"date": "2021-05-17", "value": 89.75, "count": 1}, {"date": "2021-06-02", "value": 1051.88, "count": 1}, {"date": "2021-06-07", "value": 635.03, "count": 1}, {"date": "2021-07-08", "value": 347.98, "count": 1}, {"date": "2021-07-26", "value": 80.84, "count": 1}, {"date": "2021-08-27", "value": 183.2, "count": 1}, {"date": "2021-09-08", "value": 627.45, "count": 2}, {"date": "2021-09-26", "value": 480.56, "count": 1}, {"date": "2021-10-15", "value": 124.17, "count": 1}, {"date": "2021-10-16", "value": 2909.76, "count": 1}, {"date": "2021-10-20", "value": 312.47, "count": 1}, {"date": "2021-10-25", "value": 43.18, "count": 1}, {"date": "2021-11-12", "value": 34.89, "count": 1}, {"date": "2021-12-01", "value": 455.73, "count": 1}, {"date": "2021-12-07", "value": 241.87, "count": 1}, {"date": "2021-12-18", "value": 45.58, "count": 1}, {"date": "2022-01-01", "value": 418.18, "count": 1}, {"date": "2022-01-24", "value": 324.29, "count": 1}], "weekly": [{"date": "2021-03-01", "value": 35.1, "count": 1}, {"date": "2021-03-08", "value": 0.0, "count": 0}, {"date": "2021-03-15", "value": 0.0, "count": 0}, {"date": "2021-03-22", "value": 0.0, "count": 0}, {"date": "2021-03-29", "value": 0.0, "count": 0}, {"date": "2021-04-05", "value": 0.0, "count": 0}, {"date": "2021-04-12", "value": 190.24, "count": 1}, {"date": "2021-04-19", "value": 0.0, "count": 0}, {"date": "2021-04-26", "value": 0.0, "count": 0}, {"date": "2021-05-03", "value": 0.0, "count": 0}, {"date": "2021-05-10", "value": 0.0, "count": 0}, {"date": "2021-05-17", "value": 89.75, "count": 1}, {"date": "2021-05-24", "value": 0.0, "count": 0}, {"date": "2021-05-31", "value": 0.0, "count": 0}, {"date": "2021-06-07", "value": 1686.91, "count": 2}, {"date": "2021-06-14", "value": 0.0, "count": 0}, {"date": "2021-06-21", "value": 0.0, "count": 0}, {"date": "2021-06-28", "value": 0.0, "count": 0}, {"date": "2021-07-05", "value": 0.0, "count": 0}, {"date": "2021-07-12", "value": 347.98, "count": 1}, {"date": "2021-07-19", "value": 0.0, "count": 0}, {"date": "2021-07-26", "value": 80.84, "count": 1}, {"date": "2021-08-02", "value": 0.0, "count": 0}, {"date": "2021-08-09", "value": 0.0, "count": 0}, {"date": "2021-08-16", "value": 0.0, "count": 0}, {"date": "2021-08-23", "value": 0.0, "count": 0}, {"date": "2021-08-30", "value": 183.2, "count": 1}, {"date": "2021-09-06", "value": 0.0, "count": 0}, {"date": "2021-09-13", "value": 627.45, "count": 2}, {"date": "2021-09-20", "value": 0.0, "count": 0}, {"date": "2021-09-27", "value": 480.56, "count": 1}, {"date": "2021-10-04", "value": 0.0, "count": 0}, {"date": "2021-10-11", "value": 0.0, "count": 0}, {"date": "2021-10-18", "value": 3033.9300000000003, "count": 2}, {"date": "2021-10-25", "value": 355.65000000000003, "count": 2}, {"date": "2021-11-01", "value": 0.0, "count": 0}, {"date": "2021-11-08", "value": 0.0, "count": 0}, {"date": "2021-11-15", "value": 34.89, "count": 1}, {"date": "2021-11-22", "value": 0.0, "count": 0}, {"date": "2021-11-29", "value": 0.0, "count": 0}, {"date": "2021-12-06", "value": 455.73, "count": 1}, {"date": "2021-12-13", "value": 241.87, "count": 1}, {"date": "2021-12-20", "value": 45.58, "count": 1}, {"date": "2021-12-27", "value": 0.0, "count": 0}, {"date": "2022-01-03", "value": 418.18, "count": 1}, {"date": "2022-01-10", "value": 0.0, "count": 0}, {"date": "2022-01-17", "value": 0.0, "count": 0}, {"date": "2022-01-24", "value": 324.29, "count": 1}], "monthly": [{"date": "April", "value": 190.24, "count": 1}, {"date": "August", "value": 183.2, "count": 1}, {"date": "December", "value": 743.1800000000001, "count": 3}, {"date": "February", "value": 35.1, "count": 1}, {"date": "January", "value": 742.47, "count": 2}, {"date": "July", "value": 428.82000000000005, "count": 2}, {"date": "June", "value": 1686.91, "count": 2}, {"date": "May", "value": 89.75, "count": 1}, {"date": "November", "value": 34.89, "count": 1}, {"date": "October", "value": 3389.5800000000004, "count": 4}, {"date": "September", "value": 1108.01, "count": 3}], "yearly": [{"date": "2021", "value": 7889.680000000001, "count": 19}, {"date": "2022", "value": 742.47, "count": 2}]})

    def test_get_periodical_transaction_amount_mutation_0(self):
        task = transaction_service.get_periodical_transaction_amount.s(
            type_='deposit'
        ).apply()
        self.assertEqual(task.result, {"daily": [{"date": "2020-11-28", "value": 250.0, "count": 3}, {"date": "2020-11-29", "value": 50.0, "count": 1}, {"date": "2020-11-30", "value": 450.0, "count": 1}, {"date": "2020-12-01", "value": 50.0, "count": 1}, {"date": "2020-12-06", "value": 100.0, "count": 1}, {"date": "2020-12-08", "value": 750.0, "count": 1}, {"date": "2020-12-09", "value": 2050.0, "count": 4}, {"date": "2020-12-10", "value": 200.0, "count": 3}, {"date": "2020-12-11", "value": 500.0, "count": 1}, {"date": "2020-12-12", "value": 250.0, "count": 3}, {"date": "2020-12-13", "value": 1000.0, "count": 2}, {"date": "2020-12-14", "value": 300.0, "count": 1}, {"date": "2020-12-15", "value": 300.0, "count": 3}, {"date": "2020-12-18", "value": 450.0, "count": 2}, {"date": "2020-12-22", "value": 100.0, "count": 1}, {"date": "2020-12-23", "value": 100.0, "count": 1}, {"date": "2020-12-25", "value": 100.0, "count": 1}, {"date": "2020-12-27", "value": 400.0, "count": 1}, {"date": "2020-12-29", "value": 100.0, "count": 1}, {"date": "2020-12-31", "value": 900.0, "count": 1}, {"date": "2021-01-04", "value": 150.0, "count": 2}, {"date": "2021-01-05", "value": 350.0, "count": 3}, {"date": "2021-01-06", "value": 4950.0, "count": 4}, {"date": "2021-01-07", "value": 1000.0, "count": 4}, {"date": "2021-01-09", "value": 11750.0, "count": 1}, {"date": "2021-01-10", "value": 150.0, "count": 2}, {"date": "2021-01-11", "value": 250.0, "count": 3}, {"date": "2021-01-14", "value": 1600.0, "count": 1}, {"date": "2021-01-16", "value": 200.0, "count": 2}, {"date": "2021-01-20", "value": 50.0, "count": 1}, {"date": "2021-01-23", "value": 250.0, "count": 1}, {"date": "2021-01-24", "value": 50.0, "count": 1}, {"date": "2021-01-26", "value": 200.0, "count": 1}, {"date": "2021-01-27", "value": 800.0, "count": 5}, {"date": "2021-01-28", "value": 150.0, "count": 2}, {"date": "2021-01-29", "value": 150.0, "count": 2}, {"date": "2021-01-30", "value": 1150.0, "count": 1}, {"date": "2021-01-31", "value": 500.0, "count": 5}, {"date": "2021-02-01", "value": 800.0, "count": 3}, {"date": "2021-02-03", "value": 19400.0, "count": 2}, {"date": "2021-02-04", "value": 1100.0, "count": 3}, {"date": "2021-02-05", "value": 1600.0, "count": 4}, {"date": "2021-02-06", "value": 150.0, "count": 3}, {"date": "2021-02-07", "value": 10400.0, "count": 4}, {"date": "2021-02-08", "value": 10750.0, "count": 7}, {"date": "2021-02-09", "value": 2700.0, "count": 9}, {"date": "2021-02-10", "value": 14750.0, "count": 7}, {"date": "2021-02-11", "value": 5350.0, "count": 5}, {"date": "2021-02-12", "value": 19700.0, "count": 5}, {"date": "2021-02-13", "value": 4100.0, "count": 6}, {"date": "2021-02-14", "value": 350.0, "count": 2}, {"date": "2021-02-15", "value": 3000.0, "count": 4}, {"date": "2021-02-16", "value": 2750.0, "count": 3}, {"date": "2021-02-17", "value": 50.0, "count": 1}, {"date": "2021-02-18", "value": 100.0, "count": 2}, {"date": "2021-02-19", "value": 50.0, "count": 1}, {"date": "2021-02-20", "value": 850.0, "count": 3}, {"date": "2021-02-21", "value": 350.0, "count": 4}, {"date": "2021-02-22", "value": 350.0, "count": 1}, {"date": "2021-02-24", "value": 450.0, "count": 1}, {"date": "2021-02-26", "value": 50.0, "count": 1}, {"date": "2021-02-27", "value": 950.0, "count": 2}, {"date": "2021-02-28", "value": 550.0, "count": 7}, {"date": "2021-03-01", "value": 250.0, "count": 4}, {"date": "2021-03-02", "value": 1200.0, "count": 2}, {"date": "2021-03-03", "value": 1800.0, "count": 6}, {"date": "2021-03-04", "value": 750.0, "count": 3}, {"date": "2021-03-05", "value": 250.0, "count": 2}, {"date": "2021-03-06", "value": 100.0, "count": 2}, {"date": "2021-03-07", "value": 1900.0, "count": 4}, {"date": "2021-03-08", "value": 350.0, "count": 2}, {"date": "2021-03-09", "value": 650.0, "count": 3}, {"date": "2021-03-10", "value": 550.0, "count": 2}, {"date": "2021-03-12", "value": 1200.0, "count": 4}, {"date": "2021-03-15", "value": 50.0, "count": 1}, {"date": "2021-03-17", "value": 100.0, "count": 1}], "weekly": [{"date": "2020-11-30", "value": 750.0, "count": 5}, {"date": "2020-12-07", "value": 150.0, "count": 2}, {"date": "2020-12-14", "value": 5050.0, "count": 15}, {"date": "2020-12-21", "value": 750.0, "count": 5}, {"date": "2020-12-28", "value": 700.0, "count": 4}, {"date": "2021-01-04", "value": 1150.0, "count": 4}, {"date": "2021-01-11", "value": 18450.0, "count": 17}, {"date": "2021-01-18", "value": 1800.0, "count": 3}, {"date": "2021-01-25", "value": 350.0, "count": 3}, {"date": "2021-02-01", "value": 3750.0, "count": 19}, {"date": "2021-02-08", "value": 43400.0, "count": 23}, {"date": "2021-02-15", "value": 49950.0, "count": 38}, {"date": "2021-02-22", "value": 4500.0, "count": 15}, {"date": "2021-03-01", "value": 2250.0, "count": 15}, {"date": "2021-03-08", "value": 6350.0, "count": 21}, {"date": "2021-03-15", "value": 2450.0, "count": 10}, {"date": "2021-03-22", "value": 100.0, "count": 1}], "monthly": [{"date": "February", "value": 100650.0, "count": 90}, {"date": "January", "value": 23700.0, "count": 41}, {"date": "March", "value": 9150.0, "count": 36}], "yearly": [{"date": "2020", "value": 8400.0, "count": 33}, {"date": "2021", "value": 133500.0, "count": 167}]})

    def test_join_periodic_mutation_0(self):
        task = transaction_service.join_periodic.s(
            {'daily': [{'date': '2020-11-28', 'value': 250.0, 'count': 3}, {'date': '2020-11-29', 'value': 50.0, 'count': 1}, {'date': '2020-11-30', 'value': 450.0, 'count': 1}, {'date': '2020-12-01', 'value': 50.0, 'count': 1}, {'date': '2020-12-06', 'value': 100.0, 'count': 1}, {'date': '2020-12-08', 'value': 750.0, 'count': 1}, {'date': '2020-12-09', 'value': 2050.0, 'count': 4}, {'date': '2020-12-10', 'value': 200.0, 'count': 3}, {'date': '2020-12-11', 'value': 500.0, 'count': 1}, {'date': '2020-12-12', 'value': 250.0, 'count': 3}, {'date': '2020-12-13', 'value': 1000.0, 'count': 2}, {'date': '2020-12-14', 'value': 300.0, 'count': 1}, {'date': '2020-12-15', 'value': 300.0, 'count': 3}, {'date': '2020-12-18', 'value': 450.0, 'count': 2}, {'date': '2020-12-22', 'value': 100.0, 'count': 1}, {'date': '2020-12-23', 'value': 100.0, 'count': 1}, {'date': '2020-12-25', 'value': 100.0, 'count': 1}, {'date': '2020-12-27', 'value': 400.0, 'count': 1}, {'date': '2020-12-29', 'value': 100.0, 'count': 1}, {'date': '2020-12-31', 'value': 900.0, 'count': 1}, {'date': '2021-01-04', 'value': 150.0, 'count': 2}, {'date': '2021-01-05', 'value': 350.0, 'count': 3}, {'date': '2021-01-06', 'value': 4950.0, 'count': 4}, {'date': '2021-01-07', 'value': 1000.0, 'count': 4}, {'date': '2021-01-09', 'value': 11750.0, 'count': 1}, {'date': '2021-01-10', 'value': 150.0, 'count': 2}, {'date': '2021-01-11', 'value': 250.0, 'count': 3}, {'date': '2021-01-14', 'value': 1600.0, 'count': 1}, {'date': '2021-01-16', 'value': 200.0, 'count': 2}, {'date': '2021-01-20', 'value': 50.0, 'count': 1}, {'date': '2021-01-23', 'value': 250.0, 'count': 1}, {'date': '2021-01-24', 'value': 50.0, 'count': 1}, {'date': '2021-01-26', 'value': 200.0, 'count': 1}, {'date': '2021-01-27', 'value': 800.0, 'count': 5}, {'date': '2021-01-28', 'value': 150.0, 'count': 2}, {'date': '2021-01-29', 'value': 150.0, 'count': 2}, {'date': '2021-01-30', 'value': 1150.0, 'count': 1}, {'date': '2021-01-31', 'value': 500.0, 'count': 5}, {'date': '2021-02-01', 'value': 800.0, 'count': 3}, {'date': '2021-02-03', 'value': 19400.0, 'count': 2}, {'date': '2021-02-04', 'value': 1100.0, 'count': 3}, {'date': '2021-02-05', 'value': 1600.0, 'count': 4}, {'date': '2021-02-06', 'value': 150.0, 'count': 3}, {'date': '2021-02-07', 'value': 10400.0, 'count': 4}, {'date': '2021-02-08', 'value': 10750.0, 'count': 7}, {'date': '2021-02-09', 'value': 2700.0, 'count': 9}, {'date': '2021-02-10', 'value': 14750.0, 'count': 7}, {'date': '2021-02-11', 'value': 5350.0, 'count': 5}, {'date': '2021-02-12', 'value': 19700.0, 'count': 5}, {'date': '2021-02-13', 'value': 4100.0, 'count': 6}, {'date': '2021-02-14', 'value': 350.0, 'count': 2}, {'date': '2021-02-15', 'value': 3000.0, 'count': 4}, {'date': '2021-02-16', 'value': 2750.0, 'count': 3}, {'date': '2021-02-17', 'value': 50.0, 'count': 1}, {'date': '2021-02-18', 'value': 100.0, 'count': 2}, {'date': '2021-02-19', 'value': 50.0, 'count': 1}, {'date': '2021-02-20', 'value': 850.0, 'count': 3}, {'date': '2021-02-21', 'value': 350.0, 'count': 4}, {'date': '2021-02-22', 'value': 350.0, 'count': 1}, {'date': '2021-02-24', 'value': 450.0, 'count': 1}, {'date': '2021-02-26', 'value': 50.0, 'count': 1}, {'date': '2021-02-27', 'value': 950.0, 'count': 2}, {'date': '2021-02-28', 'value': 550.0, 'count': 7}, {'date': '2021-03-01', 'value': 250.0, 'count': 4}, {'date': '2021-03-02', 'value': 1200.0, 'count': 2}, {'date': '2021-03-03', 'value': 1800.0, 'count': 6}, {'date': '2021-03-04', 'value': 750.0, 'count': 3}, {'date': '2021-03-05', 'value': 250.0, 'count': 2}, {'date': '2021-03-06', 'value': 100.0, 'count': 2}, {'date': '2021-03-07', 'value': 1900.0, 'count': 4}, {'date': '2021-03-08', 'value': 350.0, 'count': 2}, {'date': '2021-03-09', 'value': 650.0, 'count': 3}, {'date': '2021-03-10', 'value': 550.0, 'count': 2}, {'date': '2021-03-12', 'value': 1200.0, 'count': 4}, {'date': '2021-03-15', 'value': 50.0, 'count': 1}, {'date': '2021-03-17', 'value': 100.0, 'count': 1}], 'weekly': [{'date': '2020-11-30', 'value': 750.0, 'count': 5}, {'date': '2020-12-07', 'value': 150.0, 'count': 2}, {'date': '2020-12-14', 'value': 5050.0, 'count': 15}, {'date': '2020-12-21', 'value': 750.0, 'count': 5}, {'date': '2020-12-28', 'value': 700.0, 'count': 4}, {'date': '2021-01-04', 'value': 1150.0, 'count': 4}, {'date': '2021-01-11', 'value': 18450.0, 'count': 17}, {'date': '2021-01-18', 'value': 1800.0, 'count': 3}, {'date': '2021-01-25', 'value': 350.0, 'count': 3}, {'date': '2021-02-01', 'value': 3750.0, 'count': 19}, {'date': '2021-02-08', 'value': 43400.0, 'count': 23}, {'date': '2021-02-15', 'value': 49950.0, 'count': 38}, {'date': '2021-02-22', 'value': 4500.0, 'count': 15}, {'date': '2021-03-01', 'value': 2250.0, 'count': 15}, {'date': '2021-03-08', 'value': 6350.0, 'count': 21}, {'date': '2021-03-15', 'value': 2450.0, 'count': 10}, {'date': '2021-03-22', 'value': 100.0, 'count': 1}], 'monthly': [{'date': 'February', 'value': 100650.0, 'count': 90}, {'date': 'January', 'value': 23700.0, 'count': 41}, {'date': 'March', 'value': 9150.0, 'count': 36}], 'yearly': [{'date': '2020', 'value': 8400.0, 'count': 33}, {'date': '2021', 'value': 133500.0, 'count': 167}]}, {'daily': [{'date': '2021-02-25', 'value': 35.1, 'count': 1}, {'date': '2021-04-09', 'value': 190.24, 'count': 1}, {'date': '2021-05-17', 'value': 89.75, 'count': 1}, {'date': '2021-06-02', 'value': 1051.88, 'count': 1}, {'date': '2021-06-07', 'value': 635.03, 'count': 1}, {'date': '2021-07-08', 'value': 347.98, 'count': 1}, {'date': '2021-07-26', 'value': 80.84, 'count': 1}, {'date': '2021-08-27', 'value': 183.2, 'count': 1}, {'date': '2021-09-08', 'value': 627.45, 'count': 2}, {'date': '2021-09-26', 'value': 480.56, 'count': 1}, {'date': '2021-10-15', 'value': 124.17, 'count': 1}, {'date': '2021-10-16', 'value': 2909.76, 'count': 1}, {'date': '2021-10-20', 'value': 312.47, 'count': 1}, {'date': '2021-10-25', 'value': 43.18, 'count': 1}, {'date': '2021-11-12', 'value': 34.89, 'count': 1}, {'date': '2021-12-01', 'value': 455.73, 'count': 1}, {'date': '2021-12-07', 'value': 241.87, 'count': 1}, {'date': '2021-12-18', 'value': 45.58, 'count': 1}, {'date': '2022-01-01', 'value': 418.18, 'count': 1}, {'date': '2022-01-24', 'value': 324.29, 'count': 1}], 'weekly': [{'date': '2021-03-01', 'value': 35.1, 'count': 1}, {'date': '2021-03-08', 'value': 0.0, 'count': 0}, {'date': '2021-03-15', 'value': 0.0, 'count': 0}, {'date': '2021-03-22', 'value': 0.0, 'count': 0}, {'date': '2021-03-29', 'value': 0.0, 'count': 0}, {'date': '2021-04-05', 'value': 0.0, 'count': 0}, {'date': '2021-04-12', 'value': 190.24, 'count': 1}, {'date': '2021-04-19', 'value': 0.0, 'count': 0}, {'date': '2021-04-26', 'value': 0.0, 'count': 0}, {'date': '2021-05-03', 'value': 0.0, 'count': 0}, {'date': '2021-05-10', 'value': 0.0, 'count': 0}, {'date': '2021-05-17', 'value': 89.75, 'count': 1}, {'date': '2021-05-24', 'value': 0.0, 'count': 0}, {'date': '2021-05-31', 'value': 0.0, 'count': 0}, {'date': '2021-06-07', 'value': 1686.91, 'count': 2}, {'date': '2021-06-14', 'value': 0.0, 'count': 0}, {'date': '2021-06-21', 'value': 0.0, 'count': 0}, {'date': '2021-06-28', 'value': 0.0, 'count': 0}, {'date': '2021-07-05', 'value': 0.0, 'count': 0}, {'date': '2021-07-12', 'value': 347.98, 'count': 1}, {'date': '2021-07-19', 'value': 0.0, 'count': 0}, {'date': '2021-07-26', 'value': 80.84, 'count': 1}, {'date': '2021-08-02', 'value': 0.0, 'count': 0}, {'date': '2021-08-09', 'value': 0.0, 'count': 0}, {'date': '2021-08-16', 'value': 0.0, 'count': 0}, {'date': '2021-08-23', 'value': 0.0, 'count': 0}, {'date': '2021-08-30', 'value': 183.2, 'count': 1}, {'date': '2021-09-06', 'value': 0.0, 'count': 0}, {'date': '2021-09-13', 'value': 627.45, 'count': 2}, {'date': '2021-09-20', 'value': 0.0, 'count': 0}, {'date': '2021-09-27', 'value': 480.56, 'count': 1}, {'date': '2021-10-04', 'value': 0.0, 'count': 0}, {'date': '2021-10-11', 'value': 0.0, 'count': 0}, {'date': '2021-10-18', 'value': 3033.9300000000003, 'count': 2}, {'date': '2021-10-25', 'value': 355.65000000000003, 'count': 2}, {'date': '2021-11-01', 'value': 0.0, 'count': 0}, {'date': '2021-11-08', 'value': 0.0, 'count': 0}, {'date': '2021-11-15', 'value': 34.89, 'count': 1}, {'date': '2021-11-22', 'value': 0.0, 'count': 0}, {'date': '2021-11-29', 'value': 0.0, 'count': 0}, {'date': '2021-12-06', 'value': 455.73, 'count': 1}, {'date': '2021-12-13', 'value': 241.87, 'count': 1}, {'date': '2021-12-20', 'value': 45.58, 'count': 1}, {'date': '2021-12-27', 'value': 0.0, 'count': 0}, {'date': '2022-01-03', 'value': 418.18, 'count': 1}, {'date': '2022-01-10', 'value': 0.0, 'count': 0}, {'date': '2022-01-17', 'value': 0.0, 'count': 0}, {'date': '2022-01-24', 'value': 324.29, 'count': 1}], 'monthly': [{'date': 'April', 'value': 190.24, 'count': 1}, {'date': 'August', 'value': 183.2, 'count': 1}, {'date': 'December', 'value': 743.1800000000001, 'count': 3}, {'date': 'February', 'value': 35.1, 'count': 1}, {'date': 'January', 'value': 742.47, 'count': 2}, {'date': 'July', 'value': 428.82000000000005, 'count': 2}, {'date': 'June', 'value': 1686.91, 'count': 2}, {'date': 'May', 'value': 89.75, 'count': 1}, {'date': 'November', 'value': 34.89, 'count': 1}, {'date': 'October', 'value': 3389.5800000000004, 'count': 4}, {'date': 'September', 'value': 1108.01, 'count': 3}], 'yearly': [{'date': '2021', 'value': 7889.680000000001, 'count': 19}, {'date': '2022', 'value': 742.47, 'count': 2}]}
        ).apply()
        self.assertEqual(task.result, {"daily": [{"date": "2020-11-28", "value_2": 250.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2020-11-29", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-11-30", "value_2": 450.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-01", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-06", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-08", "value_2": 750.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-09", "value_2": 2050.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2020-12-10", "value_2": 200.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2020-12-11", "value_2": 500.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-12", "value_2": 250.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2020-12-13", "value_2": 1000.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-14", "value_2": 300.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-15", "value_2": 300.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2020-12-18", "value_2": 450.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-22", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-23", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-25", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-27", "value_2": 400.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-29", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-31", "value_2": 900.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-04", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-05", "value_2": 350.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-06", "value_2": 4950.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-07", "value_2": 1000.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-09", "value_2": 11750.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-10", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-11", "value_2": 250.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-14", "value_2": 1600.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-16", "value_2": 200.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-20", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-23", "value_2": 250.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-24", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-26", "value_2": 200.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-27", "value_2": 800.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2021-01-28", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-29", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-30", "value_2": 1150.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-31", "value_2": 500.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2021-02-01", "value_2": 800.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-03", "value_2": 19400.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-04", "value_2": 1100.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-05", "value_2": 1600.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-02-06", "value_2": 150.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-07", "value_2": 10400.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-02-08", "value_2": 10750.0, "value_1": 0.0, "count_2": 7.0, "count_1": 0.0}, {"date": "2021-02-09", "value_2": 2700.0, "value_1": 0.0, "count_2": 9.0, "count_1": 0.0}, {"date": "2021-02-10", "value_2": 14750.0, "value_1": 0.0, "count_2": 7.0, "count_1": 0.0}, {"date": "2021-02-11", "value_2": 5350.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2021-02-12", "value_2": 19700.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2021-02-13", "value_2": 4100.0, "value_1": 0.0, "count_2": 6.0, "count_1": 0.0}, {"date": "2021-02-14", "value_2": 350.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-15", "value_2": 3000.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-02-16", "value_2": 2750.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-17", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-18", "value_2": 100.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-19", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-20", "value_2": 850.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-21", "value_2": 350.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-02-22", "value_2": 350.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-24", "value_2": 450.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-26", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-27", "value_2": 950.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-28", "value_2": 550.0, "value_1": 0.0, "count_2": 7.0, "count_1": 0.0}, {"date": "2021-03-01", "value_2": 250.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-03-02", "value_2": 1200.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-03-03", "value_2": 1800.0, "value_1": 0.0, "count_2": 6.0, "count_1": 0.0}, {"date": "2021-03-04", "value_2": 750.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-03-05", "value_2": 250.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-03-06", "value_2": 100.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-03-07", "value_2": 1900.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-03-08", "value_2": 350.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-03-09", "value_2": 650.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-03-10", "value_2": 550.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-03-12", "value_2": 1200.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-03-15", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-03-17", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-25", "value_2": 0.0, "value_1": 35.1, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-04-09", "value_2": 0.0, "value_1": 190.24, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-05-17", "value_2": 0.0, "value_1": 89.75, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-06-02", "value_2": 0.0, "value_1": 1051.88, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-06-07", "value_2": 0.0, "value_1": 635.03, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-07-08", "value_2": 0.0, "value_1": 347.98, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-07-26", "value_2": 0.0, "value_1": 80.84, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-08-27", "value_2": 0.0, "value_1": 183.2, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-09-08", "value_2": 0.0, "value_1": 627.45, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-09-26", "value_2": 0.0, "value_1": 480.56, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-15", "value_2": 0.0, "value_1": 124.17, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-16", "value_2": 0.0, "value_1": 2909.76, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-20", "value_2": 0.0, "value_1": 312.47, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-25", "value_2": 0.0, "value_1": 43.18, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-11-12", "value_2": 0.0, "value_1": 34.89, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-01", "value_2": 0.0, "value_1": 455.73, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-07", "value_2": 0.0, "value_1": 241.87, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-18", "value_2": 0.0, "value_1": 45.58, "count_2": 0.0, "count_1": 1.0}, {"date": "2022-01-01", "value_2": 0.0, "value_1": 418.18, "count_2": 0.0, "count_1": 1.0}, {"date": "2022-01-24", "value_2": 0.0, "value_1": 324.29, "count_2": 0.0, "count_1": 1.0}], "weekly": [{"date": "2020-11-30", "value_2": 750.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2020-12-07", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-14", "value_2": 5050.0, "value_1": 0.0, "count_2": 15.0, "count_1": 0.0}, {"date": "2020-12-21", "value_2": 750.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2020-12-28", "value_2": 700.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-04", "value_2": 1150.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-11", "value_2": 18450.0, "value_1": 0.0, "count_2": 17.0, "count_1": 0.0}, {"date": "2021-01-18", "value_2": 1800.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-25", "value_2": 350.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-01", "value_2": 3750.0, "value_1": 0.0, "count_2": 19.0, "count_1": 0.0}, {"date": "2021-02-08", "value_2": 43400.0, "value_1": 0.0, "count_2": 23.0, "count_1": 0.0}, {"date": "2021-02-15", "value_2": 49950.0, "value_1": 0.0, "count_2": 38.0, "count_1": 0.0}, {"date": "2021-02-22", "value_2": 4500.0, "value_1": 0.0, "count_2": 15.0, "count_1": 0.0}, {"date": "2021-03-01", "value_2": 2250.0, "value_1": 35.1, "count_2": 15.0, "count_1": 1.0}, {"date": "2021-03-08", "value_2": 6350.0, "value_1": 0.0, "count_2": 21.0, "count_1": 0.0}, {"date": "2021-03-15", "value_2": 2450.0, "value_1": 0.0, "count_2": 10.0, "count_1": 0.0}, {"date": "2021-03-22", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-03-29", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-04-05", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-04-12", "value_2": 0.0, "value_1": 190.24, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-04-19", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-04-26", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-05-03", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-05-10", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-05-17", "value_2": 0.0, "value_1": 89.75, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-05-24", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-05-31", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-06-07", "value_2": 0.0, "value_1": 1686.91, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-06-14", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-06-21", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-06-28", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-07-05", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-07-12", "value_2": 0.0, "value_1": 347.98, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-07-19", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-07-26", "value_2": 0.0, "value_1": 80.84, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-08-02", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-09", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-16", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-23", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-30", "value_2": 0.0, "value_1": 183.2, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-09-06", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-09-13", "value_2": 0.0, "value_1": 627.45, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-09-20", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-09-27", "value_2": 0.0, "value_1": 480.56, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-04", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-10-11", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-10-18", "value_2": 0.0, "value_1": 3033.9300000000003, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-10-25", "value_2": 0.0, "value_1": 355.65000000000003, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-11-01", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-11-08", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-11-15", "value_2": 0.0, "value_1": 34.89, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-11-22", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-11-29", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-12-06", "value_2": 0.0, "value_1": 455.73, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-13", "value_2": 0.0, "value_1": 241.87, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-20", "value_2": 0.0, "value_1": 45.58, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-27", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2022-01-03", "value_2": 0.0, "value_1": 418.18, "count_2": 0.0, "count_1": 1.0}, {"date": "2022-01-10", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2022-01-17", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2022-01-24", "value_2": 0.0, "value_1": 324.29, "count_2": 0.0, "count_1": 1.0}], "monthly": [{"date": "February", "value_2": 100650.0, "value_1": 35.1, "count_2": 90.0, "count_1": 1.0}, {"date": "January", "value_2": 23700.0, "value_1": 742.47, "count_2": 41.0, "count_1": 2.0}, {"date": "March", "value_2": 9150.0, "value_1": 0.0, "count_2": 36.0, "count_1": 0.0}, {"date": "April", "value_2": 0.0, "value_1": 190.24, "count_2": 0.0, "count_1": 1.0}, {"date": "August", "value_2": 0.0, "value_1": 183.2, "count_2": 0.0, "count_1": 1.0}, {"date": "December", "value_2": 0.0, "value_1": 743.1800000000001, "count_2": 0.0, "count_1": 3.0}, {"date": "July", "value_2": 0.0, "value_1": 428.82000000000005, "count_2": 0.0, "count_1": 2.0}, {"date": "June", "value_2": 0.0, "value_1": 1686.91, "count_2": 0.0, "count_1": 2.0}, {"date": "May", "value_2": 0.0, "value_1": 89.75, "count_2": 0.0, "count_1": 1.0}, {"date": "November", "value_2": 0.0, "value_1": 34.89, "count_2": 0.0, "count_1": 1.0}, {"date": "October", "value_2": 0.0, "value_1": 3389.5800000000004, "count_2": 0.0, "count_1": 4.0}, {"date": "September", "value_2": 0.0, "value_1": 1108.01, "count_2": 0.0, "count_1": 3.0}], "yearly": [{"date": "2020", "value_2": 8400.0, "value_1": 0.0, "count_2": 33.0, "count_1": 0.0}, {"date": "2021", "value_2": 133500.0, "value_1": 7889.680000000001, "count_2": 167.0, "count_1": 19.0}, {"date": "2022", "value_2": 0.0, "value_1": 742.47, "count_2": 0.0, "count_1": 2.0}]})

    def test_join_periodic_mutation_0(self):
        task = transaction_service.join_periodic.s(
            {'daily': [{'date': '2020-11-28', 'value': 250.0, 'count': 3}, {'date': '2020-11-29', 'value': 50.0, 'count': 1}, {'date': '2020-11-30', 'value': 450.0, 'count': 1}, {'date': '2020-12-01', 'value': 50.0, 'count': 1}, {'date': '2020-12-06', 'value': 100.0, 'count': 1}, {'date': '2020-12-08', 'value': 750.0, 'count': 1}, {'date': '2020-12-09', 'value': 2050.0, 'count': 4}, {'date': '2020-12-10', 'value': 200.0, 'count': 3}, {'date': '2020-12-11', 'value': 500.0, 'count': 1}, {'date': '2020-12-12', 'value': 250.0, 'count': 3}, {'date': '2020-12-13', 'value': 1000.0, 'count': 2}, {'date': '2020-12-14', 'value': 300.0, 'count': 1}, {'date': '2020-12-15', 'value': 300.0, 'count': 3}, {'date': '2020-12-18', 'value': 450.0, 'count': 2}, {'date': '2020-12-22', 'value': 100.0, 'count': 1}, {'date': '2020-12-23', 'value': 100.0, 'count': 1}, {'date': '2020-12-25', 'value': 100.0, 'count': 1}, {'date': '2020-12-27', 'value': 400.0, 'count': 1}, {'date': '2020-12-29', 'value': 100.0, 'count': 1}, {'date': '2020-12-31', 'value': 900.0, 'count': 1}, {'date': '2021-01-04', 'value': 150.0, 'count': 2}, {'date': '2021-01-05', 'value': 350.0, 'count': 3}, {'date': '2021-01-06', 'value': 4950.0, 'count': 4}, {'date': '2021-01-07', 'value': 1000.0, 'count': 4}, {'date': '2021-01-09', 'value': 11750.0, 'count': 1}, {'date': '2021-01-10', 'value': 150.0, 'count': 2}, {'date': '2021-01-11', 'value': 250.0, 'count': 3}, {'date': '2021-01-14', 'value': 1600.0, 'count': 1}, {'date': '2021-01-16', 'value': 200.0, 'count': 2}, {'date': '2021-01-20', 'value': 50.0, 'count': 1}, {'date': '2021-01-23', 'value': 250.0, 'count': 1}, {'date': '2021-01-24', 'value': 50.0, 'count': 1}, {'date': '2021-01-26', 'value': 200.0, 'count': 1}, {'date': '2021-01-27', 'value': 800.0, 'count': 5}, {'date': '2021-01-28', 'value': 150.0, 'count': 2}, {'date': '2021-01-29', 'value': 150.0, 'count': 2}, {'date': '2021-01-30', 'value': 1150.0, 'count': 1}, {'date': '2021-01-31', 'value': 500.0, 'count': 5}, {'date': '2021-02-01', 'value': 800.0, 'count': 3}, {'date': '2021-02-03', 'value': 19400.0, 'count': 2}, {'date': '2021-02-04', 'value': 1100.0, 'count': 3}, {'date': '2021-02-05', 'value': 1600.0, 'count': 4}, {'date': '2021-02-06', 'value': 150.0, 'count': 3}, {'date': '2021-02-07', 'value': 10400.0, 'count': 4}, {'date': '2021-02-08', 'value': 10750.0, 'count': 7}, {'date': '2021-02-09', 'value': 2700.0, 'count': 9}, {'date': '2021-02-10', 'value': 14750.0, 'count': 7}, {'date': '2021-02-11', 'value': 5350.0, 'count': 5}, {'date': '2021-02-12', 'value': 19700.0, 'count': 5}, {'date': '2021-02-13', 'value': 4100.0, 'count': 6}, {'date': '2021-02-14', 'value': 350.0, 'count': 2}, {'date': '2021-02-15', 'value': 3000.0, 'count': 4}, {'date': '2021-02-16', 'value': 2750.0, 'count': 3}, {'date': '2021-02-17', 'value': 50.0, 'count': 1}, {'date': '2021-02-18', 'value': 100.0, 'count': 2}, {'date': '2021-02-19', 'value': 50.0, 'count': 1}, {'date': '2021-02-20', 'value': 850.0, 'count': 3}, {'date': '2021-02-21', 'value': 350.0, 'count': 4}, {'date': '2021-02-22', 'value': 350.0, 'count': 1}, {'date': '2021-02-24', 'value': 450.0, 'count': 1}, {'date': '2021-02-26', 'value': 50.0, 'count': 1}, {'date': '2021-02-27', 'value': 950.0, 'count': 2}, {'date': '2021-02-28', 'value': 550.0, 'count': 7}, {'date': '2021-03-01', 'value': 250.0, 'count': 4}, {'date': '2021-03-02', 'value': 1200.0, 'count': 2}, {'date': '2021-03-03', 'value': 1800.0, 'count': 6}, {'date': '2021-03-04', 'value': 750.0, 'count': 3}, {'date': '2021-03-05', 'value': 250.0, 'count': 2}, {'date': '2021-03-06', 'value': 100.0, 'count': 2}, {'date': '2021-03-07', 'value': 1900.0, 'count': 4}, {'date': '2021-03-08', 'value': 350.0, 'count': 2}, {'date': '2021-03-09', 'value': 650.0, 'count': 3}, {'date': '2021-03-10', 'value': 550.0, 'count': 2}, {'date': '2021-03-12', 'value': 1200.0, 'count': 4}, {'date': '2021-03-15', 'value': 50.0, 'count': 1}, {'date': '2021-03-17', 'value': 100.0, 'count': 1}], 'weekly': [{'date': '2020-11-30', 'value': 750.0, 'count': 5}, {'date': '2020-12-07', 'value': 150.0, 'count': 2}, {'date': '2020-12-14', 'value': 5050.0, 'count': 15}, {'date': '2020-12-21', 'value': 750.0, 'count': 5}, {'date': '2020-12-28', 'value': 700.0, 'count': 4}, {'date': '2021-01-04', 'value': 1150.0, 'count': 4}, {'date': '2021-01-11', 'value': 18450.0, 'count': 17}, {'date': '2021-01-18', 'value': 1800.0, 'count': 3}, {'date': '2021-01-25', 'value': 350.0, 'count': 3}, {'date': '2021-02-01', 'value': 3750.0, 'count': 19}, {'date': '2021-02-08', 'value': 43400.0, 'count': 23}, {'date': '2021-02-15', 'value': 49950.0, 'count': 38}, {'date': '2021-02-22', 'value': 4500.0, 'count': 15}, {'date': '2021-03-01', 'value': 2250.0, 'count': 15}, {'date': '2021-03-08', 'value': 6350.0, 'count': 21}, {'date': '2021-03-15', 'value': 2450.0, 'count': 10}, {'date': '2021-03-22', 'value': 100.0, 'count': 1}], 'monthly': [{'date': 'February', 'value': 100650.0, 'count': 90}, {'date': 'January', 'value': 23700.0, 'count': 41}, {'date': 'March', 'value': 9150.0, 'count': 36}], 'yearly': [{'date': '2020', 'value': 8400.0, 'count': 33}, {'date': '2021', 'value': 133500.0, 'count': 167}]}, {'daily': [{'date': '2021-02-25', 'value': 35.1, 'count': 1}, {'date': '2021-04-09', 'value': 190.24, 'count': 1}, {'date': '2021-05-17', 'value': 89.75, 'count': 1}, {'date': '2021-06-02', 'value': 1051.88, 'count': 1}, {'date': '2021-06-07', 'value': 635.03, 'count': 1}, {'date': '2021-07-08', 'value': 347.98, 'count': 1}, {'date': '2021-07-26', 'value': 80.84, 'count': 1}, {'date': '2021-08-27', 'value': 183.2, 'count': 1}, {'date': '2021-09-08', 'value': 627.45, 'count': 2}, {'date': '2021-09-26', 'value': 480.56, 'count': 1}, {'date': '2021-10-15', 'value': 124.17, 'count': 1}, {'date': '2021-10-16', 'value': 2909.76, 'count': 1}, {'date': '2021-10-20', 'value': 312.47, 'count': 1}, {'date': '2021-10-25', 'value': 43.18, 'count': 1}, {'date': '2021-11-12', 'value': 34.89, 'count': 1}, {'date': '2021-12-01', 'value': 455.73, 'count': 1}, {'date': '2021-12-07', 'value': 241.87, 'count': 1}, {'date': '2021-12-18', 'value': 45.58, 'count': 1}, {'date': '2022-01-01', 'value': 418.18, 'count': 1}, {'date': '2022-01-24', 'value': 324.29, 'count': 1}], 'weekly': [{'date': '2021-03-01', 'value': 35.1, 'count': 1}, {'date': '2021-03-08', 'value': 0.0, 'count': 0}, {'date': '2021-03-15', 'value': 0.0, 'count': 0}, {'date': '2021-03-22', 'value': 0.0, 'count': 0}, {'date': '2021-03-29', 'value': 0.0, 'count': 0}, {'date': '2021-04-05', 'value': 0.0, 'count': 0}, {'date': '2021-04-12', 'value': 190.24, 'count': 1}, {'date': '2021-04-19', 'value': 0.0, 'count': 0}, {'date': '2021-04-26', 'value': 0.0, 'count': 0}, {'date': '2021-05-03', 'value': 0.0, 'count': 0}, {'date': '2021-05-10', 'value': 0.0, 'count': 0}, {'date': '2021-05-17', 'value': 89.75, 'count': 1}, {'date': '2021-05-24', 'value': 0.0, 'count': 0}, {'date': '2021-05-31', 'value': 0.0, 'count': 0}, {'date': '2021-06-07', 'value': 1686.91, 'count': 2}, {'date': '2021-06-14', 'value': 0.0, 'count': 0}, {'date': '2021-06-21', 'value': 0.0, 'count': 0}, {'date': '2021-06-28', 'value': 0.0, 'count': 0}, {'date': '2021-07-05', 'value': 0.0, 'count': 0}, {'date': '2021-07-12', 'value': 347.98, 'count': 1}, {'date': '2021-07-19', 'value': 0.0, 'count': 0}, {'date': '2021-07-26', 'value': 80.84, 'count': 1}, {'date': '2021-08-02', 'value': 0.0, 'count': 0}, {'date': '2021-08-09', 'value': 0.0, 'count': 0}, {'date': '2021-08-16', 'value': 0.0, 'count': 0}, {'date': '2021-08-23', 'value': 0.0, 'count': 0}, {'date': '2021-08-30', 'value': 183.2, 'count': 1}, {'date': '2021-09-06', 'value': 0.0, 'count': 0}, {'date': '2021-09-13', 'value': 627.45, 'count': 2}, {'date': '2021-09-20', 'value': 0.0, 'count': 0}, {'date': '2021-09-27', 'value': 480.56, 'count': 1}, {'date': '2021-10-04', 'value': 0.0, 'count': 0}, {'date': '2021-10-11', 'value': 0.0, 'count': 0}, {'date': '2021-10-18', 'value': 3033.9300000000003, 'count': 2}, {'date': '2021-10-25', 'value': 355.65000000000003, 'count': 2}, {'date': '2021-11-01', 'value': 0.0, 'count': 0}, {'date': '2021-11-08', 'value': 0.0, 'count': 0}, {'date': '2021-11-15', 'value': 34.89, 'count': 1}, {'date': '2021-11-22', 'value': 0.0, 'count': 0}, {'date': '2021-11-29', 'value': 0.0, 'count': 0}, {'date': '2021-12-06', 'value': 455.73, 'count': 1}, {'date': '2021-12-13', 'value': 241.87, 'count': 1}, {'date': '2021-12-20', 'value': 45.58, 'count': 1}, {'date': '2021-12-27', 'value': 0.0, 'count': 0}, {'date': '2022-01-03', 'value': 418.18, 'count': 1}, {'date': '2022-01-10', 'value': 0.0, 'count': 0}, {'date': '2022-01-17', 'value': 0.0, 'count': 0}, {'date': '2022-01-24', 'value': 324.29, 'count': 1}], 'monthly': [{'date': 'April', 'value': 190.24, 'count': 1}, {'date': 'August', 'value': 183.2, 'count': 1}, {'date': 'December', 'value': 743.1800000000001, 'count': 3}, {'date': 'February', 'value': 35.1, 'count': 1}, {'date': 'January', 'value': 742.47, 'count': 2}, {'date': 'July', 'value': 428.82000000000005, 'count': 2}, {'date': 'June', 'value': 1686.91, 'count': 2}, {'date': 'May', 'value': 89.75, 'count': 1}, {'date': 'November', 'value': 34.89, 'count': 1}, {'date': 'October', 'value': 3389.5800000000004, 'count': 4}, {'date': 'September', 'value': 1108.01, 'count': 3}], 'yearly': [{'date': '2021', 'value': 7889.680000000001, 'count': 19}, {'date': '2022', 'value': 742.47, 'count': 2}]}
        ).apply()
        self.assertEqual(task.result, {"daily": [{"date": "2020-11-28", "value_2": 250.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2020-11-29", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-11-30", "value_2": 450.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-01", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-06", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-08", "value_2": 750.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-09", "value_2": 2050.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2020-12-10", "value_2": 200.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2020-12-11", "value_2": 500.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-12", "value_2": 250.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2020-12-13", "value_2": 1000.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-14", "value_2": 300.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-15", "value_2": 300.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2020-12-18", "value_2": 450.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-22", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-23", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-25", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-27", "value_2": 400.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-29", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-31", "value_2": 900.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-04", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-05", "value_2": 350.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-06", "value_2": 4950.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-07", "value_2": 1000.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-09", "value_2": 11750.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-10", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-11", "value_2": 250.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-14", "value_2": 1600.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-16", "value_2": 200.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-20", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-23", "value_2": 250.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-24", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-26", "value_2": 200.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-27", "value_2": 800.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2021-01-28", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-29", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-30", "value_2": 1150.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-31", "value_2": 500.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2021-02-01", "value_2": 800.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-03", "value_2": 19400.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-04", "value_2": 1100.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-05", "value_2": 1600.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-02-06", "value_2": 150.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-07", "value_2": 10400.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-02-08", "value_2": 10750.0, "value_1": 0.0, "count_2": 7.0, "count_1": 0.0}, {"date": "2021-02-09", "value_2": 2700.0, "value_1": 0.0, "count_2": 9.0, "count_1": 0.0}, {"date": "2021-02-10", "value_2": 14750.0, "value_1": 0.0, "count_2": 7.0, "count_1": 0.0}, {"date": "2021-02-11", "value_2": 5350.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2021-02-12", "value_2": 19700.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2021-02-13", "value_2": 4100.0, "value_1": 0.0, "count_2": 6.0, "count_1": 0.0}, {"date": "2021-02-14", "value_2": 350.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-15", "value_2": 3000.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-02-16", "value_2": 2750.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-17", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-18", "value_2": 100.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-19", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-20", "value_2": 850.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-21", "value_2": 350.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-02-22", "value_2": 350.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-24", "value_2": 450.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-26", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-27", "value_2": 950.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-28", "value_2": 550.0, "value_1": 0.0, "count_2": 7.0, "count_1": 0.0}, {"date": "2021-03-01", "value_2": 250.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-03-02", "value_2": 1200.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-03-03", "value_2": 1800.0, "value_1": 0.0, "count_2": 6.0, "count_1": 0.0}, {"date": "2021-03-04", "value_2": 750.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-03-05", "value_2": 250.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-03-06", "value_2": 100.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-03-07", "value_2": 1900.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-03-08", "value_2": 350.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-03-09", "value_2": 650.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-03-10", "value_2": 550.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-03-12", "value_2": 1200.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-03-15", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-03-17", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-25", "value_2": 0.0, "value_1": 35.1, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-04-09", "value_2": 0.0, "value_1": 190.24, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-05-17", "value_2": 0.0, "value_1": 89.75, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-06-02", "value_2": 0.0, "value_1": 1051.88, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-06-07", "value_2": 0.0, "value_1": 635.03, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-07-08", "value_2": 0.0, "value_1": 347.98, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-07-26", "value_2": 0.0, "value_1": 80.84, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-08-27", "value_2": 0.0, "value_1": 183.2, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-09-08", "value_2": 0.0, "value_1": 627.45, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-09-26", "value_2": 0.0, "value_1": 480.56, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-15", "value_2": 0.0, "value_1": 124.17, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-16", "value_2": 0.0, "value_1": 2909.76, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-20", "value_2": 0.0, "value_1": 312.47, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-25", "value_2": 0.0, "value_1": 43.18, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-11-12", "value_2": 0.0, "value_1": 34.89, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-01", "value_2": 0.0, "value_1": 455.73, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-07", "value_2": 0.0, "value_1": 241.87, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-18", "value_2": 0.0, "value_1": 45.58, "count_2": 0.0, "count_1": 1.0}, {"date": "2022-01-01", "value_2": 0.0, "value_1": 418.18, "count_2": 0.0, "count_1": 1.0}, {"date": "2022-01-24", "value_2": 0.0, "value_1": 324.29, "count_2": 0.0, "count_1": 1.0}], "weekly": [{"date": "2020-11-30", "value_2": 750.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2020-12-07", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-14", "value_2": 5050.0, "value_1": 0.0, "count_2": 15.0, "count_1": 0.0}, {"date": "2020-12-21", "value_2": 750.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2020-12-28", "value_2": 700.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-04", "value_2": 1150.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-11", "value_2": 18450.0, "value_1": 0.0, "count_2": 17.0, "count_1": 0.0}, {"date": "2021-01-18", "value_2": 1800.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-25", "value_2": 350.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-01", "value_2": 3750.0, "value_1": 0.0, "count_2": 19.0, "count_1": 0.0}, {"date": "2021-02-08", "value_2": 43400.0, "value_1": 0.0, "count_2": 23.0, "count_1": 0.0}, {"date": "2021-02-15", "value_2": 49950.0, "value_1": 0.0, "count_2": 38.0, "count_1": 0.0}, {"date": "2021-02-22", "value_2": 4500.0, "value_1": 0.0, "count_2": 15.0, "count_1": 0.0}, {"date": "2021-03-01", "value_2": 2250.0, "value_1": 35.1, "count_2": 15.0, "count_1": 1.0}, {"date": "2021-03-08", "value_2": 6350.0, "value_1": 0.0, "count_2": 21.0, "count_1": 0.0}, {"date": "2021-03-15", "value_2": 2450.0, "value_1": 0.0, "count_2": 10.0, "count_1": 0.0}, {"date": "2021-03-22", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-03-29", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-04-05", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-04-12", "value_2": 0.0, "value_1": 190.24, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-04-19", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-04-26", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-05-03", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-05-10", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-05-17", "value_2": 0.0, "value_1": 89.75, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-05-24", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-05-31", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-06-07", "value_2": 0.0, "value_1": 1686.91, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-06-14", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-06-21", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-06-28", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-07-05", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-07-12", "value_2": 0.0, "value_1": 347.98, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-07-19", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-07-26", "value_2": 0.0, "value_1": 80.84, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-08-02", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-09", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-16", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-23", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-30", "value_2": 0.0, "value_1": 183.2, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-09-06", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-09-13", "value_2": 0.0, "value_1": 627.45, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-09-20", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-09-27", "value_2": 0.0, "value_1": 480.56, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-04", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-10-11", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-10-18", "value_2": 0.0, "value_1": 3033.9300000000003, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-10-25", "value_2": 0.0, "value_1": 355.65000000000003, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-11-01", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-11-08", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-11-15", "value_2": 0.0, "value_1": 34.89, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-11-22", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-11-29", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-12-06", "value_2": 0.0, "value_1": 455.73, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-13", "value_2": 0.0, "value_1": 241.87, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-20", "value_2": 0.0, "value_1": 45.58, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-27", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2022-01-03", "value_2": 0.0, "value_1": 418.18, "count_2": 0.0, "count_1": 1.0}, {"date": "2022-01-10", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2022-01-17", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2022-01-24", "value_2": 0.0, "value_1": 324.29, "count_2": 0.0, "count_1": 1.0}], "monthly": [{"date": "February", "value_2": 100650.0, "value_1": 35.1, "count_2": 90.0, "count_1": 1.0}, {"date": "January", "value_2": 23700.0, "value_1": 742.47, "count_2": 41.0, "count_1": 2.0}, {"date": "March", "value_2": 9150.0, "value_1": 0.0, "count_2": 36.0, "count_1": 0.0}, {"date": "April", "value_2": 0.0, "value_1": 190.24, "count_2": 0.0, "count_1": 1.0}, {"date": "August", "value_2": 0.0, "value_1": 183.2, "count_2": 0.0, "count_1": 1.0}, {"date": "December", "value_2": 0.0, "value_1": 743.1800000000001, "count_2": 0.0, "count_1": 3.0}, {"date": "July", "value_2": 0.0, "value_1": 428.82000000000005, "count_2": 0.0, "count_1": 2.0}, {"date": "June", "value_2": 0.0, "value_1": 1686.91, "count_2": 0.0, "count_1": 2.0}, {"date": "May", "value_2": 0.0, "value_1": 89.75, "count_2": 0.0, "count_1": 1.0}, {"date": "November", "value_2": 0.0, "value_1": 34.89, "count_2": 0.0, "count_1": 1.0}, {"date": "October", "value_2": 0.0, "value_1": 3389.5800000000004, "count_2": 0.0, "count_1": 4.0}, {"date": "September", "value_2": 0.0, "value_1": 1108.01, "count_2": 0.0, "count_1": 3.0}], "yearly": [{"date": "2020", "value_2": 8400.0, "value_1": 0.0, "count_2": 33.0, "count_1": 0.0}, {"date": "2021", "value_2": 133500.0, "value_1": 7889.680000000001, "count_2": 167.0, "count_1": 19.0}, {"date": "2022", "value_2": 0.0, "value_1": 742.47, "count_2": 0.0, "count_1": 2.0}]})

    def test_get_deposit_categories_mutation_0(self):
        task = transaction_service.get_deposit_categories.s(
            'all', None, None
        ).apply()
        self.assertEqual(task.result, {"content": [{"_id": "50-100", "count": 63, "amount": 3150.0, "avg": 50.0, "share": 31.5}, {"_id": "100-200", "count": 64, "amount": 6650.0, "avg": 103.90625, "share": 32.0}, {"_id": "200-500", "count": 32, "amount": 10200.0, "avg": 318.75, "share": 16.0}, {"_id": "500-1000", "count": 15, "amount": 10350.0, "avg": 690.0, "share": 7.5}, {"_id": "1000-1500", "count": 11, "amount": 13200.0, "avg": 1200.0, "share": 5.5}, {"_id": "1500-5000", "count": 10, "amount": 27900.0, "avg": 2790.0, "share": 5.0}, {"_id": "5000-10000", "count": 1, "amount": 9900.0, "avg": 9900.0, "share": 0.5}, {"_id": "10000-MAX", "count": 4, "amount": 60550.0, "avg": 15137.5, "share": 2.0}], "max": 64, "total_amount": 141900.0, "total_count": 200, "total_avg": 709.5, "total_share": 100.0})

    def test_get_deposit_categories_mutation_1(self):
        task = transaction_service.get_deposit_categories.s(
            'first', None, None
        ).apply()
        self.assertEqual(task.result, {"content": [], "max": 0})

    def test_get_top_deposit_info_mutation_0(self):
        task = transaction_service.get_top_deposit_info.s(
            {'content': []}
        ).apply()
        self.assertEqual(task.result, {"content": []})

    def test_get_deposits_mutation_0(self):
        task = transaction_service.get_deposits.s(
            None, 20, 0, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 297, \"total_pages\": 15, \"current_page\": 0, \"content\": [{\"_id\": \"620dcf36d7b676a9305f445d\", \"user_id\": \"6013f191d7b676a9305f3e09\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"25884\", \"quantity_in_asset\": \"776.52000\", \"quantity\": \"258.84\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2022-02-17 04:29:42\", \"date_modified\": \"2022-02-17 04:32:57\"}, {\"_id\": \"61f71e7fd7b676a9305f4412\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"6731\", \"quantity_in_asset\": \"11.21833\", \"quantity\": \"67.31\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2022-01-30 23:25:51\", \"date_modified\": \"2022-01-30 23:28:20\"}, {\"_id\": \"61f4c2b6d7b676a9305f4404\", \"user_id\": \"6013f191d7b676a9305f3e30\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"7607\", \"quantity_in_asset\": \"532.49000\", \"quantity\": \"76.07\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2022-01-29 04:29:42\", \"date_modified\": \"2022-01-29 04:31:37\"}, {\"_id\": \"61da1d7fd7b676a9305f441f\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"11024\", \"quantity_in_asset\": \"881.92000\", \"quantity\": \"110.24\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2022-01-08 23:25:51\", \"date_modified\": \"2022-01-08 23:28:39\"}, {\"_id\": \"61cec91cd7b676a9305f4469\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"8033\", \"quantity_in_asset\": \"8.92556\", \"quantity\": \"80.33\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-31 09:10:52\", \"date_modified\": \"2021-12-31 09:13:30\"}, {\"_id\": \"61c3923ed7b676a9305f422d\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"8309\", \"quantity_in_asset\": \"9.23222\", \"quantity\": \"83.09\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-22 21:01:50\", \"date_modified\": \"2021-12-22 21:02:46\"}, {\"_id\": \"61b18d2bd7b676a9305f42a7\", \"user_id\": \"6013f191d7b676a9305f3e1f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"83359\", \"quantity_in_asset\": \"277.86333\", \"quantity\": \"833.59\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-09 04:59:23\", \"date_modified\": \"2021-12-09 04:59:27\"}, {\"_id\": \"61ac4036d7b676a9305f4484\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"30903\", \"quantity_in_asset\": \"51.50500\", \"quantity\": \"309.03\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-05 04:29:42\", \"date_modified\": \"2021-12-05 04:32:10\"}, {\"_id\": \"61a8babbd7b676a9305f4361\", \"user_id\": \"6013f191d7b676a9305f3e31\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"2058475\", \"quantity_in_asset\": \"20584.75000\", \"quantity\": \"20584.75\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-02 12:23:23\", \"date_modified\": \"2021-12-02 12:26:01\"}, {\"_id\": \"619fd702d7b676a9305f4302\", \"user_id\": \"6013f191d7b676a9305f3e34\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"78487\", \"quantity_in_asset\": \"112.12429\", \"quantity\": \"784.87\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-25 18:33:38\", \"date_modified\": \"2021-11-25 18:34:14\"}, {\"_id\": \"6199cb36d7b676a9305f4463\", \"user_id\": \"6013f191d7b676a9305f3e35\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"242876\", \"quantity_in_asset\": \"809.58667\", \"quantity\": \"2428.76\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-21 04:29:42\", \"date_modified\": \"2021-11-21 04:30:28\"}, {\"_id\": \"61958475d7b676a9305f41ca\", \"user_id\": \"6013f191d7b676a9305f3e10\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"38841\", \"quantity_in_asset\": \"77.68200\", \"quantity\": \"388.41\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-17 22:38:45\", \"date_modified\": \"2021-11-17 22:40:47\"}, {\"_id\": \"6191090bd7b676a9305f43e5\", \"user_id\": \"6013f191d7b676a9305f3e36\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"88924\", \"quantity_in_asset\": \"6224.68000\", \"quantity\": \"889.24\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-14 13:03:07\", \"date_modified\": \"2021-11-14 13:05:07\"}, {\"_id\": \"618c49f5d7b676a9305f4201\", \"user_id\": \"6013f191d7b676a9305f3e09\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"fth\", \"quantity_in_fiat\": \"10015\", \"quantity_in_asset\": \"50.07500\", \"quantity\": \"100.15\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"ebutler.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e6e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-10 22:38:45\", \"date_modified\": \"2021-11-10 22:39:09\"}, {\"_id\": \"6183a39cd7b676a9305f4451\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"10465\", \"quantity_in_asset\": \"52.32500\", \"quantity\": \"104.65\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-04 09:10:52\", \"date_modified\": \"2021-11-04 09:11:20\"}, {\"_id\": \"6180777fd7b676a9305f43f3\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"35674\", \"quantity_in_asset\": \"2497.18000\", \"quantity\": \"356.74\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-01 23:25:51\", \"date_modified\": \"2021-11-01 23:25:52\"}, {\"_id\": \"617a5102d7b676a9305f43a5\", \"user_id\": \"6013f191d7b676a9305f3e35\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"58746\", \"quantity_in_asset\": \"4699.68000\", \"quantity\": \"587.46\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-28 07:28:02\", \"date_modified\": \"2021-10-28 07:30:11\"}, {\"_id\": \"616e7382d7b676a9305f4387\", \"user_id\": \"6013f191d7b676a9305f3e24\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"241817\", \"quantity_in_asset\": \"2418.17000\", \"quantity\": \"2418.17\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-19 07:28:02\", \"date_modified\": \"2021-10-19 07:30:46\"}, {\"_id\": \"616667abd7b676a9305f4324\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"127012\", \"quantity_in_asset\": \"11431.08000\", \"quantity\": \"1270.12\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-13 04:59:23\", \"date_modified\": \"2021-10-13 05:02:33\"}, {\"_id\": \"61618008d7b676a9305f4233\", \"user_id\": \"6013f191d7b676a9305f3e08\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"27898\", \"quantity_in_asset\": \"557.96000\", \"quantity\": \"278.98\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-09 11:42:00\", \"date_modified\": \"2021-10-09 11:44:31\"}]}")

    def test_get_deposits_mutation_1(self):
        task = transaction_service.get_deposits.s(
            None, 20, 1, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 297, \"total_pages\": 15, \"current_page\": 1, \"content\": [{\"_id\": \"615f81ffd7b676a9305f4447\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"59859\", \"quantity_in_asset\": \"99.76500\", \"quantity\": \"598.59\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-07 23:25:51\", \"date_modified\": \"2021-10-07 23:25:58\"}, {\"_id\": \"615ee6bbd7b676a9305f42ec\", \"user_id\": \"6013f191d7b676a9305f3e31\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"23658\", \"quantity_in_asset\": \"47.31600\", \"quantity\": \"236.58\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-07 12:23:23\", \"date_modified\": \"2021-10-07 12:23:49\"}, {\"_id\": \"615dec02d7b676a9305f42e1\", \"user_id\": \"6013f191d7b676a9305f3e34\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"7574\", \"quantity_in_asset\": \"681.66000\", \"quantity\": \"75.74\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-06 18:33:38\", \"date_modified\": \"2021-10-06 18:35:53\"}, {\"_id\": \"615c7599d7b676a9305f430d\", \"user_id\": \"6013f191d7b676a9305f3e0e\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"142716\", \"quantity_in_asset\": \"8562.96000\", \"quantity\": \"1427.16\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-05 15:56:09\", \"date_modified\": \"2021-10-05 15:59:10\"}, {\"_id\": \"615b7361d7b676a9305f41de\", \"user_id\": \"6013f191d7b676a9305f3e0c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"fth\", \"quantity_in_fiat\": \"8803\", \"quantity_in_asset\": \"88.03000\", \"quantity\": \"88.03\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"ebutler.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e6e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-04 21:34:25\", \"date_modified\": \"2021-10-04 21:36:14\"}, {\"_id\": \"615695abd7b676a9305f4293\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"12471\", \"quantity_in_asset\": \"17.81571\", \"quantity\": \"124.71\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-01 04:59:23\", \"date_modified\": \"2021-10-01 05:00:22\"}, {\"_id\": \"6152c402d7b676a9305f4381\", \"user_id\": \"6013f191d7b676a9305f3e0c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"361458\", \"quantity_in_asset\": \"14458.32000\", \"quantity\": \"3614.58\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-28 07:28:02\", \"date_modified\": \"2021-09-28 07:30:43\"}, {\"_id\": \"6149a19cd7b676a9305f4425\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"167275\", \"quantity_in_asset\": \"836.37500\", \"quantity\": \"1672.75\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jackconley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7c\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-21 09:10:52\", \"date_modified\": \"2021-09-21 09:12:05\"}, {\"_id\": \"61478282d7b676a9305f42f2\", \"user_id\": \"6013f191d7b676a9305f3e34\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"9039\", \"quantity_in_asset\": \"22.59750\", \"quantity\": \"90.39\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-19 18:33:38\", \"date_modified\": \"2021-09-19 18:36:02\"}, {\"_id\": \"61438e02d7b676a9305f43ba\", \"user_id\": \"6013f191d7b676a9305f3e34\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"102550\", \"quantity_in_asset\": \"512.75000\", \"quantity\": \"1025.50\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-16 18:33:38\", \"date_modified\": \"2021-09-16 18:36:40\"}, {\"_id\": \"6141b89cd7b676a9305f443c\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"5690\", \"quantity_in_asset\": \"56.90000\", \"quantity\": \"56.90\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-15 09:10:52\", \"date_modified\": \"2021-09-15 09:13:14\"}, {\"_id\": \"6141a082d7b676a9305f43d0\", \"user_id\": \"6013f191d7b676a9305f3e31\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"fth\", \"quantity_in_fiat\": \"58014\", \"quantity_in_asset\": \"290.07000\", \"quantity\": \"580.14\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"ebutler.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e6e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-15 07:28:02\", \"date_modified\": \"2021-09-15 07:28:14\"}, {\"_id\": \"613c9608d7b676a9305f424b\", \"user_id\": \"6013f191d7b676a9305f3e1f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"fth\", \"quantity_in_fiat\": \"9978\", \"quantity_in_asset\": \"399.12000\", \"quantity\": \"99.78\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"ebutler.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e6e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-11 11:42:00\", \"date_modified\": \"2021-09-11 11:43:57\"}, {\"_id\": \"613994abd7b676a9305f42b7\", \"user_id\": \"6013f191d7b676a9305f3e22\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"30648\", \"quantity_in_asset\": \"1532.40000\", \"quantity\": \"306.48\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-09 04:59:23\", \"date_modified\": \"2021-09-09 05:01:12\"}, {\"_id\": \"61359936d7b676a9305f43fc\", \"user_id\": \"6013f191d7b676a9305f3e1e\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"47842\", \"quantity_in_asset\": \"478.42000\", \"quantity\": \"478.42\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-06 04:29:42\", \"date_modified\": \"2021-09-06 04:32:20\"}, {\"_id\": \"613546f5d7b676a9305f41d0\", \"user_id\": \"6013f191d7b676a9305f3e15\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"104324\", \"quantity_in_asset\": \"1043.24000\", \"quantity\": \"1043.24\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jackconley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7c\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-05 22:38:45\", \"date_modified\": \"2021-09-05 22:41:11\"}, {\"_id\": \"61335b88d7b676a9305f4242\", \"user_id\": \"6013f191d7b676a9305f3e09\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"18703\", \"quantity_in_asset\": \"1122.18000\", \"quantity\": \"187.03\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jackconley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7c\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-04 11:42:00\", \"date_modified\": \"2021-09-04 11:42:27\"}, {\"_id\": \"612a5c99d7b676a9305f4371\", \"user_id\": \"6013f191d7b676a9305f3e09\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"58963\", \"quantity_in_asset\": \"4127.41000\", \"quantity\": \"589.63\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-28 15:56:09\", \"date_modified\": \"2021-08-28 15:59:09\"}, {\"_id\": \"6129bbb6d7b676a9305f4475\", \"user_id\": \"6013f191d7b676a9305f3e14\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"24393\", \"quantity_in_asset\": \"40.65500\", \"quantity\": \"243.93\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jackconley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7c\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-28 04:29:42\", \"date_modified\": \"2021-08-28 04:32:48\"}, {\"_id\": \"612952bed7b676a9305f4225\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"105004\", \"quantity_in_asset\": \"150.00571\", \"quantity\": \"1050.04\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-27 21:01:50\", \"date_modified\": \"2021-08-27 21:02:52\"}]}")

    def test_get_deposits_mutation_2(self):
        task = transaction_service.get_deposits.s(
            None, 20, 2, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 297, \"total_pages\": 15, \"current_page\": 2, \"content\": [{\"_id\": \"612718b6d7b676a9305f448f\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"19959\", \"quantity_in_asset\": \"49.89750\", \"quantity\": \"199.59\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-26 04:29:42\", \"date_modified\": \"2021-08-26 04:29:56\"}, {\"_id\": \"61249f82d7b676a9305f439f\", \"user_id\": \"6013f191d7b676a9305f3e22\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"198715\", \"quantity_in_asset\": \"993.57500\", \"quantity\": \"1987.15\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-24 07:28:02\", \"date_modified\": \"2021-08-24 07:30:05\"}, {\"_id\": \"611fd099d7b676a9305f4354\", \"user_id\": \"6013f191d7b676a9305f3e14\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"5696\", \"quantity_in_asset\": \"18.98667\", \"quantity\": \"56.96\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-20 15:56:09\", \"date_modified\": \"2021-08-20 15:58:11\"}, {\"_id\": \"611cfbbbd7b676a9305f43b2\", \"user_id\": \"6013f191d7b676a9305f3e31\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"2096604\", \"quantity_in_asset\": \"2620.75500\", \"quantity\": \"20966.04\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-18 12:23:23\", \"date_modified\": \"2021-08-18 12:24:17\"}, {\"_id\": \"611cb682d7b676a9305f438d\", \"user_id\": \"6013f191d7b676a9305f3e2a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"30656\", \"quantity_in_asset\": \"51.09333\", \"quantity\": \"306.56\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-18 07:28:02\", \"date_modified\": \"2021-08-18 07:28:24\"}, {\"_id\": \"6113f319d7b676a9305f4318\", \"user_id\": \"6013f191d7b676a9305f3e2e\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"5248\", \"quantity_in_asset\": \"13.12000\", \"quantity\": \"52.48\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-11 15:56:09\", \"date_modified\": \"2021-08-11 15:58:43\"}, {\"_id\": \"61126608d7b676a9305f4266\", \"user_id\": \"6013f191d7b676a9305f3e0c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"7065\", \"quantity_in_asset\": \"141.30000\", \"quantity\": \"70.65\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-10 11:42:00\", \"date_modified\": \"2021-08-10 11:43:00\"}, {\"_id\": \"6110d902d7b676a9305f43c0\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"13166\", \"quantity_in_asset\": \"526.64000\", \"quantity\": \"131.66\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-09 07:28:02\", \"date_modified\": \"2021-08-09 07:28:05\"}, {\"_id\": \"6108c636d7b676a9305f4433\", \"user_id\": \"6013f191d7b676a9305f3e22\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"32773\", \"quantity_in_asset\": \"655.46000\", \"quantity\": \"327.73\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jackconley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7c\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-03 04:29:42\", \"date_modified\": \"2021-08-03 04:32:52\"}, {\"_id\": \"6106e902d7b676a9305f433b\", \"user_id\": \"6013f191d7b676a9305f3e34\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"fth\", \"quantity_in_fiat\": \"15105\", \"quantity_in_asset\": \"50.35000\", \"quantity\": \"151.05\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"ebutler.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e6e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-01 18:33:38\", \"date_modified\": \"2021-08-01 18:35:53\"}, {\"_id\": \"60f65136d7b676a9305f4417\", \"user_id\": \"6013f191d7b676a9305f3e30\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"5967\", \"quantity_in_asset\": \"9.94500\", \"quantity\": \"59.67\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-20 04:29:42\", \"date_modified\": \"2021-07-20 04:31:25\"}, {\"_id\": \"60f52982d7b676a9305f43ed\", \"user_id\": \"6013f191d7b676a9305f3e31\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"17062\", \"quantity_in_asset\": \"56.87333\", \"quantity\": \"170.62\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-19 07:28:02\", \"date_modified\": \"2021-07-19 07:28:31\"}, {\"_id\": \"60f29e9cd7b676a9305f440c\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"18953\", \"quantity_in_asset\": \"21.05889\", \"quantity\": \"189.53\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-17 09:10:52\", \"date_modified\": \"2021-07-17 09:13:41\"}, {\"_id\": \"60f28682d7b676a9305f4343\", \"user_id\": \"6013f191d7b676a9305f3e0b\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"7100\", \"quantity_in_asset\": \"142.00000\", \"quantity\": \"71.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-17 07:28:02\", \"date_modified\": \"2021-07-17 07:28:05\"}, {\"_id\": \"60f263abd7b676a9305f42f8\", \"user_id\": \"6013f191d7b676a9305f3e14\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"9422\", \"quantity_in_asset\": \"18.84400\", \"quantity\": \"94.22\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-17 04:59:23\", \"date_modified\": \"2021-07-17 05:02:01\"}, {\"_id\": \"60f035e4d7b676a9305f425c\", \"user_id\": \"6013f191d7b676a9305f3e24\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"2300898\", \"quantity_in_asset\": \"7669.66000\", \"quantity\": \"23008.98\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-15 13:19:32\", \"date_modified\": \"2021-07-15 13:20:53\"}, {\"_id\": \"60ebcc2bd7b676a9305f42c1\", \"user_id\": \"6013f191d7b676a9305f3e22\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"6735\", \"quantity_in_asset\": \"336.75000\", \"quantity\": \"67.35\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-12 04:59:23\", \"date_modified\": \"2021-07-12 05:02:18\"}, {\"_id\": \"60eb0e93d7b676a9305f4210\", \"user_id\": \"6013f191d7b676a9305f3e1f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"14907\", \"quantity_in_asset\": \"1043.49000\", \"quantity\": \"149.07\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jackconley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7c\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-11 15:30:27\", \"date_modified\": \"2021-07-11 15:32:03\"}, {\"_id\": \"60e9e802d7b676a9305f431e\", \"user_id\": \"6013f191d7b676a9305f3e34\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"fth\", \"quantity_in_fiat\": \"103241\", \"quantity_in_asset\": \"1032.41000\", \"quantity\": \"1032.41\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"ebutler.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e6e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-10 18:33:38\", \"date_modified\": \"2021-07-10 18:34:03\"}, {\"_id\": \"60dd709cd7b676a9305f42c8\", \"user_id\": \"6013f191d7b676a9305f3e2d\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"94665\", \"quantity_in_asset\": \"5679.90000\", \"quantity\": \"946.65\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-01 07:37:00\", \"date_modified\": \"2021-07-01 07:37:25\"}]}")

    def test_get_deposits_mutation_3(self):
        task = transaction_service.get_deposits.s(
            None, 20, 3, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 297, \"total_pages\": 15, \"current_page\": 3, \"content\": [{\"_id\": \"60d89f99d7b676a9305f4393\", \"user_id\": \"6013f191d7b676a9305f3e34\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"fth\", \"quantity_in_fiat\": \"12506\", \"quantity_in_asset\": \"31.26500\", \"quantity\": \"125.06\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"ebutler.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e6e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-27 15:56:09\", \"date_modified\": \"2021-06-27 15:57:34\"}, {\"_id\": \"60d89993d7b676a9305f4216\", \"user_id\": \"6013f191d7b676a9305f3e1f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"5097\", \"quantity_in_asset\": \"305.82000\", \"quantity\": \"50.97\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-27 15:30:27\", \"date_modified\": \"2021-06-27 15:30:27\"}, {\"_id\": \"60d6b42bd7b676a9305f42af\", \"user_id\": \"6013f191d7b676a9305f3e1b\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"17860\", \"quantity_in_asset\": \"29.76667\", \"quantity\": \"178.60\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-26 04:59:23\", \"date_modified\": \"2021-06-26 05:00:06\"}, {\"_id\": \"60d45c39d7b676a9305f427b\", \"user_id\": \"6013f191d7b676a9305f3e2a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"6658\", \"quantity_in_asset\": \"399.48000\", \"quantity\": \"66.58\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jackconley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7c\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-24 10:19:37\", \"date_modified\": \"2021-06-24 10:20:27\"}, {\"_id\": \"60d2fa9cd7b676a9305f447b\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"22600\", \"quantity_in_asset\": \"1356.00000\", \"quantity\": \"226.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jackconley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7c\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-23 09:10:52\", \"date_modified\": \"2021-06-23 09:11:27\"}, {\"_id\": \"60ce62e1d7b676a9305f41b9\", \"user_id\": \"6013f191d7b676a9305f3e0d\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"5408\", \"quantity_in_asset\": \"378.56000\", \"quantity\": \"54.08\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-19 21:34:25\", \"date_modified\": \"2021-06-19 21:37:28\"}, {\"_id\": \"60c6723ed7b676a9305f421f\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"7071\", \"quantity_in_asset\": \"7.85667\", \"quantity\": \"70.71\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-13 21:01:50\", \"date_modified\": \"2021-06-13 21:02:49\"}, {\"_id\": \"60c3e5f5d7b676a9305f420d\", \"user_id\": \"6013f191d7b676a9305f3e0c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"73974\", \"quantity_in_asset\": \"82.19333\", \"quantity\": \"739.74\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"cancel\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-11 22:38:45\", \"date_modified\": \"2021-06-11 22:41:35\"}, {\"_id\": \"60b9b32bd7b676a9305f42ce\", \"user_id\": \"6013f191d7b676a9305f3e0c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"438743\", \"quantity_in_asset\": \"1096.85750\", \"quantity\": \"4387.43\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-04 04:59:23\", \"date_modified\": \"2021-06-04 05:01:06\"}, {\"_id\": \"60b46d2bd7b676a9305f428d\", \"user_id\": \"6013f191d7b676a9305f3e1a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"fth\", \"quantity_in_fiat\": \"53187\", \"quantity_in_asset\": \"531.87000\", \"quantity\": \"531.87\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"ebutler.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e6e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-31 04:59:23\", \"date_modified\": \"2021-05-31 05:00:42\"}, {\"_id\": \"60af7239d7b676a9305f4281\", \"user_id\": \"6013f191d7b676a9305f3e2a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"34559\", \"quantity_in_asset\": \"49.37000\", \"quantity\": \"345.59\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-27 10:19:37\", \"date_modified\": \"2021-05-27 10:20:25\"}, {\"_id\": \"60af1959d7b676a9305f41f9\", \"user_id\": \"6013f191d7b676a9305f3e1a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"22792\", \"quantity_in_asset\": \"455.84000\", \"quantity\": \"227.92\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-27 04:00:25\", \"date_modified\": \"2021-05-27 04:00:35\"}, {\"_id\": \"60adfa9cd7b676a9305f42d9\", \"user_id\": \"6013f191d7b676a9305f3e2d\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"194063\", \"quantity_in_asset\": \"388.12600\", \"quantity\": \"1940.63\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jackconley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7c\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-26 07:37:00\", \"date_modified\": \"2021-05-26 07:37:04\"}, {\"_id\": \"60a5033bd7b676a9305f43ca\", \"user_id\": \"6013f191d7b676a9305f3e31\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"8181\", \"quantity_in_asset\": \"9.09000\", \"quantity\": \"81.81\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-19 12:23:23\", \"date_modified\": \"2021-05-19 12:25:06\"}, {\"_id\": \"609a6d88d7b676a9305f4245\", \"user_id\": \"6013f191d7b676a9305f3e1e\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"572270\", \"quantity_in_asset\": \"715.33750\", \"quantity\": \"5722.70\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-11 11:42:00\", \"date_modified\": \"2021-05-11 11:42:15\"}, {\"_id\": \"6095cc7fd7b676a9305f4457\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"23814\", \"quantity_in_asset\": \"26.46000\", \"quantity\": \"238.14\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-07 23:25:51\", \"date_modified\": \"2021-05-07 23:28:21\"}, {\"_id\": \"609370b6d7b676a9305f4495\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"fth\", \"quantity_in_fiat\": \"13415\", \"quantity_in_asset\": \"268.30000\", \"quantity\": \"134.15\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"ebutler.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e6e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-06 04:29:42\", \"date_modified\": \"2021-05-06 04:30:25\"}, {\"_id\": \"60913cbbd7b676a9305f434c\", \"user_id\": \"6013f191d7b676a9305f3e31\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"77071\", \"quantity_in_asset\": \"770.71000\", \"quantity\": \"770.71\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-04 12:23:23\", \"date_modified\": \"2021-05-04 12:23:47\"}, {\"_id\": \"608aaad4d7b676a9305f423c\", \"user_id\": \"6013f191d7b676a9305f3e21\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"7427\", \"quantity_in_asset\": \"8.25222\", \"quantity\": \"74.27\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-04-29 12:47:16\", \"date_modified\": \"2021-04-29 12:49:31\"}, {\"_id\": \"607fb12bd7b676a9305f4287\", \"user_id\": \"6013f191d7b676a9305f3e12\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"41434\", \"quantity_in_asset\": \"103.58500\", \"quantity\": \"414.34\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-04-21 04:59:23\", \"date_modified\": \"2021-04-21 04:59:48\"}]}")

    def test_get_deposits_mutation_4(self):
        task = transaction_service.get_deposits.s(
            None, 20, 4, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 297, \"total_pages\": 15, \"current_page\": 4, \"content\": [{\"_id\": \"606f875cd7b676a9305f41be\", \"user_id\": \"6013f191d7b676a9305f3e14\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"18249\", \"quantity_in_asset\": \"182.49000\", \"quantity\": \"182.49\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-04-08 22:44:44\", \"date_modified\": \"2021-04-08 22:46:22\"}, {\"_id\": \"606e2561d7b676a9305f41c4\", \"user_id\": \"6013f191d7b676a9305f3e0c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"115960\", \"quantity_in_asset\": \"10436.40000\", \"quantity\": \"1159.60\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-04-07 21:34:25\", \"date_modified\": \"2021-04-07 21:34:38\"}, {\"_id\": \"606106dcd7b676a9305f41f3\", \"user_id\": \"6013f191d7b676a9305f3e14\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"67382\", \"quantity_in_asset\": \"112.30333\", \"quantity\": \"673.82\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-28 22:44:44\", \"date_modified\": \"2021-03-28 22:45:00\"}, {\"_id\": \"60561b19d7b676a9305f4369\", \"user_id\": \"6013f191d7b676a9305f3e35\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"fth\", \"quantity_in_fiat\": \"37163\", \"quantity_in_asset\": \"61.93833\", \"quantity\": \"371.63\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"ebutler.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e6e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-20 15:56:09\", \"date_modified\": \"2021-03-20 15:57:48\"}, {\"_id\": \"605185b6d7b676a9305f4014\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"50.00000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f456f\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-17 04:29:42\", \"date_modified\": \"2021-03-17 04:30:59\"}, {\"_id\": \"60512461d7b676a9305f41af\", \"user_id\": \"6013f191d7b676a9305f3e0c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"9778\", \"quantity_in_asset\": \"586.68000\", \"quantity\": \"97.78\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-16 21:34:25\", \"date_modified\": \"2021-03-16 21:35:01\"}, {\"_id\": \"604ee2b6d7b676a9305f3f76\", \"user_id\": \"6013f191d7b676a9305f3e14\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"12.50000\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f456e\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-15 04:29:42\", \"date_modified\": \"2021-03-15 04:29:42\"}, {\"_id\": \"604bf87fd7b676a9305f417b\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"95000\", \"quantity_in_asset\": \"158.33333\", \"quantity\": \"950.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f456d\", \"strategy_name\": \"jackconley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7c\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-12 23:25:51\", \"date_modified\": \"2021-03-12 23:26:00\"}, {\"_id\": \"604aee36d7b676a9305f4003\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"50.00000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f456b\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-12 04:29:42\", \"date_modified\": \"2021-03-12 04:31:27\"}, {\"_id\": \"604aee36d7b676a9305f4176\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"100.00000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f456c\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-12 04:29:42\", \"date_modified\": \"2021-03-12 04:30:03\"}, {\"_id\": \"604aee36d7b676a9305f3eb4\", \"user_id\": \"6013f191d7b676a9305f3e09\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"250.00000\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f456a\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-12 04:29:42\", \"date_modified\": \"2021-03-12 04:30:39\"}, {\"_id\": \"604aa6ffd7b676a9305f417a\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"40000\", \"quantity_in_asset\": \"57.14286\", \"quantity\": \"400.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f4569\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"pending\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-11 23:25:51\", \"date_modified\": \"2021-03-11 23:27:31\"}, {\"_id\": \"60488d1cd7b676a9305f41a7\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"35000\", \"quantity_in_asset\": \"175.00000\", \"quantity\": \"350.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f4568\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-10 09:10:52\", \"date_modified\": \"2021-03-10 09:14:04\"}, {\"_id\": \"60484b36d7b676a9305f3ffb\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"20000\", \"quantity_in_asset\": \"800.00000\", \"quantity\": \"200.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f4567\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-10 04:29:42\", \"date_modified\": \"2021-03-10 04:30:33\"}, {\"_id\": \"604803ffd7b676a9305f4172\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"45000\", \"quantity_in_asset\": \"900.00000\", \"quantity\": \"450.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f4566\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-09 23:25:51\", \"date_modified\": \"2021-03-09 23:27:55\"}, {\"_id\": \"60473b9cd7b676a9305f41a3\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"33.33333\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f4565\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-09 09:10:52\", \"date_modified\": \"2021-03-09 09:12:44\"}, {\"_id\": \"6046f9b6d7b676a9305f3f5e\", \"user_id\": \"6013f191d7b676a9305f3e14\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"900.00000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f4564\", \"strategy_name\": \"cle.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7f\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-09 04:29:42\", \"date_modified\": \"2021-03-09 04:30:35\"}, {\"_id\": \"6046b27fd7b676a9305f416e\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"25000\", \"quantity_in_asset\": \"750.00000\", \"quantity\": \"250.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f4563\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-08 23:25:51\", \"date_modified\": \"2021-03-08 23:26:52\"}, {\"_id\": \"6045ea1cd7b676a9305f419f\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"300.00000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f4562\", \"strategy_name\": \"jeffreyhurley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7b\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-08 09:10:52\", \"date_modified\": \"2021-03-08 09:11:05\"}, {\"_id\": \"604560ffd7b676a9305f416a\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"fth\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"450.00000\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f4561\", \"strategy_name\": \"ebutler.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e6e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-07 23:25:51\", \"date_modified\": \"2021-03-07 23:27:27\"}]}")

    def test_get_deposit_mutation_0(self):
        task = transaction_service.get_deposit.s(
            '6046b27fd7b676a9305f416e'
        ).apply()
        self.assertEqual(task.result, {"_id": "6046b27fd7b676a9305f416e", "user_id": "6013f191d7b676a9305f3e38", "method": "ideal", "coin": "eur", "exchange": "binance", "bank": "external", "bank_name": "ing", "base_asset": "pot", "quantity_in_fiat": "25000", "quantity_in_asset": "750.00000", "quantity": "250.00", "intern_address": "", "extern_address": "", "transaction_id": "11cad38e7c1b2a381ee0f74228b783036750e9cc", "strategy_name": "adam10.bot", "strategy_id": "6013f191d7b676a9305f3e72", "order_status": "approved", "trans_direction": "extern-transfer", "fee": "0.200000", "comment": "", "sandbox": False, "ip": "212.187.38.92", "date_added": 1615242351, "date_modified": "2021-03-08 23:26:52", "provider": "paynl", "payment_reference": "d761c3f1312e013751cf6058bb0669ced7a292df", "payment_url": "https://ideal.ing.com/?authorisationId=617908918168&transactionId=8446369802058774", "order_id": "fbf33a3ede517c0c032dc0a5ee958379eda6ad64", "error_id": "", "error_message": "", "ext_trans_id": "11cad38e7c1b2a381ee0f74228b783036750e9cc"})

    def test_get_deposit_mutation_1(self):
        task = transaction_service.get_deposit.s(
            '6046b27fd7b676a9305f416e'
        ).apply()
        self.assertEqual(task.result, {"_id": "6046b27fd7b676a9305f416e", "user_id": "6013f191d7b676a9305f3e38", "method": "ideal", "coin": "eur", "exchange": "binance", "bank": "external", "bank_name": "ing", "base_asset": "pot", "quantity_in_fiat": "25000", "quantity_in_asset": "750.00000", "quantity": "250.00", "intern_address": "", "extern_address": "", "transaction_id": "11cad38e7c1b2a381ee0f74228b783036750e9cc", "strategy_name": "adam10.bot", "strategy_id": "6013f191d7b676a9305f3e72", "order_status": "approved", "trans_direction": "extern-transfer", "fee": "0.200000", "comment": "", "sandbox": False, "ip": "212.187.38.92", "date_added": 1615242351, "date_modified": "2021-03-08 23:26:52", "provider": "paynl", "payment_reference": "d761c3f1312e013751cf6058bb0669ced7a292df", "payment_url": "https://ideal.ing.com/?authorisationId=617908918168&transactionId=8446369802058774", "order_id": "fbf33a3ede517c0c032dc0a5ee958379eda6ad64", "error_id": "", "error_message": "", "ext_trans_id": "11cad38e7c1b2a381ee0f74228b783036750e9cc"})

    def test_get_customer_deposit_snapshot_mutation_0(self):
        task = transaction_service.get_customer_deposit_snapshot.s(
            user_id='6013f191d7b676a9305f3e36'
        ).apply()
        self.assertEqual(task.result, "[{\"date\": \"2021-02-24\", \"time\": \"13:03:07\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 450.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2021-11-14\", \"time\": \"13:03:07\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 889.24 (internal)\", \"status\": \"approved\"}]")

    def test_get_customer_withdrawal_snapshot_mutation_0(self):
        task = transaction_service.get_customer_withdrawal_snapshot.s(
            user_id='6013f191d7b676a9305f3e36'
        ).apply()
        self.assertEqual(task.result, "[]")

    def test_get_customer_withdrawal_snapshot_mutation_1(self):
        task = transaction_service.get_customer_withdrawal_snapshot.s(
            user_id='6013f191d7b676a9305f3e36'
        ).apply()
        self.assertEqual(task.result, "[]")

    def test_get_deposits_mutation_5(self):
        task = transaction_service.get_deposits.s(
            '6013f191d7b676a9305f3e36', 10, 0, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 2, \"total_pages\": 1, \"current_page\": 0, \"content\": [{\"_id\": \"6191090bd7b676a9305f43e5\", \"user_id\": \"6013f191d7b676a9305f3e36\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"lsk\", \"quantity_in_fiat\": \"88924\", \"quantity_in_asset\": \"6224.68000\", \"quantity\": \"889.24\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonapril.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e78\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-14 13:03:07\", \"date_modified\": \"2021-11-14 13:05:07\"}, {\"_id\": \"60364e8bd7b676a9305f4145\", \"user_id\": \"6013f191d7b676a9305f3e36\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"45000\", \"quantity_in_asset\": \"90.00000\", \"quantity\": \"450.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f453e\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-24 13:03:07\", \"date_modified\": \"2021-02-24 13:03:39\"}]}")

    def test_get_withdraws_mutation_0(self):
        task = transaction_service.get_withdraws.s(
            '6013f191d7b676a9305f3e36', 10, 0, 'date_added', 'desc', None, None, None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 0, \"total_pages\": 0, \"current_page\": 0, \"content\": []}")

    def test_get_withdrawable_amount_dump_mutation_0(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6013f191d7b676a9305f3e36'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_withdrawable_amount_mutation_0(self):
        task = transaction_service.get_withdrawable_amount.s(
            889.24, '6013f191d7b676a9305f3e36'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount": 889.24})

    def test_get_withdrawable_amount_dump_mutation_1(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6013f191d7b676a9305f3e36'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_withdrawable_amount_mutation_1(self):
        task = transaction_service.get_withdrawable_amount.s(
            889.24, '6013f191d7b676a9305f3e36'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount": 889.24})

    def test_get_user_deposit_amount_mutation_0(self):
        task = transaction_service.get_user_deposit_amount.s(
            user_id='6013f191d7b676a9305f3e36'
        ).apply()
        self.assertEqual(task.result, {"_id": "", "deposit_amount": 450.0})

    def test_get_user_withdraw_amount_mutation_0(self):
        task = transaction_service.get_user_withdraw_amount.s(
            user_id='6013f191d7b676a9305f3e36'
        ).apply()
        self.assertEqual(task.result, {"withdrawal_amount": 0})

    def test_get_last_transaction_id_mutation_0(self):
        task = transaction_service.get_last_transaction_id.s(
            user_id='6013f191d7b676a9305f3e36'
        ).apply()
        self.assertEqual(task.result, {"last_transaction": "-"})

    def test_get_withdrawal_bank_account_mutation_0(self):
        task = transaction_service.get_withdrawal_bank_account.s(
            user_id='6013f191d7b676a9305f3e36'
        ).apply()
        self.assertEqual(task.result, {"bank_account": "Not registered"})

    def test_get_customer_deposit_snapshot_mutation_1(self):
        task = transaction_service.get_customer_deposit_snapshot.s(
            user_id='6013f191d7b676a9305f3e33'
        ).apply()
        self.assertEqual(task.result, "[]")

    def test_get_customer_withdrawal_snapshot_mutation_2(self):
        task = transaction_service.get_customer_withdrawal_snapshot.s(
            user_id='6013f191d7b676a9305f3e33'
        ).apply()
        self.assertEqual(task.result, "[]")

    def test_get_customer_withdrawal_snapshot_mutation_3(self):
        task = transaction_service.get_customer_withdrawal_snapshot.s(
            user_id='6013f191d7b676a9305f3e33'
        ).apply()
        self.assertEqual(task.result, "[]")

    def test_get_deposits_mutation_6(self):
        task = transaction_service.get_deposits.s(
            '6013f191d7b676a9305f3e33', 10, 0, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 0, \"total_pages\": 0, \"current_page\": 0, \"content\": []}")

    def test_get_withdraws_mutation_1(self):
        task = transaction_service.get_withdraws.s(
            '6013f191d7b676a9305f3e33', 10, 0, 'date_added', 'desc', None, None, None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 0, \"total_pages\": 0, \"current_page\": 0, \"content\": []}")

    def test_get_withdraws_mutation_2(self):
        task = transaction_service.get_withdraws.s(
            '6013f191d7b676a9305f3e33', 10, 0, 'date_added', 'desc', None, None, None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 0, \"total_pages\": 0, \"current_page\": 0, \"content\": []}")

    def test_get_withdrawable_amount_dump_mutation_2(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6013f191d7b676a9305f3e33'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_withdrawable_amount_dump_mutation_3(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6013f191d7b676a9305f3e33'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_withdrawable_amount_mutation_2(self):
        task = transaction_service.get_withdrawable_amount.s(
            0, '6013f191d7b676a9305f3e33'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount": 0})

    def test_get_withdrawable_amount_mutation_3(self):
        task = transaction_service.get_withdrawable_amount.s(
            0, '6013f191d7b676a9305f3e33'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount": 0})

    def test_get_user_deposit_amount_mutation_1(self):
        task = transaction_service.get_user_deposit_amount.s(
            user_id='6013f191d7b676a9305f3e33'
        ).apply()
        self.assertEqual(task.result, {"deposit_amount": 0})

    def test_get_user_withdraw_amount_mutation_1(self):
        task = transaction_service.get_user_withdraw_amount.s(
            user_id='6013f191d7b676a9305f3e33'
        ).apply()
        self.assertEqual(task.result, {"withdrawal_amount": 0})

    def test_get_last_transaction_id_mutation_1(self):
        task = transaction_service.get_last_transaction_id.s(
            user_id='6013f191d7b676a9305f3e33'
        ).apply()
        self.assertEqual(task.result, {"last_transaction": "-"})

    def test_get_withdrawal_bank_account_mutation_1(self):
        task = transaction_service.get_withdrawal_bank_account.s(
            user_id='6013f191d7b676a9305f3e33'
        ).apply()
        self.assertEqual(task.result, {"bank_account": "Not registered"})

    def test_get_customer_deposit_snapshot_mutation_2(self):
        task = transaction_service.get_customer_deposit_snapshot.s(
            user_id='6013f191d7b676a9305f3e2f'
        ).apply()
        self.assertEqual(task.result, "[]")

    def test_get_customer_withdrawal_snapshot_mutation_4(self):
        task = transaction_service.get_customer_withdrawal_snapshot.s(
            user_id='6013f191d7b676a9305f3e2f'
        ).apply()
        self.assertEqual(task.result, "[]")

    def test_get_customer_withdrawal_snapshot_mutation_5(self):
        task = transaction_service.get_customer_withdrawal_snapshot.s(
            user_id='6013f191d7b676a9305f3e2f'
        ).apply()
        self.assertEqual(task.result, "[]")

    def test_get_deposits_mutation_7(self):
        task = transaction_service.get_deposits.s(
            '6013f191d7b676a9305f3e2f', 10, 0, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 0, \"total_pages\": 0, \"current_page\": 0, \"content\": []}")

    def test_get_withdraws_mutation_3(self):
        task = transaction_service.get_withdraws.s(
            '6013f191d7b676a9305f3e2f', 10, 0, 'date_added', 'desc', None, None, None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 0, \"total_pages\": 0, \"current_page\": 0, \"content\": []}")

    def test_get_withdraws_mutation_4(self):
        task = transaction_service.get_withdraws.s(
            '6013f191d7b676a9305f3e2f', 10, 0, 'date_added', 'desc', None, None, None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 0, \"total_pages\": 0, \"current_page\": 0, \"content\": []}")

    def test_get_withdrawable_amount_dump_mutation_4(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6013f191d7b676a9305f3e2f'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_withdrawable_amount_dump_mutation_5(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6013f191d7b676a9305f3e2f'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_withdrawable_amount_mutation_4(self):
        task = transaction_service.get_withdrawable_amount.s(
            0, '6013f191d7b676a9305f3e2f'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount": 0})

    def test_get_withdrawable_amount_mutation_5(self):
        task = transaction_service.get_withdrawable_amount.s(
            0, '6013f191d7b676a9305f3e2f'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount": 0})

    def test_get_withdraws_mutation_5(self):
        task = transaction_service.get_withdraws.s(
            None, 20, 0, 'date_added', 'desc', None, None, None, 'ADMIN', None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 25, \"total_pages\": 2, \"current_page\": 0, \"content\": [{\"_id\": \"61ee6d1cd7b676a9305f4444\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"account_number\": \"NL85UVVJ8017442037\", \"holder_name\": \"LANA CATO KUIJPERS\", \"description\": \"RevenYOU withdrawal #8a918d9c1c35be0aefea057586a72875796c3b9b\", \"method\": \"ideal\", \"order_id\": \"d403a0708549944923c3968f37982f1dd2173109\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"324.29\", \"withdrawal_amount_fiat\": \"319.43\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"32429\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2022-01-24 09:10:52\", \"date_modified\": \"2022-01-24 09:13:01\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61d01a9cd7b676a9305f448a\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"account_number\": \"NL88XNBJ6773233727\", \"holder_name\": \"LANA CATO KUIJPERS\", \"description\": \"RevenYOU withdrawal #8be511e8e986516566fd2911809f29624a39ce47\", \"method\": \"ideal\", \"order_id\": \"3e9a30225a9e4bee7488352b5a5a8ad72be6a092\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"418.18\", \"withdrawal_amount_fiat\": \"411.91\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"41818\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2022-01-01 09:10:52\", \"date_modified\": \"2022-01-01 09:12:26\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61bd8d82d7b676a9305f4349\", \"user_id\": \"6013f191d7b676a9305f3e18\", \"account_number\": \"NL73QUXV2737972620\", \"holder_name\": \"BRYAN OWEN VI\", \"description\": \"RevenYOU withdrawal #dfd7a305435c8f8534523cc5963662e30b95d511\", \"method\": \"ideal\", \"order_id\": \"e68f0202a5eb34a10a7baf7aa4b8b1bd6b52c483\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"45.58\", \"withdrawal_amount_fiat\": \"44.90\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4558\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-12-18 07:28:02\", \"date_modified\": \"2021-12-18 07:30:38\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61aee336d7b676a9305f4439\", \"user_id\": \"6013f191d7b676a9305f3e24\", \"account_number\": \"NL11PHFR9371194774\", \"holder_name\": \"SAMI SJOERD VAN WEL\", \"description\": \"RevenYOU withdrawal #88eb3826b4e5965d889048453f09d44788d0d845\", \"method\": \"ideal\", \"order_id\": \"4cfe5452f0959801064466f18fc507b26e3dd37a\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"241.87\", \"withdrawal_amount_fiat\": \"238.24\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"24187\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-12-07 04:29:42\", \"date_modified\": \"2021-12-07 04:31:17\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61a72402d7b676a9305f43e2\", \"user_id\": \"6013f191d7b676a9305f3e31\", \"account_number\": \"NL76HILL9644749367\", \"holder_name\": \"VIGO EVA STETTYN\", \"description\": \"RevenYOU withdrawal #4b33af8c9091611567c80841642ba34c43de040e\", \"method\": \"ideal\", \"order_id\": \"3f872c762cc0ccda415c4c2a71b3e853a0d04f3d\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"455.73\", \"withdrawal_amount_fiat\": \"448.89\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"45573\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-12-01 07:28:02\", \"date_modified\": \"2021-12-01 07:31:17\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"619bbd99d7b676a9305f4338\", \"user_id\": \"6013f191d7b676a9305f3e35\", \"account_number\": \"NL35HFQI1974179893\", \"holder_name\": \"NOVA KYAN VAN ENGELEN\", \"description\": \"RevenYOU withdrawal #61c818b710c18610bf500fbc8830e38d1816fbdb\", \"method\": \"ideal\", \"order_id\": \"7270e5965ea85fc3f34563dcd1c1e2c36798a42b\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"333.52\", \"withdrawal_amount_fiat\": \"328.52\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"33352\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"pending\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": False, \"date_added\": \"2021-11-22 15:56:09\", \"date_modified\": \"2021-11-22 15:59:25\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"618e8e99d7b676a9305f4331\", \"user_id\": \"6013f191d7b676a9305f3e0e\", \"account_number\": \"NL75DVJF1070387778\", \"holder_name\": \"JOSHUA ROSALIE PRINS\", \"description\": \"RevenYOU withdrawal #776167178962a8efbc8f54d70e662c892e9b763d\", \"method\": \"ideal\", \"order_id\": \"ac8ca7825a6c59ddf5378f9194ca4c97f9b477b2\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"34.89\", \"withdrawal_amount_fiat\": \"34.37\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"3489\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-11-12 15:56:09\", \"date_modified\": \"2021-11-12 15:59:10\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61773b41d7b676a9305f42e7\", \"user_id\": \"6013f191d7b676a9305f3e32\", \"account_number\": \"NL08TUFL3677619038\", \"holder_name\": \"MELISSA DUUK VAN DER STEEN\", \"description\": \"RevenYOU withdrawal #be73713c6e3e6956fc12c17e44cf90ace125cfa9\", \"method\": \"ideal\", \"order_id\": \"d33fbf73083f056a7364e616029c07430deadfa5\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"43.18\", \"withdrawal_amount_fiat\": \"42.53\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4318\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-10-25 23:18:25\", \"date_modified\": \"2021-10-25 23:20:49\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61742a93d7b676a9305f421c\", \"user_id\": \"6013f191d7b676a9305f3e1f\", \"account_number\": \"NL16DFZQ1129690754\", \"holder_name\": \"JENNIFER LUUK PISON\", \"description\": \"RevenYOU withdrawal #40d45eb84d70954943f8248741713d603c84b509\", \"method\": \"ideal\", \"order_id\": \"90728be951af614a47425f082fccf9e9c2e0935e\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"479.09\", \"withdrawal_amount_fiat\": \"471.90\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"47909\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"pending\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": False, \"date_added\": \"2021-10-23 15:30:27\", \"date_modified\": \"2021-10-23 15:30:36\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61703028d7b676a9305f41f0\", \"user_id\": \"6013f191d7b676a9305f3e1b\", \"account_number\": \"NL31BTWJ7582231627\", \"holder_name\": \"VEERLE ESM\\u00c9E BILLUNG\", \"description\": \"RevenYOU withdrawal #d382bb1d8e54a7d02da73c709d2038c8fa2da12b\", \"method\": \"ideal\", \"order_id\": \"64214edc5d3c55911f3ccd1bd4d8738fcb1a111e\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"312.47\", \"withdrawal_amount_fiat\": \"307.78\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"31247\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-10-20 15:05:12\", \"date_modified\": \"2021-10-20 15:07:39\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"616a7f02d7b676a9305f435e\", \"user_id\": \"6013f191d7b676a9305f3e24\", \"account_number\": \"NL09NEVH1003183263\", \"holder_name\": \"SAMI SJOERD VAN WEL\", \"description\": \"RevenYOU withdrawal #f4c2f518c1361470045a428513df6730743733c6\", \"method\": \"ideal\", \"order_id\": \"28fbace27541f70f7791b249945d8d17a3db1276\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"2909.76\", \"withdrawal_amount_fiat\": \"2866.11\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"290976\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-10-16 07:28:02\", \"date_modified\": \"2021-10-16 07:30:33\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61692d82d7b676a9305f437e\", \"user_id\": \"6013f191d7b676a9305f3e09\", \"account_number\": \"NL41ZKFO0931638471\", \"holder_name\": \"HANNA DAAN LOUWS\", \"description\": \"RevenYOU withdrawal #f1d8b72aeb798ada85dd4373a73b903afebbb957\", \"method\": \"ideal\", \"order_id\": \"ed6e20ae59147674b0283791b905b1850aa8845b\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"124.17\", \"withdrawal_amount_fiat\": \"122.31\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"12417\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-10-15 07:28:02\", \"date_modified\": \"2021-10-15 07:29:34\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61505c88d7b676a9305f4253\", \"user_id\": \"6013f191d7b676a9305f3e09\", \"account_number\": \"NL93OCYV0912153055\", \"holder_name\": \"HANNA DAAN LOUWS\", \"description\": \"RevenYOU withdrawal #2a6c3db4ef28be7b5216fe913f751143b8d709ad\", \"method\": \"ideal\", \"order_id\": \"e82e8026ee27b9ef4eb8d75d43a34e105aa6eaee\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"480.56\", \"withdrawal_amount_fiat\": \"473.35\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"48056\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-09-26 11:42:00\", \"date_modified\": \"2021-09-26 11:43:43\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61390202d7b676a9305f437b\", \"user_id\": \"6013f191d7b676a9305f3e34\", \"account_number\": \"NL20TVOO0106633982\", \"holder_name\": \"LIZZY PHILEINE BECHT\", \"description\": \"RevenYOU withdrawal #e22a760a3f410bb0df0f1ecb36dd8974a25d6bf1\", \"method\": \"ideal\", \"order_id\": \"303e3f222646d541799fb89d5d003c9f052951d0\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"529.02\", \"withdrawal_amount_fiat\": \"521.08\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"52902\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-09-08 18:33:38\", \"date_modified\": \"2021-09-08 18:36:11\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61383c36d7b676a9305f43f9\", \"user_id\": \"6013f191d7b676a9305f3e13\", \"account_number\": \"NL73ZOCA7648498967\", \"holder_name\": \"TIMO JANNE TIMMERMAN\", \"description\": \"RevenYOU withdrawal #807826f08850e496433951dfd7fb64c0f896217a\", \"method\": \"ideal\", \"order_id\": \"37c80347c16c131954dc5982bb8a7a6344e51b4f\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"98.43\", \"withdrawal_amount_fiat\": \"96.95\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"9843\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-09-08 04:29:42\", \"date_modified\": \"2021-09-08 04:31:03\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61296975d7b676a9305f43af\", \"user_id\": \"6013f191d7b676a9305f3e18\", \"account_number\": \"NL27ASFT7758275243\", \"holder_name\": \"BRYAN OWEN VI\", \"description\": \"RevenYOU withdrawal #cbf3a8cbfcc53c765a5c75e753f68063cf3dc40a\", \"method\": \"ideal\", \"order_id\": \"1279e0459e4140088b160790c76958685c95a475\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"183.20\", \"withdrawal_amount_fiat\": \"180.45\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"18320\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-08-27 22:38:45\", \"date_modified\": \"2021-08-27 22:41:23\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6114f5b9d7b676a9305f429c\", \"user_id\": \"6013f191d7b676a9305f3e2a\", \"account_number\": \"NL25CTRD6541466546\", \"holder_name\": \"LEX ADAM DE BOER\", \"description\": \"RevenYOU withdrawal #1869a0da33b74575ea3924dd86991695bdf6e44f\", \"method\": \"ideal\", \"order_id\": \"29efce15fdc3ccd30115cc88aad4cf80bffbab33\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"32.12\", \"withdrawal_amount_fiat\": \"31.64\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"3212\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"pending\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": False, \"date_added\": \"2021-08-12 10:19:37\", \"date_modified\": \"2021-08-12 10:22:37\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60fe412bd7b676a9305f4299\", \"user_id\": \"6013f191d7b676a9305f3e28\", \"account_number\": \"NL17FZUE4132556347\", \"holder_name\": \"IVAN JOHANNES GRUIJL\", \"description\": \"RevenYOU withdrawal #c0b1c8c96850eecb64a627fb2406083a29f13bcf\", \"method\": \"ideal\", \"order_id\": \"da24d10ff6d85ebc76b362351ca29f523ca6e46d\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"80.84\", \"withdrawal_amount_fiat\": \"79.63\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"8084\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-07-26 04:59:23\", \"date_modified\": \"2021-07-26 05:00:31\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60e6862bd7b676a9305f42d4\", \"user_id\": \"6013f191d7b676a9305f3e14\", \"account_number\": \"NL56OFBK8064625627\", \"holder_name\": \"THIJMEN EVELIEN TERRY\", \"description\": \"RevenYOU withdrawal #1560eb8418f2c824da139b6551b0a3df7a92b6eb\", \"method\": \"ideal\", \"order_id\": \"36d7a95d90e79f2585654f98d5335e4615f10d5f\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"347.98\", \"withdrawal_amount_fiat\": \"342.76\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"34798\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-07-08 04:59:23\", \"date_modified\": \"2021-07-08 05:00:06\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60be0608d7b676a9305f4239\", \"user_id\": \"6013f191d7b676a9305f3e09\", \"account_number\": \"NL56GFWA8338267510\", \"holder_name\": \"HANNA DAAN LOUWS\", \"description\": \"RevenYOU withdrawal #eb21e42da3d2ede82976b3ff9942f76c75e3cb13\", \"method\": \"ideal\", \"order_id\": \"83279d1d0f93a3d7e8f4e072244af1cab719ac50\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"635.03\", \"withdrawal_amount_fiat\": \"625.50\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"63503\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-06-07 11:42:00\", \"date_modified\": \"2021-06-07 11:43:28\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}]}")

    def test_get_withdraws_mutation_6(self):
        task = transaction_service.get_withdraws.s(
            None, 20, 0, 'date_added', 'desc', None, None, None, 'ADMIN', None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 25, \"total_pages\": 2, \"current_page\": 0, \"content\": [{\"_id\": \"61ee6d1cd7b676a9305f4444\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"account_number\": \"NL85UVVJ8017442037\", \"holder_name\": \"LANA CATO KUIJPERS\", \"description\": \"RevenYOU withdrawal #8a918d9c1c35be0aefea057586a72875796c3b9b\", \"method\": \"ideal\", \"order_id\": \"d403a0708549944923c3968f37982f1dd2173109\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"324.29\", \"withdrawal_amount_fiat\": \"319.43\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"32429\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2022-01-24 09:10:52\", \"date_modified\": \"2022-01-24 09:13:01\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61d01a9cd7b676a9305f448a\", \"user_id\": \"6013f191d7b676a9305f3e39\", \"account_number\": \"NL88XNBJ6773233727\", \"holder_name\": \"LANA CATO KUIJPERS\", \"description\": \"RevenYOU withdrawal #8be511e8e986516566fd2911809f29624a39ce47\", \"method\": \"ideal\", \"order_id\": \"3e9a30225a9e4bee7488352b5a5a8ad72be6a092\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"418.18\", \"withdrawal_amount_fiat\": \"411.91\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"41818\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2022-01-01 09:10:52\", \"date_modified\": \"2022-01-01 09:12:26\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61bd8d82d7b676a9305f4349\", \"user_id\": \"6013f191d7b676a9305f3e18\", \"account_number\": \"NL73QUXV2737972620\", \"holder_name\": \"BRYAN OWEN VI\", \"description\": \"RevenYOU withdrawal #dfd7a305435c8f8534523cc5963662e30b95d511\", \"method\": \"ideal\", \"order_id\": \"e68f0202a5eb34a10a7baf7aa4b8b1bd6b52c483\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"45.58\", \"withdrawal_amount_fiat\": \"44.90\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4558\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-12-18 07:28:02\", \"date_modified\": \"2021-12-18 07:30:38\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61aee336d7b676a9305f4439\", \"user_id\": \"6013f191d7b676a9305f3e24\", \"account_number\": \"NL11PHFR9371194774\", \"holder_name\": \"SAMI SJOERD VAN WEL\", \"description\": \"RevenYOU withdrawal #88eb3826b4e5965d889048453f09d44788d0d845\", \"method\": \"ideal\", \"order_id\": \"4cfe5452f0959801064466f18fc507b26e3dd37a\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"241.87\", \"withdrawal_amount_fiat\": \"238.24\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"24187\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-12-07 04:29:42\", \"date_modified\": \"2021-12-07 04:31:17\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61a72402d7b676a9305f43e2\", \"user_id\": \"6013f191d7b676a9305f3e31\", \"account_number\": \"NL76HILL9644749367\", \"holder_name\": \"VIGO EVA STETTYN\", \"description\": \"RevenYOU withdrawal #4b33af8c9091611567c80841642ba34c43de040e\", \"method\": \"ideal\", \"order_id\": \"3f872c762cc0ccda415c4c2a71b3e853a0d04f3d\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"455.73\", \"withdrawal_amount_fiat\": \"448.89\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"45573\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-12-01 07:28:02\", \"date_modified\": \"2021-12-01 07:31:17\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"619bbd99d7b676a9305f4338\", \"user_id\": \"6013f191d7b676a9305f3e35\", \"account_number\": \"NL35HFQI1974179893\", \"holder_name\": \"NOVA KYAN VAN ENGELEN\", \"description\": \"RevenYOU withdrawal #61c818b710c18610bf500fbc8830e38d1816fbdb\", \"method\": \"ideal\", \"order_id\": \"7270e5965ea85fc3f34563dcd1c1e2c36798a42b\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"333.52\", \"withdrawal_amount_fiat\": \"328.52\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"33352\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"pending\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": False, \"date_added\": \"2021-11-22 15:56:09\", \"date_modified\": \"2021-11-22 15:59:25\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"618e8e99d7b676a9305f4331\", \"user_id\": \"6013f191d7b676a9305f3e0e\", \"account_number\": \"NL75DVJF1070387778\", \"holder_name\": \"JOSHUA ROSALIE PRINS\", \"description\": \"RevenYOU withdrawal #776167178962a8efbc8f54d70e662c892e9b763d\", \"method\": \"ideal\", \"order_id\": \"ac8ca7825a6c59ddf5378f9194ca4c97f9b477b2\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"34.89\", \"withdrawal_amount_fiat\": \"34.37\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"3489\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-11-12 15:56:09\", \"date_modified\": \"2021-11-12 15:59:10\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61773b41d7b676a9305f42e7\", \"user_id\": \"6013f191d7b676a9305f3e32\", \"account_number\": \"NL08TUFL3677619038\", \"holder_name\": \"MELISSA DUUK VAN DER STEEN\", \"description\": \"RevenYOU withdrawal #be73713c6e3e6956fc12c17e44cf90ace125cfa9\", \"method\": \"ideal\", \"order_id\": \"d33fbf73083f056a7364e616029c07430deadfa5\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"43.18\", \"withdrawal_amount_fiat\": \"42.53\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4318\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-10-25 23:18:25\", \"date_modified\": \"2021-10-25 23:20:49\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61742a93d7b676a9305f421c\", \"user_id\": \"6013f191d7b676a9305f3e1f\", \"account_number\": \"NL16DFZQ1129690754\", \"holder_name\": \"JENNIFER LUUK PISON\", \"description\": \"RevenYOU withdrawal #40d45eb84d70954943f8248741713d603c84b509\", \"method\": \"ideal\", \"order_id\": \"90728be951af614a47425f082fccf9e9c2e0935e\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"479.09\", \"withdrawal_amount_fiat\": \"471.90\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"47909\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"pending\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": False, \"date_added\": \"2021-10-23 15:30:27\", \"date_modified\": \"2021-10-23 15:30:36\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61703028d7b676a9305f41f0\", \"user_id\": \"6013f191d7b676a9305f3e1b\", \"account_number\": \"NL31BTWJ7582231627\", \"holder_name\": \"VEERLE ESM\\u00c9E BILLUNG\", \"description\": \"RevenYOU withdrawal #d382bb1d8e54a7d02da73c709d2038c8fa2da12b\", \"method\": \"ideal\", \"order_id\": \"64214edc5d3c55911f3ccd1bd4d8738fcb1a111e\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"312.47\", \"withdrawal_amount_fiat\": \"307.78\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"31247\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-10-20 15:05:12\", \"date_modified\": \"2021-10-20 15:07:39\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"616a7f02d7b676a9305f435e\", \"user_id\": \"6013f191d7b676a9305f3e24\", \"account_number\": \"NL09NEVH1003183263\", \"holder_name\": \"SAMI SJOERD VAN WEL\", \"description\": \"RevenYOU withdrawal #f4c2f518c1361470045a428513df6730743733c6\", \"method\": \"ideal\", \"order_id\": \"28fbace27541f70f7791b249945d8d17a3db1276\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"2909.76\", \"withdrawal_amount_fiat\": \"2866.11\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"290976\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-10-16 07:28:02\", \"date_modified\": \"2021-10-16 07:30:33\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61692d82d7b676a9305f437e\", \"user_id\": \"6013f191d7b676a9305f3e09\", \"account_number\": \"NL41ZKFO0931638471\", \"holder_name\": \"HANNA DAAN LOUWS\", \"description\": \"RevenYOU withdrawal #f1d8b72aeb798ada85dd4373a73b903afebbb957\", \"method\": \"ideal\", \"order_id\": \"ed6e20ae59147674b0283791b905b1850aa8845b\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"124.17\", \"withdrawal_amount_fiat\": \"122.31\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"12417\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-10-15 07:28:02\", \"date_modified\": \"2021-10-15 07:29:34\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61505c88d7b676a9305f4253\", \"user_id\": \"6013f191d7b676a9305f3e09\", \"account_number\": \"NL93OCYV0912153055\", \"holder_name\": \"HANNA DAAN LOUWS\", \"description\": \"RevenYOU withdrawal #2a6c3db4ef28be7b5216fe913f751143b8d709ad\", \"method\": \"ideal\", \"order_id\": \"e82e8026ee27b9ef4eb8d75d43a34e105aa6eaee\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"480.56\", \"withdrawal_amount_fiat\": \"473.35\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"48056\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-09-26 11:42:00\", \"date_modified\": \"2021-09-26 11:43:43\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61390202d7b676a9305f437b\", \"user_id\": \"6013f191d7b676a9305f3e34\", \"account_number\": \"NL20TVOO0106633982\", \"holder_name\": \"LIZZY PHILEINE BECHT\", \"description\": \"RevenYOU withdrawal #e22a760a3f410bb0df0f1ecb36dd8974a25d6bf1\", \"method\": \"ideal\", \"order_id\": \"303e3f222646d541799fb89d5d003c9f052951d0\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"529.02\", \"withdrawal_amount_fiat\": \"521.08\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"52902\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-09-08 18:33:38\", \"date_modified\": \"2021-09-08 18:36:11\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61383c36d7b676a9305f43f9\", \"user_id\": \"6013f191d7b676a9305f3e13\", \"account_number\": \"NL73ZOCA7648498967\", \"holder_name\": \"TIMO JANNE TIMMERMAN\", \"description\": \"RevenYOU withdrawal #807826f08850e496433951dfd7fb64c0f896217a\", \"method\": \"ideal\", \"order_id\": \"37c80347c16c131954dc5982bb8a7a6344e51b4f\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"98.43\", \"withdrawal_amount_fiat\": \"96.95\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"9843\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-09-08 04:29:42\", \"date_modified\": \"2021-09-08 04:31:03\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61296975d7b676a9305f43af\", \"user_id\": \"6013f191d7b676a9305f3e18\", \"account_number\": \"NL27ASFT7758275243\", \"holder_name\": \"BRYAN OWEN VI\", \"description\": \"RevenYOU withdrawal #cbf3a8cbfcc53c765a5c75e753f68063cf3dc40a\", \"method\": \"ideal\", \"order_id\": \"1279e0459e4140088b160790c76958685c95a475\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"183.20\", \"withdrawal_amount_fiat\": \"180.45\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"18320\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-08-27 22:38:45\", \"date_modified\": \"2021-08-27 22:41:23\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6114f5b9d7b676a9305f429c\", \"user_id\": \"6013f191d7b676a9305f3e2a\", \"account_number\": \"NL25CTRD6541466546\", \"holder_name\": \"LEX ADAM DE BOER\", \"description\": \"RevenYOU withdrawal #1869a0da33b74575ea3924dd86991695bdf6e44f\", \"method\": \"ideal\", \"order_id\": \"29efce15fdc3ccd30115cc88aad4cf80bffbab33\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"32.12\", \"withdrawal_amount_fiat\": \"31.64\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"3212\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"pending\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": False, \"date_added\": \"2021-08-12 10:19:37\", \"date_modified\": \"2021-08-12 10:22:37\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60fe412bd7b676a9305f4299\", \"user_id\": \"6013f191d7b676a9305f3e28\", \"account_number\": \"NL17FZUE4132556347\", \"holder_name\": \"IVAN JOHANNES GRUIJL\", \"description\": \"RevenYOU withdrawal #c0b1c8c96850eecb64a627fb2406083a29f13bcf\", \"method\": \"ideal\", \"order_id\": \"da24d10ff6d85ebc76b362351ca29f523ca6e46d\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"80.84\", \"withdrawal_amount_fiat\": \"79.63\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"8084\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-07-26 04:59:23\", \"date_modified\": \"2021-07-26 05:00:31\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60e6862bd7b676a9305f42d4\", \"user_id\": \"6013f191d7b676a9305f3e14\", \"account_number\": \"NL56OFBK8064625627\", \"holder_name\": \"THIJMEN EVELIEN TERRY\", \"description\": \"RevenYOU withdrawal #1560eb8418f2c824da139b6551b0a3df7a92b6eb\", \"method\": \"ideal\", \"order_id\": \"36d7a95d90e79f2585654f98d5335e4615f10d5f\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"347.98\", \"withdrawal_amount_fiat\": \"342.76\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"34798\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-07-08 04:59:23\", \"date_modified\": \"2021-07-08 05:00:06\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60be0608d7b676a9305f4239\", \"user_id\": \"6013f191d7b676a9305f3e09\", \"account_number\": \"NL56GFWA8338267510\", \"holder_name\": \"HANNA DAAN LOUWS\", \"description\": \"RevenYOU withdrawal #eb21e42da3d2ede82976b3ff9942f76c75e3cb13\", \"method\": \"ideal\", \"order_id\": \"83279d1d0f93a3d7e8f4e072244af1cab719ac50\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"635.03\", \"withdrawal_amount_fiat\": \"625.50\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"63503\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-06-07 11:42:00\", \"date_modified\": \"2021-06-07 11:43:28\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}]}")

    def test_any_failed_withdrawal_mutation_0(self):
        task = transaction_service.any_failed_withdrawal.s(
            
        ).apply()
        self.assertEqual(task.result, {"any": False})

    def test_any_failed_withdrawal_mutation_1(self):
        task = transaction_service.any_failed_withdrawal.s(
            
        ).apply()
        self.assertEqual(task.result, {"any": False})

    def test_get_customer_deposit_snapshot_mutation_3(self):
        task = transaction_service.get_customer_deposit_snapshot.s(
            user_id='6013f191d7b676a9305f3e18'
        ).apply()
        self.assertEqual(task.result, "[{\"date\": \"2020-12-09\", \"time\": \"22:38:45\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 150.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2021-02-10\", \"time\": \"07:28:02\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 100.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2021-02-15\", \"time\": \"22:38:45\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 106.51 (internal)\", \"status\": \"approved\"}]")

    def test_get_customer_withdrawal_snapshot_mutation_6(self):
        task = transaction_service.get_customer_withdrawal_snapshot.s(
            user_id='6013f191d7b676a9305f3e18'
        ).apply()
        self.assertEqual(task.result, "[{\"date\": \"2021-08-27\", \"time\": \"22:38:45\", \"operation\": \"WITHDRAWAL\", \"description\": \"user withdrawn amount: 180.45\", \"status\": \"approved\"}, {\"date\": \"2021-12-18\", \"time\": \"07:28:02\", \"operation\": \"WITHDRAWAL\", \"description\": \"user withdrawn amount: 44.90\", \"status\": \"approved\"}]")

    def test_get_customer_withdrawal_snapshot_mutation_7(self):
        task = transaction_service.get_customer_withdrawal_snapshot.s(
            user_id='6013f191d7b676a9305f3e18'
        ).apply()
        self.assertEqual(task.result, "[{\"date\": \"2021-08-27\", \"time\": \"22:38:45\", \"operation\": \"WITHDRAWAL\", \"description\": \"user withdrawn amount: 180.45\", \"status\": \"approved\"}, {\"date\": \"2021-12-18\", \"time\": \"07:28:02\", \"operation\": \"WITHDRAWAL\", \"description\": \"user withdrawn amount: 44.90\", \"status\": \"approved\"}]")

    def test_get_deposits_mutation_8(self):
        task = transaction_service.get_deposits.s(
            '6013f191d7b676a9305f3e18', 10, 0, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 3, \"total_pages\": 1, \"current_page\": 0, \"content\": [{\"_id\": \"602af7f5d7b676a9305f41d6\", \"user_id\": \"6013f191d7b676a9305f3e18\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"10651\", \"quantity_in_asset\": \"106.51000\", \"quantity\": \"106.51\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"jasonraymond.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e76\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-15 22:38:45\", \"date_modified\": \"2021-02-15 22:38:56\"}, {\"_id\": \"60238b02d7b676a9305f3f82\", \"user_id\": \"6013f191d7b676a9305f3e18\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"srn\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"600.00000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f4510\", \"strategy_name\": \"jackconley.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e7c\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-10 07:28:02\", \"date_modified\": \"2021-02-10 07:29:10\"}, {\"_id\": \"5fd151f5d7b676a9305f3f7e\", \"user_id\": \"6013f191d7b676a9305f3e18\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"pot\", \"quantity_in_fiat\": \"15000\", \"quantity_in_asset\": \"37.50000\", \"quantity\": \"150.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6013f192d7b676a9305f44a7\", \"strategy_name\": \"adam10.bot\", \"strategy_id\": \"6013f191d7b676a9305f3e72\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": False, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-09 22:38:45\", \"date_modified\": \"2020-12-09 22:41:45\"}]}")

    def test_get_withdraws_mutation_7(self):
        task = transaction_service.get_withdraws.s(
            '6013f191d7b676a9305f3e18', 10, 0, 'date_added', 'desc', None, None, None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 2, \"total_pages\": 1, \"current_page\": 0, \"content\": [{\"_id\": \"61bd8d82d7b676a9305f4349\", \"user_id\": \"6013f191d7b676a9305f3e18\", \"account_number\": \"NL73QUXV2737972620\", \"holder_name\": \"BRYAN OWEN VI\", \"description\": \"RevenYOU withdrawal #dfd7a305435c8f8534523cc5963662e30b95d511\", \"method\": \"ideal\", \"order_id\": \"e68f0202a5eb34a10a7baf7aa4b8b1bd6b52c483\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"45.58\", \"withdrawal_amount_fiat\": \"44.90\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4558\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-12-18 07:28:02\", \"date_modified\": \"2021-12-18 07:30:38\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61296975d7b676a9305f43af\", \"user_id\": \"6013f191d7b676a9305f3e18\", \"account_number\": \"NL27ASFT7758275243\", \"holder_name\": \"BRYAN OWEN VI\", \"description\": \"RevenYOU withdrawal #cbf3a8cbfcc53c765a5c75e753f68063cf3dc40a\", \"method\": \"ideal\", \"order_id\": \"1279e0459e4140088b160790c76958685c95a475\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"183.20\", \"withdrawal_amount_fiat\": \"180.45\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"18320\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-08-27 22:38:45\", \"date_modified\": \"2021-08-27 22:41:23\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}]}")

    def test_get_withdrawable_amount_dump_mutation_6(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6013f191d7b676a9305f3e18'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_withdrawable_amount_dump_mutation_7(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6013f191d7b676a9305f3e18'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_withdrawable_amount_mutation_0(self):
        task = transaction_service.get_withdrawable_amount.s(
            335.28999999999996, '6013f191d7b676a9305f3e18'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount": 106.50999999999999})

    def test_get_withdrawable_amount_mutation_6(self):
        task = transaction_service.get_withdrawable_amount.s(
            335.28999999999996, '6013f191d7b676a9305f3e18'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount": 106.50999999999999})

    def test_get_user_deposit_amount_mutation_2(self):
        task = transaction_service.get_user_deposit_amount.s(
            user_id='6013f191d7b676a9305f3e18'
        ).apply()
        self.assertEqual(task.result, {"_id": "", "deposit_amount": 250.0})

    def test_get_user_withdraw_amount_mutation_2(self):
        task = transaction_service.get_user_withdraw_amount.s(
            user_id='6013f191d7b676a9305f3e18'
        ).apply()
        self.assertEqual(task.result, {"_id": "", "withdrawal_amount": 228.77999999999997})

    def test_get_last_transaction_id_mutation_0(self):
        task = transaction_service.get_last_transaction_id.s(
            user_id='6013f191d7b676a9305f3e18'
        ).apply()
        self.assertEqual(task.result, {"last_transaction": "-"})

    def test_get_withdrawal_bank_account_mutation_0(self):
        task = transaction_service.get_withdrawal_bank_account.s(
            user_id='6013f191d7b676a9305f3e18'
        ).apply()
        self.assertEqual(task.result, {"bank_account": "NL73QUXV2737972620"})

    def test_get_withdraw_mutation_0(self):
        task = transaction_service.get_withdraw.s(
            '61bd8d82d7b676a9305f4349'
        ).apply()
        self.assertEqual(task.result, {"_id": "61bd8d82d7b676a9305f4349", "user_id": "6013f191d7b676a9305f3e18", "account_number": "NL73QUXV2737972620", "holder_name": "BRYAN OWEN VI", "description": "RevenYOU withdrawal #dfd7a305435c8f8534523cc5963662e30b95d511", "method": "ideal", "order_id": "e68f0202a5eb34a10a7baf7aa4b8b1bd6b52c483", "exchange": "binance", "quantity_in_fiat": "45.58", "withdrawal_amount_fiat": "44.90", "fiat": "EUR", "quantity_in_cents": "4558", "fee_percentage": "1.50", "withdrawal_status": "approved", "trans_direction": "batched", "comment": "", "confirmed_by_user": True, "cleared": True, "date_added": "2021-12-18 07:28:02", "date_modified": "2021-12-18 07:30:38", "ip": "192.168.2.55", "dump_withdrawal": [[{"amount_fiat": "151.18", "orginal_amount_fiat": "151.18", "withdrawal_amount": "162.13481737", "exchange": "binance", "amount": "163.92", "after_withdrawal": "-1.78518263", "asset": "tusd", "delta": "1.78518263"}]]})

    def test_get_withdraws_mutation_8(self):
        task = transaction_service.get_withdraws.s(
            None, 20, 1, 'date_added', 'desc', None, None, None, 'ADMIN', None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 25, \"total_pages\": 2, \"current_page\": 1, \"content\": [{\"_id\": \"60b8137fd7b676a9305f4481\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"account_number\": \"NL76FCGV2543209916\", \"holder_name\": \"AYLIN MAAIKE FERRAN\", \"description\": \"RevenYOU withdrawal #1603c72159b5b549521a1d33dd710f1e5cd7348f\", \"method\": \"ideal\", \"order_id\": \"38d2a167876de90010404abaaf8c63a400e4e4ae\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"1051.88\", \"withdrawal_amount_fiat\": \"1036.10\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"105188\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-06-02 23:25:51\", \"date_modified\": \"2021-06-02 23:28:24\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60a25688d7b676a9305f426e\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"account_number\": \"NL94UVPM1432305834\", \"holder_name\": \"SUUS LARS OLYKAN\", \"description\": \"RevenYOU withdrawal #e5e0b88e998c73cc0156abfb49b6e59019da6690\", \"method\": \"ideal\", \"order_id\": \"dd0855ae4a0a0943e79e7a16a16ef7870b8d9c4d\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"89.75\", \"withdrawal_amount_fiat\": \"88.40\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"8975\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-05-17 11:42:00\", \"date_modified\": \"2021-05-17 11:42:17\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6078303bd7b676a9305f432e\", \"user_id\": \"6013f191d7b676a9305f3e31\", \"account_number\": \"NL85OEAD3655636342\", \"holder_name\": \"VIGO EVA STETTYN\", \"description\": \"RevenYOU withdrawal #fc329a4479a2ea219f95af4c9b5150b3f1593c7b\", \"method\": \"ideal\", \"order_id\": \"99d4ac3a4f04c44af0d44e321628a725577440ed\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"5941.30\", \"withdrawal_amount_fiat\": \"5852.18\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"594130\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"pending\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": False, \"date_added\": \"2021-04-15 12:23:23\", \"date_modified\": \"2021-04-15 12:25:57\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60707919d7b676a9305f4315\", \"user_id\": \"6013f191d7b676a9305f3e2d\", \"account_number\": \"NL80ZOHU3463591594\", \"holder_name\": \"THOM VICTORIA NEDERMEIJER\", \"description\": \"RevenYOU withdrawal #5d52e68e1d2619bd2fb8ebd8b546a451e0b4b89c\", \"method\": \"ideal\", \"order_id\": \"170cf29a814d79873c68c7ca0f09367fc6b445d0\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"190.24\", \"withdrawal_amount_fiat\": \"187.39\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"19024\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-04-09 15:56:09\", \"date_modified\": \"2021-04-09 15:58:45\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6037c1cdd7b676a9305f430a\", \"user_id\": \"6013f191d7b676a9305f3e35\", \"account_number\": \"NL28PRUY9871621083\", \"holder_name\": \"NOVA KYAN VAN ENGELEN\", \"description\": \"RevenYOU withdrawal #8989b05c23a1fa3e6e9de9e712483aaef820a407\", \"method\": \"ideal\", \"order_id\": \"2fe1d744994eda9d8f978e525b18c2a9cd392a4f\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"35.10\", \"withdrawal_amount_fiat\": \"34.57\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"3510\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-02-25 15:27:09\", \"date_modified\": \"2021-02-25 15:27:48\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}]}")

    def test_get_withdraws_mutation_9(self):
        task = transaction_service.get_withdraws.s(
            None, 20, 1, 'date_added', 'desc', None, None, None, 'ADMIN', None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 25, \"total_pages\": 2, \"current_page\": 1, \"content\": [{\"_id\": \"60b8137fd7b676a9305f4481\", \"user_id\": \"6013f191d7b676a9305f3e38\", \"account_number\": \"NL76FCGV2543209916\", \"holder_name\": \"AYLIN MAAIKE FERRAN\", \"description\": \"RevenYOU withdrawal #1603c72159b5b549521a1d33dd710f1e5cd7348f\", \"method\": \"ideal\", \"order_id\": \"38d2a167876de90010404abaaf8c63a400e4e4ae\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"1051.88\", \"withdrawal_amount_fiat\": \"1036.10\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"105188\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-06-02 23:25:51\", \"date_modified\": \"2021-06-02 23:28:24\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60a25688d7b676a9305f426e\", \"user_id\": \"6013f191d7b676a9305f3e20\", \"account_number\": \"NL94UVPM1432305834\", \"holder_name\": \"SUUS LARS OLYKAN\", \"description\": \"RevenYOU withdrawal #e5e0b88e998c73cc0156abfb49b6e59019da6690\", \"method\": \"ideal\", \"order_id\": \"dd0855ae4a0a0943e79e7a16a16ef7870b8d9c4d\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"89.75\", \"withdrawal_amount_fiat\": \"88.40\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"8975\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-05-17 11:42:00\", \"date_modified\": \"2021-05-17 11:42:17\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6078303bd7b676a9305f432e\", \"user_id\": \"6013f191d7b676a9305f3e31\", \"account_number\": \"NL85OEAD3655636342\", \"holder_name\": \"VIGO EVA STETTYN\", \"description\": \"RevenYOU withdrawal #fc329a4479a2ea219f95af4c9b5150b3f1593c7b\", \"method\": \"ideal\", \"order_id\": \"99d4ac3a4f04c44af0d44e321628a725577440ed\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"5941.30\", \"withdrawal_amount_fiat\": \"5852.18\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"594130\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"pending\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": False, \"date_added\": \"2021-04-15 12:23:23\", \"date_modified\": \"2021-04-15 12:25:57\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60707919d7b676a9305f4315\", \"user_id\": \"6013f191d7b676a9305f3e2d\", \"account_number\": \"NL80ZOHU3463591594\", \"holder_name\": \"THOM VICTORIA NEDERMEIJER\", \"description\": \"RevenYOU withdrawal #5d52e68e1d2619bd2fb8ebd8b546a451e0b4b89c\", \"method\": \"ideal\", \"order_id\": \"170cf29a814d79873c68c7ca0f09367fc6b445d0\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"190.24\", \"withdrawal_amount_fiat\": \"187.39\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"19024\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-04-09 15:56:09\", \"date_modified\": \"2021-04-09 15:58:45\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6037c1cdd7b676a9305f430a\", \"user_id\": \"6013f191d7b676a9305f3e35\", \"account_number\": \"NL28PRUY9871621083\", \"holder_name\": \"NOVA KYAN VAN ENGELEN\", \"description\": \"RevenYOU withdrawal #8989b05c23a1fa3e6e9de9e712483aaef820a407\", \"method\": \"ideal\", \"order_id\": \"2fe1d744994eda9d8f978e525b18c2a9cd392a4f\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"35.10\", \"withdrawal_amount_fiat\": \"34.57\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"3510\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-02-25 15:27:09\", \"date_modified\": \"2021-02-25 15:27:48\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}]}")

    def test_any_failed_withdrawal_mutation_2(self):
        task = transaction_service.any_failed_withdrawal.s(
            
        ).apply()
        self.assertEqual(task.result, {"any": False})

    def test_any_failed_withdrawal_mutation_3(self):
        task = transaction_service.any_failed_withdrawal.s(
            
        ).apply()
        self.assertEqual(task.result, {"any": False})

    def test_get_withdraws_mutation_10(self):
        task = transaction_service.get_withdraws.s(
            None, 20, 0, 'date_added', 'desc', None, None, 'nl80', 'ADMIN', None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 1, \"total_pages\": 1, \"current_page\": 0, \"content\": [{\"_id\": \"60707919d7b676a9305f4315\", \"user_id\": \"6013f191d7b676a9305f3e2d\", \"account_number\": \"NL80ZOHU3463591594\", \"holder_name\": \"THOM VICTORIA NEDERMEIJER\", \"description\": \"RevenYOU withdrawal #5d52e68e1d2619bd2fb8ebd8b546a451e0b4b89c\", \"method\": \"ideal\", \"order_id\": \"170cf29a814d79873c68c7ca0f09367fc6b445d0\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"190.24\", \"withdrawal_amount_fiat\": \"187.39\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"19024\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-04-09 15:56:09\", \"date_modified\": \"2021-04-09 15:58:45\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}]}")

    def test_get_withdraws_mutation_11(self):
        task = transaction_service.get_withdraws.s(
            None, 20, 0, 'date_added', 'desc', None, None, 'nl80', 'ADMIN', None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 1, \"total_pages\": 1, \"current_page\": 0, \"content\": [{\"_id\": \"60707919d7b676a9305f4315\", \"user_id\": \"6013f191d7b676a9305f3e2d\", \"account_number\": \"NL80ZOHU3463591594\", \"holder_name\": \"THOM VICTORIA NEDERMEIJER\", \"description\": \"RevenYOU withdrawal #5d52e68e1d2619bd2fb8ebd8b546a451e0b4b89c\", \"method\": \"ideal\", \"order_id\": \"170cf29a814d79873c68c7ca0f09367fc6b445d0\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"190.24\", \"withdrawal_amount_fiat\": \"187.39\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"19024\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": True, \"cleared\": True, \"date_added\": \"2021-04-09 15:56:09\", \"date_modified\": \"2021-04-09 15:58:45\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}]}")

    def test_any_failed_withdrawal_mutation_0(self):
        task = transaction_service.any_failed_withdrawal.s(
            
        ).apply()
        self.assertEqual(task.result, {"any": False})

    def test_any_failed_withdrawal_mutation_4(self):
        task = transaction_service.any_failed_withdrawal.s(
            
        ).apply()
        self.assertEqual(task.result, {"any": False})

if __name__ == '__main__':
    unittest.main(verbosity=2)