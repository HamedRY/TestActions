import unittest
import sys, os
import json
sys.path.append(os.getcwd())
os.environ['APP_RUN_ENV'] = 'development'

from services import transaction_service

class TransacrionTests(unittest.TestCase):
    _ = None
    def test_get_funded_accounts_mutation_0(self):
        task = transaction_service.get_funded_accounts.s(
            1612220400, None
        ).apply()
        self.assertEqual(task.result, {"total_elements": 5, "content": [{"_id": "6017edf6eec798982293a965"}, {"_id": "6017edf6eec798982293a963"}, {"_id": "6017edf6eec798982293a962"}, {"_id": "6017edf6eec798982293a961"}, {"_id": "6017edf6eec798982293a95e"}]})

    def test_get_funded_accounts_count_mutation_0(self):
        task = transaction_service.get_funded_accounts_count.s(
            begin=None, end=None
        ).apply()
        self.assertEqual(task.result, [{"_id": "Funded accounts", "count": 34}, {"_id": "Zero accounts", "count": 5}])

    def test_get_lost_accounts_count_mutation_0(self):
        task = transaction_service.get_lost_accounts_count.s(
            begin=None, end=None
        ).apply()
        self.assertEqual(task.result, [{"_id": "Lost accounts", "count": 0}])

    def test_get_deposits_amount_mutation_0(self):
        task = transaction_service.get_deposits_amount.s(
            begin=None, end=None
        ).apply()
        self.assertEqual(task.result, {"deposit_count": 221, "deposit_total": 169250.0, "deposit_fee": 338.5})

    def test_get_withdrawals_amount_mutation_0(self):
        task = transaction_service.get_withdrawals_amount.s(
            begin=None, end=None
        ).apply()
        self.assertEqual(task.result, {"withdrawal_count": 36, "withdrawal_total": 35599.5, "withdrawal_fee": 533.9925})

    def test_get_periodical_transaction_amount_mutation_0(self):
        task = transaction_service.get_periodical_transaction_amount.s(
            type_='deposit'
        ).apply()
        self.assertEqual(task.result, {"daily": [{"date": "2020-12-01", "value": 1250.0, "count": 6}, {"date": "2020-12-02", "value": 1850.0, "count": 3}, {"date": "2020-12-03", "value": 600.0, "count": 4}, {"date": "2020-12-04", "value": 1800.0, "count": 4}, {"date": "2020-12-05", "value": 1700.0, "count": 4}, {"date": "2020-12-06", "value": 2750.0, "count": 6}, {"date": "2020-12-07", "value": 550.0, "count": 4}, {"date": "2020-12-08", "value": 600.0, "count": 4}, {"date": "2020-12-09", "value": 250.0, "count": 2}, {"date": "2020-12-10", "value": 900.0, "count": 4}, {"date": "2020-12-11", "value": 600.0, "count": 3}, {"date": "2020-12-12", "value": 700.0, "count": 2}, {"date": "2020-12-13", "value": 1400.0, "count": 2}, {"date": "2020-12-14", "value": 200.0, "count": 1}, {"date": "2020-12-15", "value": 200.0, "count": 2}, {"date": "2020-12-16", "value": 1050.0, "count": 3}, {"date": "2020-12-17", "value": 450.0, "count": 2}, {"date": "2020-12-18", "value": 100.0, "count": 1}, {"date": "2020-12-19", "value": 100.0, "count": 1}, {"date": "2020-12-20", "value": 17200.0, "count": 10}, {"date": "2020-12-21", "value": 400.0, "count": 5}, {"date": "2020-12-22", "value": 21050.0, "count": 6}, {"date": "2020-12-23", "value": 1500.0, "count": 5}, {"date": "2020-12-24", "value": 2100.0, "count": 5}, {"date": "2020-12-25", "value": 14300.0, "count": 5}, {"date": "2020-12-26", "value": 800.0, "count": 2}, {"date": "2020-12-27", "value": 1750.0, "count": 2}, {"date": "2020-12-28", "value": 10750.0, "count": 2}, {"date": "2020-12-29", "value": 600.0, "count": 2}, {"date": "2020-12-30", "value": 300.0, "count": 2}, {"date": "2020-12-31", "value": 300.0, "count": 3}, {"date": "2021-01-01", "value": 150.0, "count": 2}, {"date": "2021-01-02", "value": 500.0, "count": 2}, {"date": "2021-01-03", "value": 50.0, "count": 1}, {"date": "2021-01-04", "value": 400.0, "count": 1}, {"date": "2021-01-05", "value": 1600.0, "count": 2}, {"date": "2021-01-06", "value": 1700.0, "count": 3}, {"date": "2021-01-07", "value": 25150.0, "count": 3}, {"date": "2021-01-08", "value": 200.0, "count": 3}, {"date": "2021-01-09", "value": 3650.0, "count": 3}, {"date": "2021-01-10", "value": 400.0, "count": 3}, {"date": "2021-01-11", "value": 10050.0, "count": 3}, {"date": "2021-01-12", "value": 650.0, "count": 4}, {"date": "2021-01-13", "value": 6100.0, "count": 6}, {"date": "2021-01-14", "value": 650.0, "count": 4}, {"date": "2021-01-15", "value": 13200.0, "count": 4}, {"date": "2021-01-16", "value": 250.0, "count": 3}, {"date": "2021-01-17", "value": 600.0, "count": 3}, {"date": "2021-01-18", "value": 450.0, "count": 3}, {"date": "2021-01-19", "value": 500.0, "count": 3}, {"date": "2021-01-20", "value": 300.0, "count": 4}, {"date": "2021-01-21", "value": 200.0, "count": 2}, {"date": "2021-01-22", "value": 300.0, "count": 1}, {"date": "2021-01-23", "value": 50.0, "count": 1}, {"date": "2021-01-24", "value": 300.0, "count": 1}, {"date": "2021-01-25", "value": 100.0, "count": 2}, {"date": "2021-01-26", "value": 250.0, "count": 2}, {"date": "2021-01-27", "value": 1700.0, "count": 2}, {"date": "2021-01-28", "value": 400.0, "count": 2}, {"date": "2021-01-29", "value": 150.0, "count": 2}, {"date": "2021-01-30", "value": 600.0, "count": 2}, {"date": "2021-01-31", "value": 2400.0, "count": 3}, {"date": "2021-02-01", "value": 1000.0, "count": 3}, {"date": "2021-02-02", "value": 1450.0, "count": 3}, {"date": "2021-02-03", "value": 100.0, "count": 2}, {"date": "2021-02-04", "value": 1400.0, "count": 2}, {"date": "2021-02-05", "value": 200.0, "count": 1}, {"date": "2021-02-06", "value": 50.0, "count": 1}, {"date": "2021-02-07", "value": 50.0, "count": 1}, {"date": "2021-02-08", "value": 300.0, "count": 1}, {"date": "2021-02-09", "value": 50.0, "count": 1}, {"date": "2021-02-10", "value": 100.0, "count": 1}, {"date": "2021-02-11", "value": 100.0, "count": 2}, {"date": "2021-02-12", "value": 1900.0, "count": 1}, {"date": "2021-02-13", "value": 100.0, "count": 1}, {"date": "2021-02-18", "value": 50.0, "count": 1}, {"date": "2021-02-21", "value": 100.0, "count": 1}, {"date": "2021-02-22", "value": 50.0, "count": 1}, {"date": "2021-02-23", "value": 200.0, "count": 1}, {"date": "2021-02-24", "value": 100.0, "count": 1}, {"date": "2021-02-25", "value": 150.0, "count": 2}, {"date": "2021-02-26", "value": 50.0, "count": 1}, {"date": "2021-02-27", "value": 100.0, "count": 1}, {"date": "2021-02-28", "value": 350.0, "count": 2}, {"date": "2021-03-01", "value": 50.0, "count": 1}, {"date": "2021-03-02", "value": 100.0, "count": 1}, {"date": "2021-03-03", "value": 50.0, "count": 1}], "weekly": [{"date": "2020-12-07", "value": 10500.0, "count": 31}, {"date": "2020-12-14", "value": 4650.0, "count": 18}, {"date": "2020-12-21", "value": 19500.0, "count": 24}, {"date": "2020-12-28", "value": 52250.0, "count": 27}, {"date": "2021-01-04", "value": 2300.0, "count": 13}, {"date": "2021-01-11", "value": 42750.0, "count": 20}, {"date": "2021-01-18", "value": 21900.0, "count": 27}, {"date": "2021-01-25", "value": 1750.0, "count": 14}, {"date": "2021-02-01", "value": 6500.0, "count": 16}, {"date": "2021-02-08", "value": 3550.0, "count": 11}, {"date": "2021-02-15", "value": 2250.0, "count": 6}, {"date": "2021-02-22", "value": 200.0, "count": 3}, {"date": "2021-03-01", "value": 1000.0, "count": 9}, {"date": "2021-03-08", "value": 150.0, "count": 2}], "monthly": [{"date": "February", "value": 7950.0, "count": 31}, {"date": "January", "value": 72850.0, "count": 78}, {"date": "March", "value": 200.0, "count": 3}], "yearly": [{"date": "2020", "value": 88100.0, "count": 107}, {"date": "2021", "value": 81150.0, "count": 114}]})

    def test_get_periodical_transaction_amount_mutation_0(self):
        task = transaction_service.get_periodical_transaction_amount.s(
            type_='withdrwal'
        ).apply()
        self.assertEqual(task.result, {"daily": [{"date": "2021-01-18", "value": 83.02, "count": 1}, {"date": "2021-01-31", "value": 205.9, "count": 1}, {"date": "2021-03-02", "value": 38.43, "count": 1}, {"date": "2021-03-04", "value": 1594.88, "count": 1}, {"date": "2021-04-07", "value": 30.99, "count": 1}, {"date": "2021-04-27", "value": 125.31, "count": 1}, {"date": "2021-05-01", "value": 2926.94, "count": 1}, {"date": "2021-05-22", "value": 465.46, "count": 1}, {"date": "2021-05-23", "value": 447.8, "count": 1}, {"date": "2021-05-25", "value": 176.8, "count": 1}, {"date": "2021-05-26", "value": 46.85, "count": 1}, {"date": "2021-05-30", "value": 35.32, "count": 1}, {"date": "2021-06-03", "value": 165.48, "count": 1}, {"date": "2021-06-07", "value": 85.38, "count": 1}, {"date": "2021-06-20", "value": 129.2, "count": 1}, {"date": "2021-06-24", "value": 40.02, "count": 1}, {"date": "2021-06-26", "value": 272.95, "count": 1}, {"date": "2021-06-30", "value": 25.66, "count": 1}, {"date": "2021-07-16", "value": 41.36, "count": 1}, {"date": "2021-08-10", "value": 1447.54, "count": 1}, {"date": "2021-08-27", "value": 2421.32, "count": 1}, {"date": "2021-09-12", "value": 496.93, "count": 1}, {"date": "2021-09-13", "value": 10903.94, "count": 1}, {"date": "2021-09-22", "value": 98.54, "count": 1}, {"date": "2021-10-08", "value": 33.56, "count": 1}, {"date": "2021-10-11", "value": 43.31, "count": 1}, {"date": "2021-10-14", "value": 6929.95, "count": 1}, {"date": "2021-10-20", "value": 3591.8, "count": 2}, {"date": "2021-10-23", "value": 43.24, "count": 1}, {"date": "2021-11-05", "value": 1957.77, "count": 1}, {"date": "2021-11-18", "value": 101.14, "count": 1}, {"date": "2021-11-25", "value": 50.8, "count": 1}, {"date": "2021-12-04", "value": 315.64, "count": 1}, {"date": "2021-12-13", "value": 177.43, "count": 1}, {"date": "2021-12-22", "value": 48.84, "count": 1}], "weekly": [{"date": "2021-01-18", "value": 83.02, "count": 1}, {"date": "2021-01-25", "value": 0.0, "count": 0}, {"date": "2021-02-01", "value": 205.9, "count": 1}, {"date": "2021-02-08", "value": 0.0, "count": 0}, {"date": "2021-02-15", "value": 0.0, "count": 0}, {"date": "2021-02-22", "value": 0.0, "count": 0}, {"date": "2021-03-01", "value": 0.0, "count": 0}, {"date": "2021-03-08", "value": 1633.3100000000002, "count": 2}, {"date": "2021-03-15", "value": 0.0, "count": 0}, {"date": "2021-03-22", "value": 0.0, "count": 0}, {"date": "2021-03-29", "value": 0.0, "count": 0}, {"date": "2021-04-05", "value": 0.0, "count": 0}, {"date": "2021-04-12", "value": 30.99, "count": 1}, {"date": "2021-04-19", "value": 0.0, "count": 0}, {"date": "2021-04-26", "value": 0.0, "count": 0}, {"date": "2021-05-03", "value": 3052.25, "count": 2}, {"date": "2021-05-10", "value": 0.0, "count": 0}, {"date": "2021-05-17", "value": 0.0, "count": 0}, {"date": "2021-05-24", "value": 913.26, "count": 2}, {"date": "2021-05-31", "value": 258.97, "count": 3}, {"date": "2021-06-07", "value": 250.85999999999999, "count": 2}, {"date": "2021-06-14", "value": 0.0, "count": 0}, {"date": "2021-06-21", "value": 129.2, "count": 1}, {"date": "2021-06-28", "value": 312.96999999999997, "count": 2}, {"date": "2021-07-05", "value": 25.66, "count": 1}, {"date": "2021-07-12", "value": 0.0, "count": 0}, {"date": "2021-07-19", "value": 41.36, "count": 1}, {"date": "2021-07-26", "value": 0.0, "count": 0}, {"date": "2021-08-02", "value": 0.0, "count": 0}, {"date": "2021-08-09", "value": 0.0, "count": 0}, {"date": "2021-08-16", "value": 1447.54, "count": 1}, {"date": "2021-08-23", "value": 0.0, "count": 0}, {"date": "2021-08-30", "value": 2421.32, "count": 1}, {"date": "2021-09-06", "value": 0.0, "count": 0}, {"date": "2021-09-13", "value": 11400.87, "count": 2}, {"date": "2021-09-20", "value": 0.0, "count": 0}, {"date": "2021-09-27", "value": 98.54, "count": 1}, {"date": "2021-10-04", "value": 0.0, "count": 0}, {"date": "2021-10-11", "value": 76.87, "count": 2}, {"date": "2021-10-18", "value": 6929.95, "count": 1}, {"date": "2021-10-25", "value": 3635.04, "count": 3}, {"date": "2021-11-01", "value": 0.0, "count": 0}, {"date": "2021-11-08", "value": 1957.77, "count": 1}, {"date": "2021-11-15", "value": 0.0, "count": 0}, {"date": "2021-11-22", "value": 101.14, "count": 1}, {"date": "2021-11-29", "value": 50.8, "count": 1}, {"date": "2021-12-06", "value": 315.64, "count": 1}, {"date": "2021-12-13", "value": 177.43, "count": 1}, {"date": "2021-12-20", "value": 0.0, "count": 0}, {"date": "2021-12-27", "value": 48.84, "count": 1}], "monthly": [{"date": "April", "value": 156.3, "count": 2}, {"date": "August", "value": 3868.86, "count": 2}, {"date": "December", "value": 541.91, "count": 3}, {"date": "January", "value": 288.92, "count": 2}, {"date": "July", "value": 41.36, "count": 1}, {"date": "June", "value": 718.6899999999999, "count": 6}, {"date": "March", "value": 1633.3100000000002, "count": 2}, {"date": "May", "value": 4099.17, "count": 6}, {"date": "November", "value": 2109.71, "count": 3}, {"date": "October", "value": 10641.859999999999, "count": 6}, {"date": "September", "value": 11499.410000000002, "count": 3}], "yearly": [{"date": "2021", "value": 35599.5, "count": 36}]})

    def test_join_periodic_mutation_0(self):
        task = transaction_service.join_periodic.s(
            {'daily': [{'date': '2020-12-01', 'value': 1250.0, 'count': 6}, {'date': '2020-12-02', 'value': 1850.0, 'count': 3}, {'date': '2020-12-03', 'value': 600.0, 'count': 4}, {'date': '2020-12-04', 'value': 1800.0, 'count': 4}, {'date': '2020-12-05', 'value': 1700.0, 'count': 4}, {'date': '2020-12-06', 'value': 2750.0, 'count': 6}, {'date': '2020-12-07', 'value': 550.0, 'count': 4}, {'date': '2020-12-08', 'value': 600.0, 'count': 4}, {'date': '2020-12-09', 'value': 250.0, 'count': 2}, {'date': '2020-12-10', 'value': 900.0, 'count': 4}, {'date': '2020-12-11', 'value': 600.0, 'count': 3}, {'date': '2020-12-12', 'value': 700.0, 'count': 2}, {'date': '2020-12-13', 'value': 1400.0, 'count': 2}, {'date': '2020-12-14', 'value': 200.0, 'count': 1}, {'date': '2020-12-15', 'value': 200.0, 'count': 2}, {'date': '2020-12-16', 'value': 1050.0, 'count': 3}, {'date': '2020-12-17', 'value': 450.0, 'count': 2}, {'date': '2020-12-18', 'value': 100.0, 'count': 1}, {'date': '2020-12-19', 'value': 100.0, 'count': 1}, {'date': '2020-12-20', 'value': 17200.0, 'count': 10}, {'date': '2020-12-21', 'value': 400.0, 'count': 5}, {'date': '2020-12-22', 'value': 21050.0, 'count': 6}, {'date': '2020-12-23', 'value': 1500.0, 'count': 5}, {'date': '2020-12-24', 'value': 2100.0, 'count': 5}, {'date': '2020-12-25', 'value': 14300.0, 'count': 5}, {'date': '2020-12-26', 'value': 800.0, 'count': 2}, {'date': '2020-12-27', 'value': 1750.0, 'count': 2}, {'date': '2020-12-28', 'value': 10750.0, 'count': 2}, {'date': '2020-12-29', 'value': 600.0, 'count': 2}, {'date': '2020-12-30', 'value': 300.0, 'count': 2}, {'date': '2020-12-31', 'value': 300.0, 'count': 3}, {'date': '2021-01-01', 'value': 150.0, 'count': 2}, {'date': '2021-01-02', 'value': 500.0, 'count': 2}, {'date': '2021-01-03', 'value': 50.0, 'count': 1}, {'date': '2021-01-04', 'value': 400.0, 'count': 1}, {'date': '2021-01-05', 'value': 1600.0, 'count': 2}, {'date': '2021-01-06', 'value': 1700.0, 'count': 3}, {'date': '2021-01-07', 'value': 25150.0, 'count': 3}, {'date': '2021-01-08', 'value': 200.0, 'count': 3}, {'date': '2021-01-09', 'value': 3650.0, 'count': 3}, {'date': '2021-01-10', 'value': 400.0, 'count': 3}, {'date': '2021-01-11', 'value': 10050.0, 'count': 3}, {'date': '2021-01-12', 'value': 650.0, 'count': 4}, {'date': '2021-01-13', 'value': 6100.0, 'count': 6}, {'date': '2021-01-14', 'value': 650.0, 'count': 4}, {'date': '2021-01-15', 'value': 13200.0, 'count': 4}, {'date': '2021-01-16', 'value': 250.0, 'count': 3}, {'date': '2021-01-17', 'value': 600.0, 'count': 3}, {'date': '2021-01-18', 'value': 450.0, 'count': 3}, {'date': '2021-01-19', 'value': 500.0, 'count': 3}, {'date': '2021-01-20', 'value': 300.0, 'count': 4}, {'date': '2021-01-21', 'value': 200.0, 'count': 2}, {'date': '2021-01-22', 'value': 300.0, 'count': 1}, {'date': '2021-01-23', 'value': 50.0, 'count': 1}, {'date': '2021-01-24', 'value': 300.0, 'count': 1}, {'date': '2021-01-25', 'value': 100.0, 'count': 2}, {'date': '2021-01-26', 'value': 250.0, 'count': 2}, {'date': '2021-01-27', 'value': 1700.0, 'count': 2}, {'date': '2021-01-28', 'value': 400.0, 'count': 2}, {'date': '2021-01-29', 'value': 150.0, 'count': 2}, {'date': '2021-01-30', 'value': 600.0, 'count': 2}, {'date': '2021-01-31', 'value': 2400.0, 'count': 3}, {'date': '2021-02-01', 'value': 1000.0, 'count': 3}, {'date': '2021-02-02', 'value': 1450.0, 'count': 3}, {'date': '2021-02-03', 'value': 100.0, 'count': 2}, {'date': '2021-02-04', 'value': 1400.0, 'count': 2}, {'date': '2021-02-05', 'value': 200.0, 'count': 1}, {'date': '2021-02-06', 'value': 50.0, 'count': 1}, {'date': '2021-02-07', 'value': 50.0, 'count': 1}, {'date': '2021-02-08', 'value': 300.0, 'count': 1}, {'date': '2021-02-09', 'value': 50.0, 'count': 1}, {'date': '2021-02-10', 'value': 100.0, 'count': 1}, {'date': '2021-02-11', 'value': 100.0, 'count': 2}, {'date': '2021-02-12', 'value': 1900.0, 'count': 1}, {'date': '2021-02-13', 'value': 100.0, 'count': 1}, {'date': '2021-02-18', 'value': 50.0, 'count': 1}, {'date': '2021-02-21', 'value': 100.0, 'count': 1}, {'date': '2021-02-22', 'value': 50.0, 'count': 1}, {'date': '2021-02-23', 'value': 200.0, 'count': 1}, {'date': '2021-02-24', 'value': 100.0, 'count': 1}, {'date': '2021-02-25', 'value': 150.0, 'count': 2}, {'date': '2021-02-26', 'value': 50.0, 'count': 1}, {'date': '2021-02-27', 'value': 100.0, 'count': 1}, {'date': '2021-02-28', 'value': 350.0, 'count': 2}, {'date': '2021-03-01', 'value': 50.0, 'count': 1}, {'date': '2021-03-02', 'value': 100.0, 'count': 1}, {'date': '2021-03-03', 'value': 50.0, 'count': 1}], 'weekly': [{'date': '2020-12-07', 'value': 10500.0, 'count': 31}, {'date': '2020-12-14', 'value': 4650.0, 'count': 18}, {'date': '2020-12-21', 'value': 19500.0, 'count': 24}, {'date': '2020-12-28', 'value': 52250.0, 'count': 27}, {'date': '2021-01-04', 'value': 2300.0, 'count': 13}, {'date': '2021-01-11', 'value': 42750.0, 'count': 20}, {'date': '2021-01-18', 'value': 21900.0, 'count': 27}, {'date': '2021-01-25', 'value': 1750.0, 'count': 14}, {'date': '2021-02-01', 'value': 6500.0, 'count': 16}, {'date': '2021-02-08', 'value': 3550.0, 'count': 11}, {'date': '2021-02-15', 'value': 2250.0, 'count': 6}, {'date': '2021-02-22', 'value': 200.0, 'count': 3}, {'date': '2021-03-01', 'value': 1000.0, 'count': 9}, {'date': '2021-03-08', 'value': 150.0, 'count': 2}], 'monthly': [{'date': 'February', 'value': 7950.0, 'count': 31}, {'date': 'January', 'value': 72850.0, 'count': 78}, {'date': 'March', 'value': 200.0, 'count': 3}], 'yearly': [{'date': '2020', 'value': 88100.0, 'count': 107}, {'date': '2021', 'value': 81150.0, 'count': 114}]}, {'daily': [{'date': '2021-01-18', 'value': 83.02, 'count': 1}, {'date': '2021-01-31', 'value': 205.9, 'count': 1}, {'date': '2021-03-02', 'value': 38.43, 'count': 1}, {'date': '2021-03-04', 'value': 1594.88, 'count': 1}, {'date': '2021-04-07', 'value': 30.99, 'count': 1}, {'date': '2021-04-27', 'value': 125.31, 'count': 1}, {'date': '2021-05-01', 'value': 2926.94, 'count': 1}, {'date': '2021-05-22', 'value': 465.46, 'count': 1}, {'date': '2021-05-23', 'value': 447.8, 'count': 1}, {'date': '2021-05-25', 'value': 176.8, 'count': 1}, {'date': '2021-05-26', 'value': 46.85, 'count': 1}, {'date': '2021-05-30', 'value': 35.32, 'count': 1}, {'date': '2021-06-03', 'value': 165.48, 'count': 1}, {'date': '2021-06-07', 'value': 85.38, 'count': 1}, {'date': '2021-06-20', 'value': 129.2, 'count': 1}, {'date': '2021-06-24', 'value': 40.02, 'count': 1}, {'date': '2021-06-26', 'value': 272.95, 'count': 1}, {'date': '2021-06-30', 'value': 25.66, 'count': 1}, {'date': '2021-07-16', 'value': 41.36, 'count': 1}, {'date': '2021-08-10', 'value': 1447.54, 'count': 1}, {'date': '2021-08-27', 'value': 2421.32, 'count': 1}, {'date': '2021-09-12', 'value': 496.93, 'count': 1}, {'date': '2021-09-13', 'value': 10903.94, 'count': 1}, {'date': '2021-09-22', 'value': 98.54, 'count': 1}, {'date': '2021-10-08', 'value': 33.56, 'count': 1}, {'date': '2021-10-11', 'value': 43.31, 'count': 1}, {'date': '2021-10-14', 'value': 6929.95, 'count': 1}, {'date': '2021-10-20', 'value': 3591.8, 'count': 2}, {'date': '2021-10-23', 'value': 43.24, 'count': 1}, {'date': '2021-11-05', 'value': 1957.77, 'count': 1}, {'date': '2021-11-18', 'value': 101.14, 'count': 1}, {'date': '2021-11-25', 'value': 50.8, 'count': 1}, {'date': '2021-12-04', 'value': 315.64, 'count': 1}, {'date': '2021-12-13', 'value': 177.43, 'count': 1}, {'date': '2021-12-22', 'value': 48.84, 'count': 1}], 'weekly': [{'date': '2021-01-18', 'value': 83.02, 'count': 1}, {'date': '2021-01-25', 'value': 0.0, 'count': 0}, {'date': '2021-02-01', 'value': 205.9, 'count': 1}, {'date': '2021-02-08', 'value': 0.0, 'count': 0}, {'date': '2021-02-15', 'value': 0.0, 'count': 0}, {'date': '2021-02-22', 'value': 0.0, 'count': 0}, {'date': '2021-03-01', 'value': 0.0, 'count': 0}, {'date': '2021-03-08', 'value': 1633.3100000000002, 'count': 2}, {'date': '2021-03-15', 'value': 0.0, 'count': 0}, {'date': '2021-03-22', 'value': 0.0, 'count': 0}, {'date': '2021-03-29', 'value': 0.0, 'count': 0}, {'date': '2021-04-05', 'value': 0.0, 'count': 0}, {'date': '2021-04-12', 'value': 30.99, 'count': 1}, {'date': '2021-04-19', 'value': 0.0, 'count': 0}, {'date': '2021-04-26', 'value': 0.0, 'count': 0}, {'date': '2021-05-03', 'value': 3052.25, 'count': 2}, {'date': '2021-05-10', 'value': 0.0, 'count': 0}, {'date': '2021-05-17', 'value': 0.0, 'count': 0}, {'date': '2021-05-24', 'value': 913.26, 'count': 2}, {'date': '2021-05-31', 'value': 258.97, 'count': 3}, {'date': '2021-06-07', 'value': 250.85999999999999, 'count': 2}, {'date': '2021-06-14', 'value': 0.0, 'count': 0}, {'date': '2021-06-21', 'value': 129.2, 'count': 1}, {'date': '2021-06-28', 'value': 312.96999999999997, 'count': 2}, {'date': '2021-07-05', 'value': 25.66, 'count': 1}, {'date': '2021-07-12', 'value': 0.0, 'count': 0}, {'date': '2021-07-19', 'value': 41.36, 'count': 1}, {'date': '2021-07-26', 'value': 0.0, 'count': 0}, {'date': '2021-08-02', 'value': 0.0, 'count': 0}, {'date': '2021-08-09', 'value': 0.0, 'count': 0}, {'date': '2021-08-16', 'value': 1447.54, 'count': 1}, {'date': '2021-08-23', 'value': 0.0, 'count': 0}, {'date': '2021-08-30', 'value': 2421.32, 'count': 1}, {'date': '2021-09-06', 'value': 0.0, 'count': 0}, {'date': '2021-09-13', 'value': 11400.87, 'count': 2}, {'date': '2021-09-20', 'value': 0.0, 'count': 0}, {'date': '2021-09-27', 'value': 98.54, 'count': 1}, {'date': '2021-10-04', 'value': 0.0, 'count': 0}, {'date': '2021-10-11', 'value': 76.87, 'count': 2}, {'date': '2021-10-18', 'value': 6929.95, 'count': 1}, {'date': '2021-10-25', 'value': 3635.04, 'count': 3}, {'date': '2021-11-01', 'value': 0.0, 'count': 0}, {'date': '2021-11-08', 'value': 1957.77, 'count': 1}, {'date': '2021-11-15', 'value': 0.0, 'count': 0}, {'date': '2021-11-22', 'value': 101.14, 'count': 1}, {'date': '2021-11-29', 'value': 50.8, 'count': 1}, {'date': '2021-12-06', 'value': 315.64, 'count': 1}, {'date': '2021-12-13', 'value': 177.43, 'count': 1}, {'date': '2021-12-20', 'value': 0.0, 'count': 0}, {'date': '2021-12-27', 'value': 48.84, 'count': 1}], 'monthly': [{'date': 'April', 'value': 156.3, 'count': 2}, {'date': 'August', 'value': 3868.86, 'count': 2}, {'date': 'December', 'value': 541.91, 'count': 3}, {'date': 'January', 'value': 288.92, 'count': 2}, {'date': 'July', 'value': 41.36, 'count': 1}, {'date': 'June', 'value': 718.6899999999999, 'count': 6}, {'date': 'March', 'value': 1633.3100000000002, 'count': 2}, {'date': 'May', 'value': 4099.17, 'count': 6}, {'date': 'November', 'value': 2109.71, 'count': 3}, {'date': 'October', 'value': 10641.859999999999, 'count': 6}, {'date': 'September', 'value': 11499.410000000002, 'count': 3}], 'yearly': [{'date': '2021', 'value': 35599.5, 'count': 36}]}
        ).apply()
        self.assertEqual(task.result, {"daily": [{"date": "2020-12-01", "value_2": 1250.0, "value_1": 0.0, "count_2": 6.0, "count_1": 0.0}, {"date": "2020-12-02", "value_2": 1850.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2020-12-03", "value_2": 600.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2020-12-04", "value_2": 1800.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2020-12-05", "value_2": 1700.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2020-12-06", "value_2": 2750.0, "value_1": 0.0, "count_2": 6.0, "count_1": 0.0}, {"date": "2020-12-07", "value_2": 550.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2020-12-08", "value_2": 600.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2020-12-09", "value_2": 250.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-10", "value_2": 900.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2020-12-11", "value_2": 600.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2020-12-12", "value_2": 700.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-13", "value_2": 1400.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-14", "value_2": 200.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-15", "value_2": 200.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-16", "value_2": 1050.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2020-12-17", "value_2": 450.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-18", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-19", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2020-12-20", "value_2": 17200.0, "value_1": 0.0, "count_2": 10.0, "count_1": 0.0}, {"date": "2020-12-21", "value_2": 400.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2020-12-22", "value_2": 21050.0, "value_1": 0.0, "count_2": 6.0, "count_1": 0.0}, {"date": "2020-12-23", "value_2": 1500.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2020-12-24", "value_2": 2100.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2020-12-25", "value_2": 14300.0, "value_1": 0.0, "count_2": 5.0, "count_1": 0.0}, {"date": "2020-12-26", "value_2": 800.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-27", "value_2": 1750.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-28", "value_2": 10750.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-29", "value_2": 600.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-30", "value_2": 300.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2020-12-31", "value_2": 300.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-01", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-02", "value_2": 500.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-03", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-04", "value_2": 400.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-05", "value_2": 1600.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-06", "value_2": 1700.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-07", "value_2": 25150.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-08", "value_2": 200.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-09", "value_2": 3650.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-10", "value_2": 400.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-11", "value_2": 10050.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-12", "value_2": 650.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-13", "value_2": 6100.0, "value_1": 0.0, "count_2": 6.0, "count_1": 0.0}, {"date": "2021-01-14", "value_2": 650.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-15", "value_2": 13200.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-16", "value_2": 250.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-17", "value_2": 600.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-18", "value_2": 450.0, "value_1": 83.02, "count_2": 3.0, "count_1": 1.0}, {"date": "2021-01-19", "value_2": 500.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-01-20", "value_2": 300.0, "value_1": 0.0, "count_2": 4.0, "count_1": 0.0}, {"date": "2021-01-21", "value_2": 200.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-22", "value_2": 300.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-23", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-24", "value_2": 300.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-01-25", "value_2": 100.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-26", "value_2": 250.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-27", "value_2": 1700.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-28", "value_2": 400.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-29", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-30", "value_2": 600.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-01-31", "value_2": 2400.0, "value_1": 205.9, "count_2": 3.0, "count_1": 1.0}, {"date": "2021-02-01", "value_2": 1000.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-02", "value_2": 1450.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-02-03", "value_2": 100.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-04", "value_2": 1400.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-05", "value_2": 200.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-06", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-07", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-08", "value_2": 300.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-09", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-10", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-11", "value_2": 100.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-12", "value_2": 1900.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-13", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-18", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-21", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-22", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-23", "value_2": 200.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-24", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-25", "value_2": 150.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-02-26", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-27", "value_2": 100.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-02-28", "value_2": 350.0, "value_1": 0.0, "count_2": 2.0, "count_1": 0.0}, {"date": "2021-03-01", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-03-02", "value_2": 100.0, "value_1": 38.43, "count_2": 1.0, "count_1": 1.0}, {"date": "2021-03-03", "value_2": 50.0, "value_1": 0.0, "count_2": 1.0, "count_1": 0.0}, {"date": "2021-03-04", "value_2": 0.0, "value_1": 1594.88, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-04-07", "value_2": 0.0, "value_1": 30.99, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-04-27", "value_2": 0.0, "value_1": 125.31, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-05-01", "value_2": 0.0, "value_1": 2926.94, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-05-22", "value_2": 0.0, "value_1": 465.46, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-05-23", "value_2": 0.0, "value_1": 447.8, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-05-25", "value_2": 0.0, "value_1": 176.8, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-05-26", "value_2": 0.0, "value_1": 46.85, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-05-30", "value_2": 0.0, "value_1": 35.32, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-06-03", "value_2": 0.0, "value_1": 165.48, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-06-07", "value_2": 0.0, "value_1": 85.38, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-06-20", "value_2": 0.0, "value_1": 129.2, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-06-24", "value_2": 0.0, "value_1": 40.02, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-06-26", "value_2": 0.0, "value_1": 272.95, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-06-30", "value_2": 0.0, "value_1": 25.66, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-07-16", "value_2": 0.0, "value_1": 41.36, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-08-10", "value_2": 0.0, "value_1": 1447.54, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-08-27", "value_2": 0.0, "value_1": 2421.32, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-09-12", "value_2": 0.0, "value_1": 496.93, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-09-13", "value_2": 0.0, "value_1": 10903.94, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-09-22", "value_2": 0.0, "value_1": 98.54, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-08", "value_2": 0.0, "value_1": 33.56, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-11", "value_2": 0.0, "value_1": 43.31, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-14", "value_2": 0.0, "value_1": 6929.95, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-20", "value_2": 0.0, "value_1": 3591.8, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-10-23", "value_2": 0.0, "value_1": 43.24, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-11-05", "value_2": 0.0, "value_1": 1957.77, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-11-18", "value_2": 0.0, "value_1": 101.14, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-11-25", "value_2": 0.0, "value_1": 50.8, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-04", "value_2": 0.0, "value_1": 315.64, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-13", "value_2": 0.0, "value_1": 177.43, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-22", "value_2": 0.0, "value_1": 48.84, "count_2": 0.0, "count_1": 1.0}], "weekly": [{"date": "2020-12-07", "value_2": 10500.0, "value_1": 0.0, "count_2": 31.0, "count_1": 0.0}, {"date": "2020-12-14", "value_2": 4650.0, "value_1": 0.0, "count_2": 18.0, "count_1": 0.0}, {"date": "2020-12-21", "value_2": 19500.0, "value_1": 0.0, "count_2": 24.0, "count_1": 0.0}, {"date": "2020-12-28", "value_2": 52250.0, "value_1": 0.0, "count_2": 27.0, "count_1": 0.0}, {"date": "2021-01-04", "value_2": 2300.0, "value_1": 0.0, "count_2": 13.0, "count_1": 0.0}, {"date": "2021-01-11", "value_2": 42750.0, "value_1": 0.0, "count_2": 20.0, "count_1": 0.0}, {"date": "2021-01-18", "value_2": 21900.0, "value_1": 83.02, "count_2": 27.0, "count_1": 1.0}, {"date": "2021-01-25", "value_2": 1750.0, "value_1": 0.0, "count_2": 14.0, "count_1": 0.0}, {"date": "2021-02-01", "value_2": 6500.0, "value_1": 205.9, "count_2": 16.0, "count_1": 1.0}, {"date": "2021-02-08", "value_2": 3550.0, "value_1": 0.0, "count_2": 11.0, "count_1": 0.0}, {"date": "2021-02-15", "value_2": 2250.0, "value_1": 0.0, "count_2": 6.0, "count_1": 0.0}, {"date": "2021-02-22", "value_2": 200.0, "value_1": 0.0, "count_2": 3.0, "count_1": 0.0}, {"date": "2021-03-01", "value_2": 1000.0, "value_1": 0.0, "count_2": 9.0, "count_1": 0.0}, {"date": "2021-03-08", "value_2": 150.0, "value_1": 1633.3100000000002, "count_2": 2.0, "count_1": 2.0}, {"date": "2021-03-15", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-03-22", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-03-29", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-04-05", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-04-12", "value_2": 0.0, "value_1": 30.99, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-04-19", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-04-26", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-05-03", "value_2": 0.0, "value_1": 3052.25, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-05-10", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-05-17", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-05-24", "value_2": 0.0, "value_1": 913.26, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-05-31", "value_2": 0.0, "value_1": 258.97, "count_2": 0.0, "count_1": 3.0}, {"date": "2021-06-07", "value_2": 0.0, "value_1": 250.85999999999999, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-06-14", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-06-21", "value_2": 0.0, "value_1": 129.2, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-06-28", "value_2": 0.0, "value_1": 312.96999999999997, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-07-05", "value_2": 0.0, "value_1": 25.66, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-07-12", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-07-19", "value_2": 0.0, "value_1": 41.36, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-07-26", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-02", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-09", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-16", "value_2": 0.0, "value_1": 1447.54, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-08-23", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-08-30", "value_2": 0.0, "value_1": 2421.32, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-09-06", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-09-13", "value_2": 0.0, "value_1": 11400.87, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-09-20", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-09-27", "value_2": 0.0, "value_1": 98.54, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-04", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-10-11", "value_2": 0.0, "value_1": 76.87, "count_2": 0.0, "count_1": 2.0}, {"date": "2021-10-18", "value_2": 0.0, "value_1": 6929.95, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-10-25", "value_2": 0.0, "value_1": 3635.04, "count_2": 0.0, "count_1": 3.0}, {"date": "2021-11-01", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-11-08", "value_2": 0.0, "value_1": 1957.77, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-11-15", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-11-22", "value_2": 0.0, "value_1": 101.14, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-11-29", "value_2": 0.0, "value_1": 50.8, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-06", "value_2": 0.0, "value_1": 315.64, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-13", "value_2": 0.0, "value_1": 177.43, "count_2": 0.0, "count_1": 1.0}, {"date": "2021-12-20", "value_2": 0.0, "value_1": 0.0, "count_2": 0.0, "count_1": 0.0}, {"date": "2021-12-27", "value_2": 0.0, "value_1": 48.84, "count_2": 0.0, "count_1": 1.0}], "monthly": [{"date": "February", "value_2": 7950.0, "value_1": 0.0, "count_2": 31.0, "count_1": 0.0}, {"date": "January", "value_2": 72850.0, "value_1": 288.92, "count_2": 78.0, "count_1": 2.0}, {"date": "March", "value_2": 200.0, "value_1": 1633.3100000000002, "count_2": 3.0, "count_1": 2.0}, {"date": "April", "value_2": 0.0, "value_1": 156.3, "count_2": 0.0, "count_1": 2.0}, {"date": "August", "value_2": 0.0, "value_1": 3868.86, "count_2": 0.0, "count_1": 2.0}, {"date": "December", "value_2": 0.0, "value_1": 541.91, "count_2": 0.0, "count_1": 3.0}, {"date": "July", "value_2": 0.0, "value_1": 41.36, "count_2": 0.0, "count_1": 1.0}, {"date": "June", "value_2": 0.0, "value_1": 718.6899999999999, "count_2": 0.0, "count_1": 6.0}, {"date": "May", "value_2": 0.0, "value_1": 4099.17, "count_2": 0.0, "count_1": 6.0}, {"date": "November", "value_2": 0.0, "value_1": 2109.71, "count_2": 0.0, "count_1": 3.0}, {"date": "October", "value_2": 0.0, "value_1": 10641.859999999999, "count_2": 0.0, "count_1": 6.0}, {"date": "September", "value_2": 0.0, "value_1": 11499.410000000002, "count_2": 0.0, "count_1": 3.0}], "yearly": [{"date": "2020", "value_2": 88100.0, "value_1": 0.0, "count_2": 107, "count_1": 0.0}, {"date": "2021", "value_2": 81150.0, "value_1": 35599.5, "count_2": 114, "count_1": 36.0}]})

    def test_get_first_deposit_data_mutation_0(self):
        task = transaction_service.get_first_deposit_data.s(
            
        ).apply()
        self.assertEqual(task.result, {"content": [{"date": "2020-12-01", "count": 6, "value": 208.33333333333334, "value_trend": 729.597701149425, "count_trend": 1.9137931034482758}, {"date": "2020-12-02", "count": 1, "value": 1600.0, "value_trend": 725.862068965517, "count_trend": 1.8752052545155993}, {"date": "2020-12-03", "count": 1, "value": 400.0, "value_trend": 722.126436781609, "count_trend": 1.8366174055829227}, {"date": "2020-12-05", "count": 1, "value": 100.0, "value_trend": 718.3908045977009, "count_trend": 1.7980295566502462}, {"date": "2020-12-06", "count": 2, "value": 650.0, "value_trend": 714.6551724137929, "count_trend": 1.7594417077175697}, {"date": "2020-12-08", "count": 1, "value": 50.0, "value_trend": 710.9195402298849, "count_trend": 1.7208538587848932}, {"date": "2020-12-10", "count": 1, "value": 450.0, "value_trend": 707.1839080459769, "count_trend": 1.6822660098522166}, {"date": "2020-12-12", "count": 1, "value": 100.0, "value_trend": 703.4482758620688, "count_trend": 1.64367816091954}, {"date": "2020-12-15", "count": 1, "value": 100.0, "value_trend": 699.7126436781608, "count_trend": 1.6050903119868636}, {"date": "2020-12-20", "count": 3, "value": 100.0, "value_trend": 695.9770114942528, "count_trend": 1.566502463054187}, {"date": "2020-12-23", "count": 1, "value": 1150.0, "value_trend": 692.2413793103448, "count_trend": 1.5279146141215105}, {"date": "2020-12-27", "count": 1, "value": 1300.0, "value_trend": 688.5057471264367, "count_trend": 1.489326765188834}, {"date": "2020-12-30", "count": 1, "value": 50.0, "value_trend": 684.7701149425287, "count_trend": 1.4507389162561575}, {"date": "2020-12-31", "count": 1, "value": 100.0, "value_trend": 681.0344827586207, "count_trend": 1.4121510673234812}, {"date": "2021-01-05", "count": 1, "value": 350.0, "value_trend": 677.2988505747126, "count_trend": 1.3735632183908044}, {"date": "2021-01-07", "count": 1, "value": 8050.0, "value_trend": 673.5632183908046, "count_trend": 1.3349753694581281}, {"date": "2021-01-08", "count": 1, "value": 100.0, "value_trend": 669.8275862068965, "count_trend": 1.2963875205254514}, {"date": "2021-01-12", "count": 1, "value": 50.0, "value_trend": 666.0919540229885, "count_trend": 1.257799671592775}, {"date": "2021-01-13", "count": 3, "value": 1983.3333333333333, "value_trend": 662.3563218390805, "count_trend": 1.2192118226600983}, {"date": "2021-01-15", "count": 1, "value": 50.0, "value_trend": 658.6206896551724, "count_trend": 1.180623973727422}, {"date": "2021-01-20", "count": 2, "value": 75.0, "value_trend": 654.8850574712644, "count_trend": 1.1420361247947453}, {"date": "2021-01-25", "count": 1, "value": 50.0, "value_trend": 651.1494252873564, "count_trend": 1.103448275862069}, {"date": "2021-01-31", "count": 1, "value": 1550.0, "value_trend": 647.4137931034484, "count_trend": 1.0648604269293922}, {"date": "2021-02-11", "count": 1, "value": 50.0, "value_trend": 643.6781609195403, "count_trend": 1.026272577996716}, {"date": "2021-02-18", "count": 1, "value": 50.0, "value_trend": 639.9425287356323, "count_trend": 0.9876847290640394}, {"date": "2021-02-21", "count": 1, "value": 100.0, "value_trend": 636.2068965517243, "count_trend": 0.9490968801313628}, {"date": "2021-02-24", "count": 1, "value": 100.0, "value_trend": 632.4712643678163, "count_trend": 0.9105090311986863}, {"date": "2021-02-28", "count": 1, "value": 100.0, "value_trend": 628.7356321839083, "count_trend": 0.8719211822660098}]})

    def test_get_deposit_categories_mutation_0(self):
        task = transaction_service.get_deposit_categories.s(
            'all', None, None
        ).apply()
        self.assertEqual(task.result, {"content": [{"_id": "50-100", "count": 67, "amount": 3350.0, "avg": 50.0, "share": 30.316742081447963}, {"_id": "100-200", "count": 70, "amount": 7300.0, "avg": 104.28571428571429, "share": 31.674208144796378}, {"_id": "200-500", "count": 45, "amount": 14550.0, "avg": 323.3333333333333, "share": 20.361990950226243}, {"_id": "500-1000", "count": 9, "amount": 5350.0, "avg": 594.4444444444445, "share": 4.072398190045249}, {"_id": "1000-1500", "count": 12, "amount": 14500.0, "avg": 1208.3333333333333, "share": 5.429864253393665}, {"_id": "1500-5000", "count": 10, "amount": 19550.0, "avg": 1955.0, "share": 4.524886877828054}, {"_id": "5000-10000", "count": 2, "amount": 17900.0, "avg": 8950.0, "share": 0.904977375565611}, {"_id": "10000-MAX", "count": 6, "amount": 86750.0, "avg": 14458.333333333334, "share": 2.7149321266968327}], "max": 70, "total_amount": 169250.0, "total_count": 221, "total_avg": 765.8371040723982, "total_share": 99.99999999999999})

    def test_get_top_deposit_info_mutation_0(self):
        task = transaction_service.get_top_deposit_info.s(
            {'content': []}
        ).apply()
        self.assertEqual(task.result, {"content": []})

    def test_get_deposits_mutation_0(self):
        task = transaction_service.get_deposits.s(
            None, 20, 0, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 339, \"total_pages\": 17, \"current_page\": 0, \"content\": [{\"_id\": \"61e3497aeec798982293afc2\", \"user_id\": \"6017edf6eec798982293a957\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"17769\", \"quantity_in_asset\": \"25.38429\", \"quantity\": \"177.69\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2022-01-15 23:23:54\", \"date_modified\": \"2022-01-15 23:24:37\"}, {\"_id\": \"61d62950eec798982293af7d\", \"user_id\": \"6017edf6eec798982293a953\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"384595\", \"quantity_in_asset\": \"26921.65000\", \"quantity\": \"3845.95\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2022-01-06 00:27:12\", \"date_modified\": \"2022-01-06 00:29:31\"}, {\"_id\": \"61c81bf8eec798982293b023\", \"user_id\": \"6017edf6eec798982293a95c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"62331\", \"quantity_in_asset\": \"5609.79000\", \"quantity\": \"623.31\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-26 08:38:32\", \"date_modified\": \"2021-12-26 08:38:57\"}, {\"_id\": \"61c2e70aeec798982293adea\", \"user_id\": \"6017edf6eec798982293a936\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"11824\", \"quantity_in_asset\": \"14.78000\", \"quantity\": \"118.24\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-22 09:51:22\", \"date_modified\": \"2021-12-22 09:51:33\"}, {\"_id\": \"61bebb64eec798982293b006\", \"user_id\": \"6017edf6eec798982293a95d\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"212879\", \"quantity_in_asset\": \"10643.95000\", \"quantity\": \"2128.79\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-19 05:56:04\", \"date_modified\": \"2021-12-19 05:58:06\"}, {\"_id\": \"61bbf62feec798982293b090\", \"user_id\": \"6017edf6eec798982293a965\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"20241\", \"quantity_in_asset\": \"40.48200\", \"quantity\": \"202.41\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-17 03:30:07\", \"date_modified\": \"2021-12-17 03:30:24\"}, {\"_id\": \"61b689e8eec798982293aea3\", \"user_id\": \"6017edf6eec798982293a93b\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"90731\", \"quantity_in_asset\": \"151.21833\", \"quantity\": \"907.31\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-13 00:46:48\", \"date_modified\": \"2021-12-13 00:48:31\"}, {\"_id\": \"61b572bbeec798982293b066\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"8608\", \"quantity_in_asset\": \"172.16000\", \"quantity\": \"86.08\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-12 04:55:39\", \"date_modified\": \"2021-12-12 04:56:46\"}, {\"_id\": \"61b1b278eec798982293b02f\", \"user_id\": \"6017edf6eec798982293a95c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"13638\", \"quantity_in_asset\": \"954.66000\", \"quantity\": \"136.38\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-09 08:38:32\", \"date_modified\": \"2021-12-09 08:39:25\"}, {\"_id\": \"61a2a9a7eec798982293ad5b\", \"user_id\": \"6017edf6eec798982293a940\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"68907\", \"quantity_in_asset\": \"137.81400\", \"quantity\": \"689.07\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-27 22:56:55\", \"date_modified\": \"2021-11-27 22:59:11\"}, {\"_id\": \"619d0524eec798982293af11\", \"user_id\": \"6017edf6eec798982293a950\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"328802\", \"quantity_in_asset\": \"822.00500\", \"quantity\": \"3288.02\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-23 16:13:40\", \"date_modified\": \"2021-11-23 16:15:52\"}, {\"_id\": \"619ac6faeec798982293af9f\", \"user_id\": \"6017edf6eec798982293a957\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"37953\", \"quantity_in_asset\": \"1138.59000\", \"quantity\": \"379.53\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-21 23:23:54\", \"date_modified\": \"2021-11-21 23:24:29\"}, {\"_id\": \"618683f8eec798982293b037\", \"user_id\": \"6017edf6eec798982293a94f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"15017\", \"quantity_in_asset\": \"450.51000\", \"quantity\": \"150.17\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-06 14:32:40\", \"date_modified\": \"2021-11-06 14:35:30\"}, {\"_id\": \"617e47f8eec798982293afe7\", \"user_id\": \"6017edf6eec798982293a95c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"19642\", \"quantity_in_asset\": \"49.10500\", \"quantity\": \"196.42\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-31 08:38:32\", \"date_modified\": \"2021-10-31 08:41:48\"}, {\"_id\": \"61766a44eec798982293afed\", \"user_id\": \"6017edf6eec798982293a959\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"246960\", \"quantity_in_asset\": \"617.40000\", \"quantity\": \"2469.60\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-25 10:26:44\", \"date_modified\": \"2021-10-25 10:29:00\"}, {\"_id\": \"616cf03beec798982293b06c\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"22130\", \"quantity_in_asset\": \"221.30000\", \"quantity\": \"221.30\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-18 05:55:39\", \"date_modified\": \"2021-10-18 05:57:53\"}, {\"_id\": \"61674fa1eec798982293ad8c\", \"user_id\": \"6017edf6eec798982293a93a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"8019\", \"quantity_in_asset\": \"240.57000\", \"quantity\": \"80.19\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-13 23:29:05\", \"date_modified\": \"2021-10-13 23:30:02\"}, {\"_id\": \"615ba38beec798982293b072\", \"user_id\": \"6017edf6eec798982293a963\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"6534\", \"quantity_in_asset\": \"8.16750\", \"quantity\": \"65.34\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-05 02:59:55\", \"date_modified\": \"2021-10-05 03:01:21\"}, {\"_id\": \"61565d8beec798982293b07e\", \"user_id\": \"6017edf6eec798982293a963\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"6585\", \"quantity_in_asset\": \"65.85000\", \"quantity\": \"65.85\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-01 02:59:55\", \"date_modified\": \"2021-10-01 03:02:24\"}, {\"_id\": \"615647d0eec798982293af5b\", \"user_id\": \"6017edf6eec798982293a953\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"7605\", \"quantity_in_asset\": \"9.50625\", \"quantity\": \"76.05\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-01 01:27:12\", \"date_modified\": \"2021-10-01 01:30:29\"}]}")

    def test_get_deposits_mutation_1(self):
        task = transaction_service.get_deposits.s(
            None, 20, 0, 'date_added', 'desc', None, None, 'Mich'
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 116, \"total_pages\": 6, \"current_page\": 0, \"content\": [{\"_id\": \"61e3497aeec798982293afc2\", \"user_id\": \"6017edf6eec798982293a957\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"17769\", \"quantity_in_asset\": \"25.38429\", \"quantity\": \"177.69\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2022-01-15 23:23:54\", \"date_modified\": \"2022-01-15 23:24:37\"}, {\"_id\": \"61d62950eec798982293af7d\", \"user_id\": \"6017edf6eec798982293a953\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"384595\", \"quantity_in_asset\": \"26921.65000\", \"quantity\": \"3845.95\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2022-01-06 00:27:12\", \"date_modified\": \"2022-01-06 00:29:31\"}, {\"_id\": \"61bbf62feec798982293b090\", \"user_id\": \"6017edf6eec798982293a965\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"20241\", \"quantity_in_asset\": \"40.48200\", \"quantity\": \"202.41\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-17 03:30:07\", \"date_modified\": \"2021-12-17 03:30:24\"}, {\"_id\": \"61b689e8eec798982293aea3\", \"user_id\": \"6017edf6eec798982293a93b\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"90731\", \"quantity_in_asset\": \"151.21833\", \"quantity\": \"907.31\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-13 00:46:48\", \"date_modified\": \"2021-12-13 00:48:31\"}, {\"_id\": \"61b1b278eec798982293b02f\", \"user_id\": \"6017edf6eec798982293a95c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"13638\", \"quantity_in_asset\": \"954.66000\", \"quantity\": \"136.38\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-12-09 08:38:32\", \"date_modified\": \"2021-12-09 08:39:25\"}, {\"_id\": \"619d0524eec798982293af11\", \"user_id\": \"6017edf6eec798982293a950\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"328802\", \"quantity_in_asset\": \"822.00500\", \"quantity\": \"3288.02\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-11-23 16:13:40\", \"date_modified\": \"2021-11-23 16:15:52\"}, {\"_id\": \"61766a44eec798982293afed\", \"user_id\": \"6017edf6eec798982293a959\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"246960\", \"quantity_in_asset\": \"617.40000\", \"quantity\": \"2469.60\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-25 10:26:44\", \"date_modified\": \"2021-10-25 10:29:00\"}, {\"_id\": \"616cf03beec798982293b06c\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"22130\", \"quantity_in_asset\": \"221.30000\", \"quantity\": \"221.30\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-18 05:55:39\", \"date_modified\": \"2021-10-18 05:57:53\"}, {\"_id\": \"61674fa1eec798982293ad8c\", \"user_id\": \"6017edf6eec798982293a93a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"8019\", \"quantity_in_asset\": \"240.57000\", \"quantity\": \"80.19\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-10-13 23:29:05\", \"date_modified\": \"2021-10-13 23:30:02\"}, {\"_id\": \"615257e8eec798982293ae1e\", \"user_id\": \"6017edf6eec798982293a941\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"54549\", \"quantity_in_asset\": \"1636.47000\", \"quantity\": \"545.49\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-28 01:46:48\", \"date_modified\": \"2021-09-28 01:48:00\"}, {\"_id\": \"613a9ce8eec798982293aebf\", \"user_id\": \"6017edf6eec798982293a936\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"58623\", \"quantity_in_asset\": \"5276.07000\", \"quantity\": \"586.23\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-10 01:46:48\", \"date_modified\": \"2021-09-10 01:48:48\"}, {\"_id\": \"612b0b81eec798982293ad7b\", \"user_id\": \"6017edf6eec798982293a942\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"144008\", \"quantity_in_asset\": \"4320.24000\", \"quantity\": \"1440.08\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-29 06:22:25\", \"date_modified\": \"2021-08-29 06:24:46\"}, {\"_id\": \"61241ffaeec798982293af69\", \"user_id\": \"6017edf6eec798982293a957\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"30230\", \"quantity_in_asset\": \"50.38333\", \"quantity\": \"302.30\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-24 00:23:54\", \"date_modified\": \"2021-08-24 00:26:55\"}, {\"_id\": \"61219068eec798982293ae7b\", \"user_id\": \"6017edf6eec798982293a936\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"55154\", \"quantity_in_asset\": \"61.28222\", \"quantity\": \"551.54\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-22 01:46:48\", \"date_modified\": \"2021-08-22 01:49:24\"}, {\"_id\": \"61202b7aeec798982293afb6\", \"user_id\": \"6017edf6eec798982293a957\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"16572\", \"quantity_in_asset\": \"1325.76000\", \"quantity\": \"165.72\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-21 00:23:54\", \"date_modified\": \"2021-08-21 00:24:19\"}, {\"_id\": \"610be878eec798982293aed6\", \"user_id\": \"6017edf6eec798982293a94f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"8096\", \"quantity_in_asset\": \"242.88000\", \"quantity\": \"80.96\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-05 15:32:40\", \"date_modified\": \"2021-08-05 15:32:40\"}, {\"_id\": \"6107a0f8eec798982293afdf\", \"user_id\": \"6017edf6eec798982293a95c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"22242\", \"quantity_in_asset\": \"1334.52000\", \"quantity\": \"222.42\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-02 09:38:32\", \"date_modified\": \"2021-08-02 09:40:49\"}, {\"_id\": \"61025796eec798982293af94\", \"user_id\": \"6017edf6eec798982293a954\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"26235\", \"quantity_in_asset\": \"1311.75000\", \"quantity\": \"262.35\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-29 09:24:06\", \"date_modified\": \"2021-07-29 09:25:18\"}, {\"_id\": \"60f19596eec798982293afbc\", \"user_id\": \"6017edf6eec798982293a95a\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"11056\", \"quantity_in_asset\": \"110.56000\", \"quantity\": \"110.56\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-16 16:20:06\", \"date_modified\": \"2021-07-16 16:22:21\"}, {\"_id\": \"60f169b3eec798982293ae9d\", \"user_id\": \"6017edf6eec798982293a94d\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"226453\", \"quantity_in_asset\": \"18116.24000\", \"quantity\": \"2264.53\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-16 13:12:51\", \"date_modified\": \"2021-07-16 13:13:18\"}]}")

    def test_get_deposits_mutation_2(self):
        task = transaction_service.get_deposits.s(
            None, 20, 1, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 339, \"total_pages\": 17, \"current_page\": 1, \"content\": [{\"_id\": \"615257e8eec798982293ae1e\", \"user_id\": \"6017edf6eec798982293a941\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"54549\", \"quantity_in_asset\": \"1636.47000\", \"quantity\": \"545.49\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-28 01:46:48\", \"date_modified\": \"2021-09-28 01:48:00\"}, {\"_id\": \"6150f2faeec798982293af55\", \"user_id\": \"6017edf6eec798982293a957\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"9983\", \"quantity_in_asset\": \"12.47875\", \"quantity\": \"99.83\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-27 00:23:54\", \"date_modified\": \"2021-09-27 00:24:41\"}, {\"_id\": \"614ea9dceec798982293ade4\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"39468\", \"quantity_in_asset\": \"3552.12000\", \"quantity\": \"394.68\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-25 06:47:24\", \"date_modified\": \"2021-09-25 06:50:22\"}, {\"_id\": \"614d11e8eec798982293ae39\", \"user_id\": \"6017edf6eec798982293a94b\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"17174\", \"quantity_in_asset\": \"858.70000\", \"quantity\": \"171.74\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"cancel\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-24 01:46:48\", \"date_modified\": \"2021-09-24 01:47:27\"}, {\"_id\": \"614675d0eec798982293af2f\", \"user_id\": \"6017edf6eec798982293a953\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"520420\", \"quantity_in_asset\": \"1301.05000\", \"quantity\": \"5204.20\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-19 01:27:12\", \"date_modified\": \"2021-09-19 01:28:10\"}, {\"_id\": \"614528e8eec798982293ae49\", \"user_id\": \"6017edf6eec798982293a944\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"7887\", \"quantity_in_asset\": \"236.61000\", \"quantity\": \"78.87\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-18 01:46:48\", \"date_modified\": \"2021-09-18 01:46:49\"}, {\"_id\": \"6142ffc4eec798982293b000\", \"user_id\": \"6017edf6eec798982293a959\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"28830\", \"quantity_in_asset\": \"41.18571\", \"quantity\": \"288.30\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-16 10:26:44\", \"date_modified\": \"2021-09-16 10:27:45\"}, {\"_id\": \"613a9ce8eec798982293aebf\", \"user_id\": \"6017edf6eec798982293a936\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"58623\", \"quantity_in_asset\": \"5276.07000\", \"quantity\": \"586.23\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-10 01:46:48\", \"date_modified\": \"2021-09-10 01:48:48\"}, {\"_id\": \"6139cb0aeec798982293b05c\", \"user_id\": \"6017edf6eec798982293a93a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"18083\", \"quantity_in_asset\": \"904.15000\", \"quantity\": \"180.83\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-09 10:51:22\", \"date_modified\": \"2021-09-09 10:54:41\"}, {\"_id\": \"612b0b81eec798982293ad7b\", \"user_id\": \"6017edf6eec798982293a942\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"144008\", \"quantity_in_asset\": \"4320.24000\", \"quantity\": \"1440.08\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-29 06:22:25\", \"date_modified\": \"2021-08-29 06:24:46\"}, {\"_id\": \"612acae8eec798982293ae5d\", \"user_id\": \"6017edf6eec798982293a942\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"6981\", \"quantity_in_asset\": \"17.45250\", \"quantity\": \"69.81\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-29 01:46:48\", \"date_modified\": \"2021-08-29 01:50:07\"}, {\"_id\": \"6128e978eec798982293aee7\", \"user_id\": \"6017edf6eec798982293a94f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"99594\", \"quantity_in_asset\": \"6971.58000\", \"quantity\": \"995.94\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-27 15:32:40\", \"date_modified\": \"2021-08-27 15:35:54\"}, {\"_id\": \"61241ffaeec798982293af69\", \"user_id\": \"6017edf6eec798982293a957\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"30230\", \"quantity_in_asset\": \"50.38333\", \"quantity\": \"302.30\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-24 00:23:54\", \"date_modified\": \"2021-08-24 00:26:55\"}, {\"_id\": \"6121cabbeec798982293b088\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"55421\", \"quantity_in_asset\": \"4433.68000\", \"quantity\": \"554.21\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-22 05:55:39\", \"date_modified\": \"2021-08-22 05:56:00\"}, {\"_id\": \"61219068eec798982293ae7b\", \"user_id\": \"6017edf6eec798982293a936\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"55154\", \"quantity_in_asset\": \"61.28222\", \"quantity\": \"551.54\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-22 01:46:48\", \"date_modified\": \"2021-08-22 01:49:24\"}, {\"_id\": \"61202b7aeec798982293afb6\", \"user_id\": \"6017edf6eec798982293a957\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"16572\", \"quantity_in_asset\": \"1325.76000\", \"quantity\": \"165.72\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-21 00:23:54\", \"date_modified\": \"2021-08-21 00:24:19\"}, {\"_id\": \"611f9cc2eec798982293ada7\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"110965\", \"quantity_in_asset\": \"4438.60000\", \"quantity\": \"1109.65\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-20 14:14:58\", \"date_modified\": \"2021-08-20 14:16:18\"}, {\"_id\": \"611e4ce3eec798982293ae0f\", \"user_id\": \"6017edf6eec798982293a94b\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"18332\", \"quantity_in_asset\": \"20.36889\", \"quantity\": \"183.32\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-19 14:21:55\", \"date_modified\": \"2021-08-19 14:24:02\"}, {\"_id\": \"61170468eec798982293b01b\", \"user_id\": \"6017edf6eec798982293a941\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"38406\", \"quantity_in_asset\": \"128.02000\", \"quantity\": \"384.06\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"cancel\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-14 01:46:48\", \"date_modified\": \"2021-08-14 01:46:54\"}, {\"_id\": \"610be878eec798982293aed6\", \"user_id\": \"6017edf6eec798982293a94f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"8096\", \"quantity_in_asset\": \"242.88000\", \"quantity\": \"80.96\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-05 15:32:40\", \"date_modified\": \"2021-08-05 15:32:40\"}]}")

    def test_get_customer_deposit_snapshot_mutation_0(self):
        task = transaction_service.get_customer_deposit_snapshot.s(
            user_id='6017edf6eec798982293a945'
        ).apply()
        self.assertEqual(task.result, "[{\"date\": \"2020-12-10\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 450.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-11\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 100.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-13\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 300.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-14\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 200.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-15\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 300.00 (external)\", \"status\": \"cancel\"}, {\"date\": \"2020-12-16\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 350.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-17\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 50.00 (external)\", \"status\": \"pending\"}, {\"date\": \"2020-12-20\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 13150.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-21\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 150.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-22\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 300.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-23\", \"time\": \"00:46:48\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 1250.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-23\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 100.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-24\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 50.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-25\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 100.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-26\", \"time\": \"05:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 100.00 (external)\", \"status\": \"pending\"}, {\"date\": \"2020-12-29\", \"time\": \"00:46:48\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 10700.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-30\", \"time\": \"00:46:48\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 150.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2021-05-15\", \"time\": \"06:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 8337.70 (internal)\", \"status\": \"pending\"}, {\"date\": \"2021-05-26\", \"time\": \"06:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 442.12 (internal)\", \"status\": \"approved\"}, {\"date\": \"2021-06-30\", \"time\": \"06:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 373.13 (internal)\", \"status\": \"approved\"}, {\"date\": \"2021-08-02\", \"time\": \"06:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 731.62 (internal)\", \"status\": \"approved\"}, {\"date\": \"2021-09-25\", \"time\": \"06:47:24\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 394.68 (internal)\", \"status\": \"approved\"}]")

    def test_get_withdraws_mutation_0(self):
        task = transaction_service.get_withdraws.s(
            '6017edf6eec798982293a945', 10, 0, 'date_added', 'desc', None, None, None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 4, \"total_pages\": 1, \"current_page\": 0, \"content\": [{\"_id\": \"6195dadceec798982293ae3c\", \"user_id\": \"6017edf6eec798982293a945\", \"account_number\": \"NL74KJKY8568767056\", \"holder_name\": \"SILKE LUCY VAN VENROOY\", \"description\": \"RevenYOU withdrawal #6ea3e2f480256f1982e7147310cbd3126c603571\", \"method\": \"ideal\", \"order_id\": \"bf9d67d070b10f74e60977f940ed6929c5431a1b\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"101.14\", \"withdrawal_amount_fiat\": \"99.62\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"10114\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-11-18 05:47:24\", \"date_modified\": \"2021-11-18 05:48:54\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"613fe2e8eec798982293aeac\", \"user_id\": \"6017edf6eec798982293a945\", \"account_number\": \"NL38SDNR7517431958\", \"holder_name\": \"SILKE LUCY VAN VENROOY\", \"description\": \"RevenYOU withdrawal #0f950f219f183d4597e3a0de0f490466f1c59620\", \"method\": \"ideal\", \"order_id\": \"e706118114b796e2e6cade0958400981715c37f3\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"10903.94\", \"withdrawal_amount_fiat\": \"10740.38\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"1090394\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-09-14 01:46:48\", \"date_modified\": \"2021-09-14 01:49:28\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"613d865ceec798982293ae4f\", \"user_id\": \"6017edf6eec798982293a945\", \"account_number\": \"NL65ULRE6897309391\", \"holder_name\": \"SILKE LUCY VAN VENROOY\", \"description\": \"RevenYOU withdrawal #b94a0c0c51ef7eba4983aae0420462b3710febdd\", \"method\": \"ideal\", \"order_id\": \"aa005918795a40e51679d5fafee4f4a199084e74\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"496.93\", \"withdrawal_amount_fiat\": \"489.48\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"49693\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-09-12 06:47:24\", \"date_modified\": \"2021-09-12 06:48:35\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6040665ceec798982293ae76\", \"user_id\": \"6017edf6eec798982293a945\", \"account_number\": \"NL02EYTW3888322122\", \"holder_name\": \"SILKE LUCY VAN VENROOY\", \"description\": \"RevenYOU withdrawal #4907ae20cd0e857e22c0ac6ad7973e9d0607519e\", \"method\": \"ideal\", \"order_id\": \"9d328a0ae26181665359cb9b8cad99fc4da1e26e\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"1594.88\", \"withdrawal_amount_fiat\": \"1570.96\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"159488\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-03-04 05:47:24\", \"date_modified\": \"2021-03-04 05:50:39\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}]}")

    def test_get_customer_withdrawal_snapshot_mutation_0(self):
        task = transaction_service.get_customer_withdrawal_snapshot.s(
            user_id='6017edf6eec798982293a945'
        ).apply()
        self.assertEqual(task.result, "[{\"date\": \"2021-03-04\", \"time\": \"05:47:24\", \"operation\": \"WITHDRAWAL\", \"description\": \"user withdrawn amount: 1570.96\", \"status\": \"approved\"}, {\"date\": \"2021-09-12\", \"time\": \"06:47:24\", \"operation\": \"WITHDRAWAL\", \"description\": \"user withdrawn amount: 489.48\", \"status\": \"approved\"}, {\"date\": \"2021-09-14\", \"time\": \"01:46:48\", \"operation\": \"WITHDRAWAL\", \"description\": \"user withdrawn amount: 10740.38\", \"status\": \"approved\"}, {\"date\": \"2021-11-18\", \"time\": \"05:47:24\", \"operation\": \"WITHDRAWAL\", \"description\": \"user withdrawn amount: 99.62\", \"status\": \"approved\"}]")

    def test_get_deposits_mutation_3(self):
        task = transaction_service.get_deposits.s(
            '6017edf6eec798982293a945', 10, 0, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 22, \"total_pages\": 3, \"current_page\": 0, \"content\": [{\"_id\": \"614ea9dceec798982293ade4\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"39468\", \"quantity_in_asset\": \"3552.12000\", \"quantity\": \"394.68\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-09-25 06:47:24\", \"date_modified\": \"2021-09-25 06:50:22\"}, {\"_id\": \"610778dceec798982293adcc\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"73162\", \"quantity_in_asset\": \"2194.86000\", \"quantity\": \"731.62\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-02 06:47:24\", \"date_modified\": \"2021-08-02 06:48:52\"}, {\"_id\": \"60dbf75ceec798982293addb\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"37313\", \"quantity_in_asset\": \"3358.17000\", \"quantity\": \"373.13\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-30 06:47:24\", \"date_modified\": \"2021-06-30 06:49:51\"}, {\"_id\": \"60add2dceec798982293adf3\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"44212\", \"quantity_in_asset\": \"3094.84000\", \"quantity\": \"442.12\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-26 06:47:24\", \"date_modified\": \"2021-05-26 06:49:35\"}, {\"_id\": \"609f525ceec798982293ae15\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"833770\", \"quantity_in_asset\": \"1389.61667\", \"quantity\": \"8337.70\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-15 06:47:24\", \"date_modified\": \"2021-05-15 06:48:12\"}, {\"_id\": \"5febbfe8eec798982293aadf\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"15000\", \"quantity_in_asset\": \"750.00000\", \"quantity\": \"150.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b10b\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-30 00:46:48\", \"date_modified\": \"2020-12-30 00:47:31\"}, {\"_id\": \"5fea6e68eec798982293aadb\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"1070000\", \"quantity_in_asset\": \"74900.00000\", \"quantity\": \"10700.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b109\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-29 00:46:48\", \"date_modified\": \"2020-12-29 00:48:57\"}, {\"_id\": \"5fe6c05ceec798982293aafb\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"400.00000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b102\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"pending\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-26 05:47:24\", \"date_modified\": \"2020-12-26 05:49:15\"}, {\"_id\": \"5fe56edceec798982293aaf7\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"16.66667\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b0fd\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-25 05:47:24\", \"date_modified\": \"2020-12-25 05:47:57\"}, {\"_id\": \"5fe41d5ceec798982293aaf3\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"8.33333\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b0f7\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-24 05:47:24\", \"date_modified\": \"2020-12-24 05:50:40\"}]}")

    def test_get_withdrawable_amount_dump_mutation_0(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6017edf6eec798982293a945'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_user_deposit_amount_mutation_0(self):
        task = transaction_service.get_user_deposit_amount.s(
            user_id='6017edf6eec798982293a945'
        ).apply()
        self.assertEqual(task.result, {"_id": "", "deposit_amount": 27350.0})

    def test_get_user_withdraw_amount_mutation_0(self):
        task = transaction_service.get_user_withdraw_amount.s(
            user_id='6017edf6eec798982293a945'
        ).apply()
        self.assertEqual(task.result, {"_id": "", "withdrawal_amount": 13096.890000000001})

    def test_get_last_transaction_id_mutation_0(self):
        task = transaction_service.get_last_transaction_id.s(
            user_id='6017edf6eec798982293a945'
        ).apply()
        self.assertEqual(task.result, {"last_transaction": "-"})

    def test_get_withdrawal_bank_account_mutation_0(self):
        task = transaction_service.get_withdrawal_bank_account.s(
            user_id='6017edf6eec798982293a945'
        ).apply()
        self.assertEqual(task.result, {"bank_account": "NL74KJKY8568767056"})

    def test_get_withdrawable_amount_dump_mutation_1(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6017edf6eec798982293a945'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_withdrawable_amount_dump_mutation_2(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6017edf6eec798982293a945'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_withdrawable_amount_dump_mutation_3(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6017edf6eec798982293a945'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_customer_withdrawal_snapshot_mutation_1(self):
        task = transaction_service.get_customer_withdrawal_snapshot.s(
            user_id='6017edf6eec798982293a943'
        ).apply()
        self.assertEqual(task.result, "[]")

    def test_get_customer_deposit_snapshot_mutation_1(self):
        task = transaction_service.get_customer_deposit_snapshot.s(
            user_id='6017edf6eec798982293a943'
        ).apply()
        self.assertEqual(task.result, "[{\"date\": \"2020-12-06\", \"time\": \"13:14:58\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 450.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-08\", \"time\": \"13:14:58\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 400.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-10\", \"time\": \"13:14:58\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 100.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-11\", \"time\": \"13:14:58\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 400.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-22\", \"time\": \"00:46:48\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 50.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2020-12-24\", \"time\": \"00:46:48\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 50.00 (external)\", \"status\": \"approved\"}, {\"date\": \"2021-02-07\", \"time\": \"00:46:48\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 61.82 (internal)\", \"status\": \"approved\"}, {\"date\": \"2021-03-30\", \"time\": \"01:46:48\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 129.23 (internal)\", \"status\": \"approved\"}, {\"date\": \"2021-05-23\", \"time\": \"14:14:58\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 113.82 (internal)\", \"status\": \"approved\"}, {\"date\": \"2021-08-20\", \"time\": \"14:14:58\", \"operation\": \"DEPOSIT\", \"description\": \"user deposited amount: 1109.65 (internal)\", \"status\": \"approved\"}]")

    def test_get_withdraws_mutation_1(self):
        task = transaction_service.get_withdraws.s(
            '6017edf6eec798982293a943', 10, 0, 'date_added', 'desc', None, None, None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 0, \"total_pages\": 0, \"current_page\": 0, \"content\": []}")

    def test_get_deposits_mutation_4(self):
        task = transaction_service.get_deposits.s(
            '6017edf6eec798982293a943', 10, 0, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 10, \"total_pages\": 1, \"current_page\": 0, \"content\": [{\"_id\": \"611f9cc2eec798982293ada7\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"110965\", \"quantity_in_asset\": \"4438.60000\", \"quantity\": \"1109.65\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-20 14:14:58\", \"date_modified\": \"2021-08-20 14:16:18\"}, {\"_id\": \"60aa4742eec798982293adc3\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"11382\", \"quantity_in_asset\": \"910.56000\", \"quantity\": \"113.82\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-23 14:14:58\", \"date_modified\": \"2021-05-23 14:15:24\"}, {\"_id\": \"606266e8eec798982293ae43\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"12923\", \"quantity_in_asset\": \"904.61000\", \"quantity\": \"129.23\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-30 01:46:48\", \"date_modified\": \"2021-03-30 01:49:06\"}, {\"_id\": \"601f2a68eec798982293ae6d\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"6182\", \"quantity_in_asset\": \"556.38000\", \"quantity\": \"61.82\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-07 00:46:48\", \"date_modified\": \"2021-02-07 00:47:30\"}, {\"_id\": \"5fe3d6e8eec798982293aaa9\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"12.50000\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b0f5\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-24 00:46:48\", \"date_modified\": \"2020-12-24 00:47:58\"}, {\"_id\": \"5fe133e8eec798982293aaa1\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"50.00000\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b0e9\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-22 00:46:48\", \"date_modified\": \"2020-12-22 00:48:52\"}, {\"_id\": \"5fd362c2eec798982293aab1\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"40000\", \"quantity_in_asset\": \"1600.00000\", \"quantity\": \"400.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b0ca\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-11 13:14:58\", \"date_modified\": \"2020-12-11 13:17:26\"}, {\"_id\": \"5fd21142eec798982293aaad\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"12.50000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b0c7\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-10 13:14:58\", \"date_modified\": \"2020-12-10 13:18:16\"}, {\"_id\": \"5fcf6e42eec798982293aaa5\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"40000\", \"quantity_in_asset\": \"2000.00000\", \"quantity\": \"400.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b0bf\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-08 13:14:58\", \"date_modified\": \"2020-12-08 13:15:13\"}, {\"_id\": \"5fcccb42eec798982293aa9d\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"45000\", \"quantity_in_asset\": \"75.00000\", \"quantity\": \"450.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b0b5\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2020-12-06 13:14:58\", \"date_modified\": \"2020-12-06 13:17:16\"}]}")

    def test_get_withdrawable_amount_dump_mutation_4(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6017edf6eec798982293a943'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_user_deposit_amount_mutation_1(self):
        task = transaction_service.get_user_deposit_amount.s(
            user_id='6017edf6eec798982293a943'
        ).apply()
        self.assertEqual(task.result, {"_id": "", "deposit_amount": 1450.0})

    def test_get_user_withdraw_amount_mutation_0(self):
        task = transaction_service.get_user_withdraw_amount.s(
            user_id='6017edf6eec798982293a943'
        ).apply()
        self.assertEqual(task.result, {"withdrawal_amount": 0})

    def test_get_last_transaction_id_mutation_0(self):
        task = transaction_service.get_last_transaction_id.s(
            user_id='6017edf6eec798982293a943'
        ).apply()
        self.assertEqual(task.result, {"last_transaction": "-"})

    def test_get_withdrawal_bank_account_mutation_0(self):
        task = transaction_service.get_withdrawal_bank_account.s(
            user_id='6017edf6eec798982293a943'
        ).apply()
        self.assertEqual(task.result, {"bank_account": "Not registered"})

    def test_get_customer_withdrawal_snapshot_mutation_0(self):
        task = transaction_service.get_customer_withdrawal_snapshot.s(
            user_id='6017edf6eec798982293a943'
        ).apply()
        self.assertEqual(task.result, "[]")

    def test_get_withdrawable_amount_dump_mutation_5(self):
        task = transaction_service.get_withdrawable_amount_dump.s(
            '6017edf6eec798982293a943'
        ).apply()
        self.assertEqual(task.result, {"withdrawable_amount_dump": 0})

    def test_get_withdraws_mutation_2(self):
        task = transaction_service.get_withdraws.s(
            None, 20, 0, 'date_added', 'desc', None, None, None, 'ADMIN', None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 38, \"total_pages\": 2, \"current_page\": 0, \"content\": [{\"_id\": \"61c340a4eec798982293afb3\", \"user_id\": \"6017edf6eec798982293a950\", \"account_number\": \"NL98DEUK5386489867\", \"holder_name\": \"PLEUN LINDSEY SCHILT\", \"description\": \"RevenYOU withdrawal #de0a546b52f6117e3ffb3277eeea3940d61a76ba\", \"method\": \"ideal\", \"order_id\": \"d43fca8e18ffd1d74f8ab9493e7ba31730492c0b\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"48.84\", \"withdrawal_amount_fiat\": \"48.11\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4884\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-12-22 16:13:40\", \"date_modified\": \"2021-12-22 16:14:03\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61b75696eec798982293afb0\", \"user_id\": \"6017edf6eec798982293a95a\", \"account_number\": \"NL69UUAC1709197666\", \"holder_name\": \"LIAM LUCY KOK\", \"description\": \"RevenYOU withdrawal #526f09b5c178d21012604063e576265929aa4eaa\", \"method\": \"ideal\", \"order_id\": \"a6667bf41608863e5b4387f940787935a12451f3\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"177.43\", \"withdrawal_amount_fiat\": \"174.77\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"17743\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-12-13 15:20:06\", \"date_modified\": \"2021-12-13 15:23:04\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61ab6df8eec798982293af0e\", \"user_id\": \"6017edf6eec798982293a94f\", \"account_number\": \"NL62VDDV3532731299\", \"holder_name\": \"SAAR WOUTER VAN ROSSUM\", \"description\": \"RevenYOU withdrawal #58a792f133b44305bfe9c34aa3e2ad1117565019\", \"method\": \"ideal\", \"order_id\": \"73f2d9b406a7bd50672c23275c3864f5aab966a4\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"315.64\", \"withdrawal_amount_fiat\": \"310.91\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"31564\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-12-04 14:32:40\", \"date_modified\": \"2021-12-04 14:33:26\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"619f3d78eec798982293afd6\", \"user_id\": \"6017edf6eec798982293a95c\", \"account_number\": \"NL74EEVN2039988585\", \"holder_name\": \"BASTIAAN MEHMET VAN DER STAEL\", \"description\": \"RevenYOU withdrawal #a738e0d923095f51e7030ae3d47d03261e8644e8\", \"method\": \"ideal\", \"order_id\": \"8d6399869c6e70e6248d98f77b94b029c04f82aa\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"50.80\", \"withdrawal_amount_fiat\": \"50.04\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"5080\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-11-25 08:38:32\", \"date_modified\": \"2021-11-25 08:40:20\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6195dadceec798982293ae3c\", \"user_id\": \"6017edf6eec798982293a945\", \"account_number\": \"NL74KJKY8568767056\", \"holder_name\": \"SILKE LUCY VAN VENROOY\", \"description\": \"RevenYOU withdrawal #6ea3e2f480256f1982e7147310cbd3126c603571\", \"method\": \"ideal\", \"order_id\": \"bf9d67d070b10f74e60977f940ed6929c5431a1b\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"101.14\", \"withdrawal_amount_fiat\": \"99.62\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"10114\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-11-18 05:47:24\", \"date_modified\": \"2021-11-18 05:48:54\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6184d436eec798982293ade1\", \"user_id\": \"6017edf6eec798982293a946\", \"account_number\": \"NL34XHFO8040139641\", \"holder_name\": \"ANGELINA TYCHO SPRUIT\", \"description\": \"RevenYOU withdrawal #8acf95e1dc8e98f3f689cb7dde97ae4a6eb4c574\", \"method\": \"ideal\", \"order_id\": \"956a13ab3439f718a863cb8cf92b5a14fd4b6274\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"1957.77\", \"withdrawal_amount_fiat\": \"1928.40\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"195777\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-11-05 07:50:30\", \"date_modified\": \"2021-11-05 07:51:43\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"617426a4eec798982293af8b\", \"user_id\": \"6017edf6eec798982293a950\", \"account_number\": \"NL29RLZA6191879655\", \"holder_name\": \"PLEUN LINDSEY SCHILT\", \"description\": \"RevenYOU withdrawal #62dc66a4020c1ffaafca64b1c436ba0596c4a760\", \"method\": \"ideal\", \"order_id\": \"29f4d38d7136bfa0f00effda25338b451d43b82f\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"43.24\", \"withdrawal_amount_fiat\": \"42.59\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4324\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-23 17:13:40\", \"date_modified\": \"2021-10-23 17:13:52\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61701a78eec798982293aef5\", \"user_id\": \"6017edf6eec798982293a94f\", \"account_number\": \"NL88NHRH5263732282\", \"holder_name\": \"SAAR WOUTER VAN ROSSUM\", \"description\": \"RevenYOU withdrawal #cc691a89e9853723f89965cf9d1bc81ae4adef75\", \"method\": \"ideal\", \"order_id\": \"c1b139376805352b9d9b3c001787265f0bfa69a9\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"3154.50\", \"withdrawal_amount_fiat\": \"3107.18\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"315450\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-20 15:32:40\", \"date_modified\": \"2021-10-20 15:33:02\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"616fd2c4eec798982293b018\", \"user_id\": \"6017edf6eec798982293a959\", \"account_number\": \"NL43MGVX5393717461\", \"holder_name\": \"SUUS YFKE MEERES\", \"description\": \"RevenYOU withdrawal #78792efa55aa572082e652e1e19628de71ee4a7e\", \"method\": \"ideal\", \"order_id\": \"ed0e15efe966b7678e8cfe9718a3d8d2e79929f1\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"437.30\", \"withdrawal_amount_fiat\": \"430.74\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"43730\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-20 10:26:44\", \"date_modified\": \"2021-10-20 10:30:03\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6168c168eec798982293ae94\", \"user_id\": \"6017edf6eec798982293a941\", \"account_number\": \"NL07YNQK9284767927\", \"holder_name\": \"WOUT JORN KELTENIE\", \"description\": \"RevenYOU withdrawal #739e32e2e68149bc0feecd986d730adac28d95ec\", \"method\": \"ideal\", \"order_id\": \"3b727d09a05106cc5756d241bc75a9b792cabb7e\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"6929.95\", \"withdrawal_amount_fiat\": \"6826.00\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"692995\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-15 01:46:48\", \"date_modified\": \"2021-10-15 01:47:21\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6163b5bbeec798982293b078\", \"user_id\": \"6017edf6eec798982293a962\", \"account_number\": \"NL65ESVS1466090946\", \"holder_name\": \"NIKKI SEM FRESHOUR\", \"description\": \"RevenYOU withdrawal #35922a7fea004b282f67edd670e90a11567e1fec\", \"method\": \"ideal\", \"order_id\": \"2cbaa0f23896b4d6503605232a9e476c2892eb42\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"43.31\", \"withdrawal_amount_fiat\": \"42.66\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4331\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-11 05:55:39\", \"date_modified\": \"2021-10-11 05:57:29\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6160d868eec798982293ae73\", \"user_id\": \"6017edf6eec798982293a946\", \"account_number\": \"NL89LZDN4971162186\", \"holder_name\": \"ANGELINA TYCHO SPRUIT\", \"description\": \"RevenYOU withdrawal #c11ea3b3cd9964c936c26e1925b7c682fae5e1ec\", \"method\": \"ideal\", \"order_id\": \"34fe6872366687a0910392f533ed901f92b2c3e3\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"33.56\", \"withdrawal_amount_fiat\": \"33.06\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"3356\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-09 01:46:48\", \"date_modified\": \"2021-10-09 01:48:12\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"614b4824eec798982293afa8\", \"user_id\": \"6017edf6eec798982293a950\", \"account_number\": \"NL50VIIW1449482709\", \"holder_name\": \"PLEUN LINDSEY SCHILT\", \"description\": \"RevenYOU withdrawal #953d8db197fcef354509bfbe540be206ebb93d9d\", \"method\": \"ideal\", \"order_id\": \"27361b58961c249169c9f2ca645881f385070061\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"98.54\", \"withdrawal_amount_fiat\": \"97.06\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"9854\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-09-22 17:13:40\", \"date_modified\": \"2021-09-22 17:16:16\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"613fe2e8eec798982293aeac\", \"user_id\": \"6017edf6eec798982293a945\", \"account_number\": \"NL38SDNR7517431958\", \"holder_name\": \"SILKE LUCY VAN VENROOY\", \"description\": \"RevenYOU withdrawal #0f950f219f183d4597e3a0de0f490466f1c59620\", \"method\": \"ideal\", \"order_id\": \"e706118114b796e2e6cade0958400981715c37f3\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"10903.94\", \"withdrawal_amount_fiat\": \"10740.38\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"1090394\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-09-14 01:46:48\", \"date_modified\": \"2021-09-14 01:49:28\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"613d865ceec798982293ae4f\", \"user_id\": \"6017edf6eec798982293a945\", \"account_number\": \"NL65ULRE6897309391\", \"holder_name\": \"SILKE LUCY VAN VENROOY\", \"description\": \"RevenYOU withdrawal #b94a0c0c51ef7eba4983aae0420462b3710febdd\", \"method\": \"ideal\", \"order_id\": \"aa005918795a40e51679d5fafee4f4a199084e74\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"496.93\", \"withdrawal_amount_fiat\": \"489.48\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"49693\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-09-12 06:47:24\", \"date_modified\": \"2021-09-12 06:48:35\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6128a78aeec798982293ad64\", \"user_id\": \"6017edf6eec798982293a93a\", \"account_number\": \"NL30QLHE3677434181\", \"holder_name\": \"BRAM LUNA DE BACKER\", \"description\": \"RevenYOU withdrawal #b5e66bc65a997d19e9a8e0fd10b741ef21e00ca4\", \"method\": \"ideal\", \"order_id\": \"9531f4528430436039cfe3373f2501d8ebfa3d8f\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"2421.32\", \"withdrawal_amount_fiat\": \"2385.00\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"242132\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-08-27 10:51:22\", \"date_modified\": \"2021-08-27 10:51:51\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6112b48eeec798982293ae67\", \"user_id\": \"6017edf6eec798982293a94c\", \"account_number\": \"NL86EXZD6805619865\", \"holder_name\": \"NOORTJE NOA MOLEGRAAF\", \"description\": \"RevenYOU withdrawal #15a50b7644433a37c8653473b4b4d6cc7a6ba5e3\", \"method\": \"ideal\", \"order_id\": \"6c4382a5478808e906b1af3e776ff638875803c2\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"1447.54\", \"withdrawal_amount_fiat\": \"1425.83\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"144754\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-08-10 19:17:02\", \"date_modified\": \"2021-08-10 19:17:55\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60f22b8beec798982293b07b\", \"user_id\": \"6017edf6eec798982293a963\", \"account_number\": \"NL19EYUN3173676453\", \"holder_name\": \"LIAM OLAF HOEKSTRA\", \"description\": \"RevenYOU withdrawal #5907091447ac9b2fdf3c75e772b5a78fbb7535d8\", \"method\": \"ideal\", \"order_id\": \"6f8a0fe7f8c632726b1f0cb2a6737eb1c60651c1\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"41.36\", \"withdrawal_amount_fiat\": \"40.74\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4136\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-07-17 02:59:55\", \"date_modified\": \"2021-07-17 03:02:07\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60dc308aeec798982293ad9a\", \"user_id\": \"6017edf6eec798982293a93b\", \"account_number\": \"NL30BOZO7219046346\", \"holder_name\": \"MIKE CASPER SCHOLTEN\", \"description\": \"RevenYOU withdrawal #9ac3f3d3431adbde19155bc25ff238b4884f11a6\", \"method\": \"ideal\", \"order_id\": \"4072bc462a66a6e067933692ed86ad07239b8361\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"25.66\", \"withdrawal_amount_fiat\": \"25.28\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"2566\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-06-30 10:51:22\", \"date_modified\": \"2021-06-30 10:53:30\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60d74424eec798982293aee4\", \"user_id\": \"6017edf6eec798982293a950\", \"account_number\": \"NL57GLJR0666363167\", \"holder_name\": \"PLEUN LINDSEY SCHILT\", \"description\": \"RevenYOU withdrawal #9ce395f55bb099bb96cb1ba03303a9b746752b92\", \"method\": \"ideal\", \"order_id\": \"5fc7b84c8b90eeb62706290d980087f763426843\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"272.95\", \"withdrawal_amount_fiat\": \"268.86\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"27295\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-06-26 17:13:40\", \"date_modified\": \"2021-06-26 17:16:37\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}]}")

    def test_get_withdraws_mutation_3(self):
        task = transaction_service.get_withdraws.s(
            None, 20, 0, 'date_added', 'desc', None, None, None, 'ADMIN', None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 38, \"total_pages\": 2, \"current_page\": 0, \"content\": [{\"_id\": \"61c340a4eec798982293afb3\", \"user_id\": \"6017edf6eec798982293a950\", \"account_number\": \"NL98DEUK5386489867\", \"holder_name\": \"PLEUN LINDSEY SCHILT\", \"description\": \"RevenYOU withdrawal #de0a546b52f6117e3ffb3277eeea3940d61a76ba\", \"method\": \"ideal\", \"order_id\": \"d43fca8e18ffd1d74f8ab9493e7ba31730492c0b\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"48.84\", \"withdrawal_amount_fiat\": \"48.11\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4884\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-12-22 16:13:40\", \"date_modified\": \"2021-12-22 16:14:03\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61b75696eec798982293afb0\", \"user_id\": \"6017edf6eec798982293a95a\", \"account_number\": \"NL69UUAC1709197666\", \"holder_name\": \"LIAM LUCY KOK\", \"description\": \"RevenYOU withdrawal #526f09b5c178d21012604063e576265929aa4eaa\", \"method\": \"ideal\", \"order_id\": \"a6667bf41608863e5b4387f940787935a12451f3\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"177.43\", \"withdrawal_amount_fiat\": \"174.77\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"17743\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-12-13 15:20:06\", \"date_modified\": \"2021-12-13 15:23:04\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61ab6df8eec798982293af0e\", \"user_id\": \"6017edf6eec798982293a94f\", \"account_number\": \"NL62VDDV3532731299\", \"holder_name\": \"SAAR WOUTER VAN ROSSUM\", \"description\": \"RevenYOU withdrawal #58a792f133b44305bfe9c34aa3e2ad1117565019\", \"method\": \"ideal\", \"order_id\": \"73f2d9b406a7bd50672c23275c3864f5aab966a4\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"315.64\", \"withdrawal_amount_fiat\": \"310.91\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"31564\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-12-04 14:32:40\", \"date_modified\": \"2021-12-04 14:33:26\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"619f3d78eec798982293afd6\", \"user_id\": \"6017edf6eec798982293a95c\", \"account_number\": \"NL74EEVN2039988585\", \"holder_name\": \"BASTIAAN MEHMET VAN DER STAEL\", \"description\": \"RevenYOU withdrawal #a738e0d923095f51e7030ae3d47d03261e8644e8\", \"method\": \"ideal\", \"order_id\": \"8d6399869c6e70e6248d98f77b94b029c04f82aa\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"50.80\", \"withdrawal_amount_fiat\": \"50.04\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"5080\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-11-25 08:38:32\", \"date_modified\": \"2021-11-25 08:40:20\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6195dadceec798982293ae3c\", \"user_id\": \"6017edf6eec798982293a945\", \"account_number\": \"NL74KJKY8568767056\", \"holder_name\": \"SILKE LUCY VAN VENROOY\", \"description\": \"RevenYOU withdrawal #6ea3e2f480256f1982e7147310cbd3126c603571\", \"method\": \"ideal\", \"order_id\": \"bf9d67d070b10f74e60977f940ed6929c5431a1b\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"101.14\", \"withdrawal_amount_fiat\": \"99.62\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"10114\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-11-18 05:47:24\", \"date_modified\": \"2021-11-18 05:48:54\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6184d436eec798982293ade1\", \"user_id\": \"6017edf6eec798982293a946\", \"account_number\": \"NL34XHFO8040139641\", \"holder_name\": \"ANGELINA TYCHO SPRUIT\", \"description\": \"RevenYOU withdrawal #8acf95e1dc8e98f3f689cb7dde97ae4a6eb4c574\", \"method\": \"ideal\", \"order_id\": \"956a13ab3439f718a863cb8cf92b5a14fd4b6274\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"1957.77\", \"withdrawal_amount_fiat\": \"1928.40\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"195777\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-11-05 07:50:30\", \"date_modified\": \"2021-11-05 07:51:43\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"617426a4eec798982293af8b\", \"user_id\": \"6017edf6eec798982293a950\", \"account_number\": \"NL29RLZA6191879655\", \"holder_name\": \"PLEUN LINDSEY SCHILT\", \"description\": \"RevenYOU withdrawal #62dc66a4020c1ffaafca64b1c436ba0596c4a760\", \"method\": \"ideal\", \"order_id\": \"29f4d38d7136bfa0f00effda25338b451d43b82f\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"43.24\", \"withdrawal_amount_fiat\": \"42.59\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4324\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-23 17:13:40\", \"date_modified\": \"2021-10-23 17:13:52\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"61701a78eec798982293aef5\", \"user_id\": \"6017edf6eec798982293a94f\", \"account_number\": \"NL88NHRH5263732282\", \"holder_name\": \"SAAR WOUTER VAN ROSSUM\", \"description\": \"RevenYOU withdrawal #cc691a89e9853723f89965cf9d1bc81ae4adef75\", \"method\": \"ideal\", \"order_id\": \"c1b139376805352b9d9b3c001787265f0bfa69a9\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"3154.50\", \"withdrawal_amount_fiat\": \"3107.18\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"315450\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-20 15:32:40\", \"date_modified\": \"2021-10-20 15:33:02\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"616fd2c4eec798982293b018\", \"user_id\": \"6017edf6eec798982293a959\", \"account_number\": \"NL43MGVX5393717461\", \"holder_name\": \"SUUS YFKE MEERES\", \"description\": \"RevenYOU withdrawal #78792efa55aa572082e652e1e19628de71ee4a7e\", \"method\": \"ideal\", \"order_id\": \"ed0e15efe966b7678e8cfe9718a3d8d2e79929f1\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"437.30\", \"withdrawal_amount_fiat\": \"430.74\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"43730\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-20 10:26:44\", \"date_modified\": \"2021-10-20 10:30:03\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6168c168eec798982293ae94\", \"user_id\": \"6017edf6eec798982293a941\", \"account_number\": \"NL07YNQK9284767927\", \"holder_name\": \"WOUT JORN KELTENIE\", \"description\": \"RevenYOU withdrawal #739e32e2e68149bc0feecd986d730adac28d95ec\", \"method\": \"ideal\", \"order_id\": \"3b727d09a05106cc5756d241bc75a9b792cabb7e\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"6929.95\", \"withdrawal_amount_fiat\": \"6826.00\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"692995\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-15 01:46:48\", \"date_modified\": \"2021-10-15 01:47:21\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6163b5bbeec798982293b078\", \"user_id\": \"6017edf6eec798982293a962\", \"account_number\": \"NL65ESVS1466090946\", \"holder_name\": \"NIKKI SEM FRESHOUR\", \"description\": \"RevenYOU withdrawal #35922a7fea004b282f67edd670e90a11567e1fec\", \"method\": \"ideal\", \"order_id\": \"2cbaa0f23896b4d6503605232a9e476c2892eb42\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"43.31\", \"withdrawal_amount_fiat\": \"42.66\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4331\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-11 05:55:39\", \"date_modified\": \"2021-10-11 05:57:29\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6160d868eec798982293ae73\", \"user_id\": \"6017edf6eec798982293a946\", \"account_number\": \"NL89LZDN4971162186\", \"holder_name\": \"ANGELINA TYCHO SPRUIT\", \"description\": \"RevenYOU withdrawal #c11ea3b3cd9964c936c26e1925b7c682fae5e1ec\", \"method\": \"ideal\", \"order_id\": \"34fe6872366687a0910392f533ed901f92b2c3e3\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"33.56\", \"withdrawal_amount_fiat\": \"33.06\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"3356\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-10-09 01:46:48\", \"date_modified\": \"2021-10-09 01:48:12\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"614b4824eec798982293afa8\", \"user_id\": \"6017edf6eec798982293a950\", \"account_number\": \"NL50VIIW1449482709\", \"holder_name\": \"PLEUN LINDSEY SCHILT\", \"description\": \"RevenYOU withdrawal #953d8db197fcef354509bfbe540be206ebb93d9d\", \"method\": \"ideal\", \"order_id\": \"27361b58961c249169c9f2ca645881f385070061\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"98.54\", \"withdrawal_amount_fiat\": \"97.06\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"9854\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-09-22 17:13:40\", \"date_modified\": \"2021-09-22 17:16:16\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"613fe2e8eec798982293aeac\", \"user_id\": \"6017edf6eec798982293a945\", \"account_number\": \"NL38SDNR7517431958\", \"holder_name\": \"SILKE LUCY VAN VENROOY\", \"description\": \"RevenYOU withdrawal #0f950f219f183d4597e3a0de0f490466f1c59620\", \"method\": \"ideal\", \"order_id\": \"e706118114b796e2e6cade0958400981715c37f3\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"10903.94\", \"withdrawal_amount_fiat\": \"10740.38\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"1090394\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-09-14 01:46:48\", \"date_modified\": \"2021-09-14 01:49:28\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"613d865ceec798982293ae4f\", \"user_id\": \"6017edf6eec798982293a945\", \"account_number\": \"NL65ULRE6897309391\", \"holder_name\": \"SILKE LUCY VAN VENROOY\", \"description\": \"RevenYOU withdrawal #b94a0c0c51ef7eba4983aae0420462b3710febdd\", \"method\": \"ideal\", \"order_id\": \"aa005918795a40e51679d5fafee4f4a199084e74\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"496.93\", \"withdrawal_amount_fiat\": \"489.48\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"49693\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-09-12 06:47:24\", \"date_modified\": \"2021-09-12 06:48:35\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6128a78aeec798982293ad64\", \"user_id\": \"6017edf6eec798982293a93a\", \"account_number\": \"NL30QLHE3677434181\", \"holder_name\": \"BRAM LUNA DE BACKER\", \"description\": \"RevenYOU withdrawal #b5e66bc65a997d19e9a8e0fd10b741ef21e00ca4\", \"method\": \"ideal\", \"order_id\": \"9531f4528430436039cfe3373f2501d8ebfa3d8f\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"2421.32\", \"withdrawal_amount_fiat\": \"2385.00\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"242132\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-08-27 10:51:22\", \"date_modified\": \"2021-08-27 10:51:51\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"6112b48eeec798982293ae67\", \"user_id\": \"6017edf6eec798982293a94c\", \"account_number\": \"NL86EXZD6805619865\", \"holder_name\": \"NOORTJE NOA MOLEGRAAF\", \"description\": \"RevenYOU withdrawal #15a50b7644433a37c8653473b4b4d6cc7a6ba5e3\", \"method\": \"ideal\", \"order_id\": \"6c4382a5478808e906b1af3e776ff638875803c2\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"1447.54\", \"withdrawal_amount_fiat\": \"1425.83\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"144754\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-08-10 19:17:02\", \"date_modified\": \"2021-08-10 19:17:55\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60f22b8beec798982293b07b\", \"user_id\": \"6017edf6eec798982293a963\", \"account_number\": \"NL19EYUN3173676453\", \"holder_name\": \"LIAM OLAF HOEKSTRA\", \"description\": \"RevenYOU withdrawal #5907091447ac9b2fdf3c75e772b5a78fbb7535d8\", \"method\": \"ideal\", \"order_id\": \"6f8a0fe7f8c632726b1f0cb2a6737eb1c60651c1\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"41.36\", \"withdrawal_amount_fiat\": \"40.74\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"4136\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-07-17 02:59:55\", \"date_modified\": \"2021-07-17 03:02:07\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60dc308aeec798982293ad9a\", \"user_id\": \"6017edf6eec798982293a93b\", \"account_number\": \"NL30BOZO7219046346\", \"holder_name\": \"MIKE CASPER SCHOLTEN\", \"description\": \"RevenYOU withdrawal #9ac3f3d3431adbde19155bc25ff238b4884f11a6\", \"method\": \"ideal\", \"order_id\": \"4072bc462a66a6e067933692ed86ad07239b8361\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"25.66\", \"withdrawal_amount_fiat\": \"25.28\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"2566\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-06-30 10:51:22\", \"date_modified\": \"2021-06-30 10:53:30\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}, {\"_id\": \"60d74424eec798982293aee4\", \"user_id\": \"6017edf6eec798982293a950\", \"account_number\": \"NL57GLJR0666363167\", \"holder_name\": \"PLEUN LINDSEY SCHILT\", \"description\": \"RevenYOU withdrawal #9ce395f55bb099bb96cb1ba03303a9b746752b92\", \"method\": \"ideal\", \"order_id\": \"5fc7b84c8b90eeb62706290d980087f763426843\", \"exchange\": \"binance\", \"quantity_in_fiat\": \"272.95\", \"withdrawal_amount_fiat\": \"268.86\", \"fiat\": \"EUR\", \"quantity_in_cents\": \"27295\", \"fee_percentage\": \"1.50\", \"withdrawal_status\": \"approved\", \"trans_direction\": \"batched\", \"comment\": \"\", \"confirmed_by_user\": true, \"cleared\": true, \"date_added\": \"2021-06-26 17:13:40\", \"date_modified\": \"2021-06-26 17:16:37\", \"ip\": \"192.168.2.55\", \"dump_withdrawal\": [[{\"amount_fiat\": \"151.18\", \"orginal_amount_fiat\": \"151.18\", \"withdrawal_amount\": \"162.13481737\", \"exchange\": \"binance\", \"amount\": \"163.92\", \"after_withdrawal\": \"-1.78518263\", \"asset\": \"tusd\", \"delta\": \"1.78518263\"}]]}]}")

    def test_any_failed_withdrawal_mutation_0(self):
        task = transaction_service.any_failed_withdrawal.s(
            
        ).apply()
        self.assertEqual(task.result, {"any": False})

    def test_any_failed_withdrawal_mutation_1(self):
        task = transaction_service.any_failed_withdrawal.s(
            
        ).apply()
        self.assertEqual(task.result, {"any": False})

    def test_get_withdraw_mutation_0(self):
        task = transaction_service.get_withdraw.s(
            '614b4824eec798982293afa8'
        ).apply()
        self.assertEqual(task.result, {"_id": "614b4824eec798982293afa8", "user_id": "6017edf6eec798982293a950", "account_number": "NL50VIIW1449482709", "holder_name": "PLEUN LINDSEY SCHILT", "description": "RevenYOU withdrawal #953d8db197fcef354509bfbe540be206ebb93d9d", "method": "ideal", "order_id": "27361b58961c249169c9f2ca645881f385070061", "exchange": "binance", "quantity_in_fiat": "98.54", "withdrawal_amount_fiat": "97.06", "fiat": "EUR", "quantity_in_cents": "9854", "fee_percentage": "1.50", "withdrawal_status": "approved", "trans_direction": "batched", "comment": "", "confirmed_by_user": True, "cleared": True, "date_added": "2021-09-22 17:13:40", "date_modified": "2021-09-22 17:16:16", "ip": "192.168.2.55", "dump_withdrawal": [[{"amount_fiat": "151.18", "orginal_amount_fiat": "151.18", "withdrawal_amount": "162.13481737", "exchange": "binance", "amount": "163.92", "after_withdrawal": "-1.78518263", "asset": "tusd", "delta": "1.78518263"}]]})

    def test_get_deposits_mutation_5(self):
        task = transaction_service.get_deposits.s(
            None, 20, 2, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 339, \"total_pages\": 17, \"current_page\": 2, \"content\": [{\"_id\": \"6107ac44eec798982293afc8\", \"user_id\": \"6017edf6eec798982293a959\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"31942\", \"quantity_in_asset\": \"45.63143\", \"quantity\": \"319.42\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-02 10:26:44\", \"date_modified\": \"2021-08-02 10:29:09\"}, {\"_id\": \"6107a0f8eec798982293afdf\", \"user_id\": \"6017edf6eec798982293a95c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"22242\", \"quantity_in_asset\": \"1334.52000\", \"quantity\": \"222.42\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-02 09:38:32\", \"date_modified\": \"2021-08-02 09:40:49\"}, {\"_id\": \"610778dceec798982293adcc\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"73162\", \"quantity_in_asset\": \"2194.86000\", \"quantity\": \"731.62\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-08-02 06:47:24\", \"date_modified\": \"2021-08-02 06:48:52\"}, {\"_id\": \"61025796eec798982293af94\", \"user_id\": \"6017edf6eec798982293a954\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"26235\", \"quantity_in_asset\": \"1311.75000\", \"quantity\": \"262.35\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-29 09:24:06\", \"date_modified\": \"2021-07-29 09:25:18\"}, {\"_id\": \"61014be3eec798982293ae8c\", \"user_id\": \"6017edf6eec798982293a94b\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"83302\", \"quantity_in_asset\": \"833.02000\", \"quantity\": \"833.02\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-28 14:21:55\", \"date_modified\": \"2021-07-28 14:23:20\"}, {\"_id\": \"60fdae0ceec798982293add4\", \"user_id\": \"6017edf6eec798982293a941\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"5510\", \"quantity_in_asset\": \"330.60000\", \"quantity\": \"55.10\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-25 20:31:40\", \"date_modified\": \"2021-07-25 20:32:12\"}, {\"_id\": \"60f9e321eec798982293ad86\", \"user_id\": \"6017edf6eec798982293a937\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"239414\", \"quantity_in_asset\": \"798.04667\", \"quantity\": \"2394.14\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-22 23:29:05\", \"date_modified\": \"2021-07-22 23:30:47\"}, {\"_id\": \"60f19596eec798982293afbc\", \"user_id\": \"6017edf6eec798982293a95a\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"11056\", \"quantity_in_asset\": \"110.56000\", \"quantity\": \"110.56\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-16 16:20:06\", \"date_modified\": \"2021-07-16 16:22:21\"}, {\"_id\": \"60f169b3eec798982293ae9d\", \"user_id\": \"6017edf6eec798982293a94d\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"226453\", \"quantity_in_asset\": \"18116.24000\", \"quantity\": \"2264.53\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-16 13:12:51\", \"date_modified\": \"2021-07-16 13:13:18\"}, {\"_id\": \"60ed05aeeec798982293af45\", \"user_id\": \"6017edf6eec798982293a955\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"186039\", \"quantity_in_asset\": \"1860.39000\", \"quantity\": \"1860.39\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-13 05:17:02\", \"date_modified\": \"2021-07-13 05:17:54\"}, {\"_id\": \"60e39550eec798982293af21\", \"user_id\": \"6017edf6eec798982293a953\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"31912\", \"quantity_in_asset\": \"957.36000\", \"quantity\": \"319.12\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-06 01:27:12\", \"date_modified\": \"2021-07-06 01:30:28\"}, {\"_id\": \"60e2c80aeec798982293adb8\", \"user_id\": \"6017edf6eec798982293a93a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"21274\", \"quantity_in_asset\": \"638.22000\", \"quantity\": \"212.74\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-05 10:51:22\", \"date_modified\": \"2021-07-05 10:54:13\"}, {\"_id\": \"60e2c80aeec798982293ae05\", \"user_id\": \"6017edf6eec798982293a936\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"11384\", \"quantity_in_asset\": \"796.88000\", \"quantity\": \"113.84\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-05 10:51:22\", \"date_modified\": \"2021-07-05 10:51:39\"}, {\"_id\": \"60e236a3eec798982293b056\", \"user_id\": \"6017edf6eec798982293a95e\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"19624\", \"quantity_in_asset\": \"1766.16000\", \"quantity\": \"196.24\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-05 00:30:59\", \"date_modified\": \"2021-07-05 00:34:17\"}, {\"_id\": \"60e16216eec798982293af85\", \"user_id\": \"6017edf6eec798982293a954\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"9186\", \"quantity_in_asset\": \"91.86000\", \"quantity\": \"91.86\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-04 09:24:06\", \"date_modified\": \"2021-07-04 09:26:31\"}, {\"_id\": \"60e0250aeec798982293ad24\", \"user_id\": \"6017edf6eec798982293a938\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"6715\", \"quantity_in_asset\": \"9.59286\", \"quantity\": \"67.15\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-03 10:51:22\", \"date_modified\": \"2021-07-03 10:53:48\"}, {\"_id\": \"60df93a3eec798982293b050\", \"user_id\": \"6017edf6eec798982293a95e\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"51968\", \"quantity_in_asset\": \"57.74222\", \"quantity\": \"519.68\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-07-03 00:30:59\", \"date_modified\": \"2021-07-03 00:31:59\"}, {\"_id\": \"60dce221eec798982293ad35\", \"user_id\": \"6017edf6eec798982293a937\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"7385\", \"quantity_in_asset\": \"147.70000\", \"quantity\": \"73.85\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-30 23:29:05\", \"date_modified\": \"2021-06-30 23:31:34\"}, {\"_id\": \"60dce221eec798982293ad3b\", \"user_id\": \"6017edf6eec798982293a93a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"5021\", \"quantity_in_asset\": \"200.84000\", \"quantity\": \"50.21\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-30 23:29:05\", \"date_modified\": \"2021-06-30 23:30:29\"}, {\"_id\": \"60dc308aeec798982293ad4c\", \"user_id\": \"6017edf6eec798982293a937\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"23032\", \"quantity_in_asset\": \"921.28000\", \"quantity\": \"230.32\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-30 10:51:22\", \"date_modified\": \"2021-06-30 10:51:53\"}]}")

    def test_get_deposits_mutation_6(self):
        task = transaction_service.get_deposits.s(
            None, 20, 3, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 339, \"total_pages\": 17, \"current_page\": 3, \"content\": [{\"_id\": \"60dbf75ceec798982293addb\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"37313\", \"quantity_in_asset\": \"3358.17000\", \"quantity\": \"373.13\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-30 06:47:24\", \"date_modified\": \"2021-06-30 06:49:51\"}, {\"_id\": \"60d6e4c4eec798982293b029\", \"user_id\": \"6017edf6eec798982293a959\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"71547\", \"quantity_in_asset\": \"119.24500\", \"quantity\": \"715.47\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-26 10:26:44\", \"date_modified\": \"2021-06-26 10:30:01\"}, {\"_id\": \"60d66650eec798982293af17\", \"user_id\": \"6017edf6eec798982293a953\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"233111\", \"quantity_in_asset\": \"291.38875\", \"quantity\": \"2331.11\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-26 01:27:12\", \"date_modified\": \"2021-06-26 01:28:54\"}, {\"_id\": \"60d51968eec798982293ae2a\", \"user_id\": \"6017edf6eec798982293a946\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"51849\", \"quantity_in_asset\": \"172.83000\", \"quantity\": \"518.49\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-25 01:46:48\", \"date_modified\": \"2021-06-25 01:48:16\"}, {\"_id\": \"60d4d4dbeec798982293adad\", \"user_id\": \"6017edf6eec798982293a944\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"8874\", \"quantity_in_asset\": \"88.74000\", \"quantity\": \"88.74\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-24 20:54:19\", \"date_modified\": \"2021-06-24 20:55:44\"}, {\"_id\": \"60d1117aeec798982293af8e\", \"user_id\": \"6017edf6eec798982293a957\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"9804\", \"quantity_in_asset\": \"32.68000\", \"quantity\": \"98.04\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-22 00:23:54\", \"date_modified\": \"2021-06-22 00:26:28\"}, {\"_id\": \"60ce81e8eec798982293aec7\", \"user_id\": \"6017edf6eec798982293a936\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"6809\", \"quantity_in_asset\": \"544.72000\", \"quantity\": \"68.09\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-20 01:46:48\", \"date_modified\": \"2021-06-20 01:49:27\"}, {\"_id\": \"60cb4ef8eec798982293af00\", \"user_id\": \"6017edf6eec798982293a94f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"6946\", \"quantity_in_asset\": \"69.46000\", \"quantity\": \"69.46\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-17 15:32:40\", \"date_modified\": \"2021-06-17 15:35:10\"}, {\"_id\": \"60c1be16eec798982293af35\", \"user_id\": \"6017edf6eec798982293a954\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"8792\", \"quantity_in_asset\": \"29.30667\", \"quantity\": \"87.92\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-10 09:24:06\", \"date_modified\": \"2021-06-10 09:24:54\"}, {\"_id\": \"60bf60e3eec798982293ae52\", \"user_id\": \"6017edf6eec798982293a94b\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"665517\", \"quantity_in_asset\": \"6655.17000\", \"quantity\": \"6655.17\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-08 14:21:55\", \"date_modified\": \"2021-06-08 14:23:09\"}, {\"_id\": \"60be660ceec798982293ad9d\", \"user_id\": \"6017edf6eec798982293a941\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"21897\", \"quantity_in_asset\": \"72.99000\", \"quantity\": \"218.97\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-07 20:31:40\", \"date_modified\": \"2021-06-07 20:31:59\"}, {\"_id\": \"60ba9b21eec798982293adff\", \"user_id\": \"6017edf6eec798982293a936\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"14747\", \"quantity_in_asset\": \"16.38556\", \"quantity\": \"147.47\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-04 23:29:05\", \"date_modified\": \"2021-06-04 23:31:29\"}, {\"_id\": \"60b6c6e8eec798982293ae55\", \"user_id\": \"6017edf6eec798982293a936\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"6943\", \"quantity_in_asset\": \"11.57167\", \"quantity\": \"69.43\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-06-02 01:46:48\", \"date_modified\": \"2021-06-02 01:47:26\"}, {\"_id\": \"60b01bfaeec798982293af77\", \"user_id\": \"6017edf6eec798982293a957\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"14598\", \"quantity_in_asset\": \"36.49500\", \"quantity\": \"145.98\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-28 00:23:54\", \"date_modified\": \"2021-05-28 00:24:17\"}, {\"_id\": \"60af4c78eec798982293b046\", \"user_id\": \"6017edf6eec798982293a95c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"15765\", \"quantity_in_asset\": \"31.53000\", \"quantity\": \"157.65\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-27 09:38:32\", \"date_modified\": \"2021-05-27 09:38:58\"}, {\"_id\": \"60ae2d33eec798982293aea9\", \"user_id\": \"6017edf6eec798982293a94d\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"6047\", \"quantity_in_asset\": \"10.07833\", \"quantity\": \"60.47\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-26 13:12:51\", \"date_modified\": \"2021-05-26 13:15:48\"}, {\"_id\": \"60add2dceec798982293adf3\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"44212\", \"quantity_in_asset\": \"3094.84000\", \"quantity\": \"442.12\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-26 06:47:24\", \"date_modified\": \"2021-05-26 06:49:35\"}, {\"_id\": \"60aa4742eec798982293adc3\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"11382\", \"quantity_in_asset\": \"910.56000\", \"quantity\": \"113.82\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-23 14:14:58\", \"date_modified\": \"2021-05-23 14:15:24\"}, {\"_id\": \"60a7748aeec798982293ad43\", \"user_id\": \"6017edf6eec798982293a93a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"17782\", \"quantity_in_asset\": \"25.40286\", \"quantity\": \"177.82\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-21 10:51:22\", \"date_modified\": \"2021-05-21 10:52:27\"}, {\"_id\": \"60a7748aeec798982293ad52\", \"user_id\": \"6017edf6eec798982293a93a\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"8149\", \"quantity_in_asset\": \"40.74500\", \"quantity\": \"81.49\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-21 10:51:22\", \"date_modified\": \"2021-05-21 10:53:12\"}]}")

    def test_get_deposits_mutation_7(self):
        task = transaction_service.get_deposits.s(
            None, 20, 4, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 339, \"total_pages\": 17, \"current_page\": 4, \"content\": [{\"_id\": \"60a21a16eec798982293af61\", \"user_id\": \"6017edf6eec798982293a954\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"9222\", \"quantity_in_asset\": \"30.74000\", \"quantity\": \"92.22\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-17 09:24:06\", \"date_modified\": \"2021-05-17 09:24:31\"}, {\"_id\": \"609f525ceec798982293ae15\", \"user_id\": \"6017edf6eec798982293a945\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"833770\", \"quantity_in_asset\": \"1389.61667\", \"quantity\": \"8337.70\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-15 06:47:24\", \"date_modified\": \"2021-05-15 06:48:12\"}, {\"_id\": \"6097e478eec798982293aede\", \"user_id\": \"6017edf6eec798982293a94f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"174342\", \"quantity_in_asset\": \"8717.10000\", \"quantity\": \"1743.42\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-09 15:32:40\", \"date_modified\": \"2021-05-09 15:35:50\"}, {\"_id\": \"6095d168eec798982293ae24\", \"user_id\": \"6017edf6eec798982293a942\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"30807\", \"quantity_in_asset\": \"1540.35000\", \"quantity\": \"308.07\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-08 01:46:48\", \"date_modified\": \"2021-05-08 01:47:59\"}, {\"_id\": \"609407a4eec798982293af71\", \"user_id\": \"6017edf6eec798982293a950\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"6660\", \"quantity_in_asset\": \"133.20000\", \"quantity\": \"66.60\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-06 17:13:40\", \"date_modified\": \"2021-05-06 17:16:30\"}, {\"_id\": \"609053c2eec798982293aefa\", \"user_id\": \"6017edf6eec798982293a952\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"419345\", \"quantity_in_asset\": \"33547.60000\", \"quantity\": \"4193.45\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-03 21:49:22\", \"date_modified\": \"2021-05-03 21:50:01\"}, {\"_id\": \"608ffb78eec798982293af27\", \"user_id\": \"6017edf6eec798982293a94f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"31808\", \"quantity_in_asset\": \"318.08000\", \"quantity\": \"318.08\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-05-03 15:32:40\", \"date_modified\": \"2021-05-03 15:33:40\"}, {\"_id\": \"6086d8a4eec798982293af3d\", \"user_id\": \"6017edf6eec798982293a950\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"77740\", \"quantity_in_asset\": \"777.40000\", \"quantity\": \"777.40\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-04-26 17:13:40\", \"date_modified\": \"2021-04-26 17:15:45\"}, {\"_id\": \"60852d8aeec798982293ad73\", \"user_id\": \"6017edf6eec798982293a93b\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"11599\", \"quantity_in_asset\": \"927.92000\", \"quantity\": \"115.99\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-04-25 10:51:22\", \"date_modified\": \"2021-04-25 10:52:52\"}, {\"_id\": \"607f67e8eec798982293ae30\", \"user_id\": \"6017edf6eec798982293a947\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"19051\", \"quantity_in_asset\": \"571.53000\", \"quantity\": \"190.51\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-04-21 01:46:48\", \"date_modified\": \"2021-04-21 01:49:15\"}, {\"_id\": \"607991f8eec798982293aeb9\", \"user_id\": \"6017edf6eec798982293a94f\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"19024\", \"quantity_in_asset\": \"21.13778\", \"quantity\": \"190.24\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-04-16 15:32:40\", \"date_modified\": \"2021-04-16 15:35:10\"}, {\"_id\": \"60719863eec798982293adf9\", \"user_id\": \"6017edf6eec798982293a94b\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"33612\", \"quantity_in_asset\": \"1008.36000\", \"quantity\": \"336.12\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-04-10 14:21:55\", \"date_modified\": \"2021-04-10 14:22:36\"}, {\"_id\": \"606d728aeec798982293adc0\", \"user_id\": \"6017edf6eec798982293a936\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"50759\", \"quantity_in_asset\": \"56.39889\", \"quantity\": \"507.59\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"pending\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-04-07 10:51:22\", \"date_modified\": \"2021-04-07 10:53:19\"}, {\"_id\": \"60634024eec798982293af4f\", \"user_id\": \"6017edf6eec798982293a950\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"6964\", \"quantity_in_asset\": \"11.60667\", \"quantity\": \"69.64\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-30 17:13:40\", \"date_modified\": \"2021-03-30 17:16:54\"}, {\"_id\": \"606266e8eec798982293ae43\", \"user_id\": \"6017edf6eec798982293a943\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"12923\", \"quantity_in_asset\": \"904.61000\", \"quantity\": \"129.23\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-30 01:46:48\", \"date_modified\": \"2021-03-30 01:49:06\"}, {\"_id\": \"605d8f78eec798982293b00c\", \"user_id\": \"6017edf6eec798982293a95c\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"138091\", \"quantity_in_asset\": \"172.61375\", \"quantity\": \"1380.91\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-26 08:38:32\", \"date_modified\": \"2021-03-26 08:40:52\"}, {\"_id\": \"605b5724eec798982293b09a\", \"user_id\": \"6017edf6eec798982293a950\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"14346\", \"quantity_in_asset\": \"35.86500\", \"quantity\": \"143.46\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-24 16:13:40\", \"date_modified\": \"2021-03-24 16:13:55\"}, {\"_id\": \"605274a1eec798982293ad92\", \"user_id\": \"6017edf6eec798982293a93b\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"12213\", \"quantity_in_asset\": \"30.53250\", \"quantity\": \"122.13\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-17 22:29:05\", \"date_modified\": \"2021-03-17 22:32:11\"}, {\"_id\": \"6051bd44eec798982293afd0\", \"user_id\": \"6017edf6eec798982293a959\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"49126\", \"quantity_in_asset\": \"81.87667\", \"quantity\": \"491.26\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-17 09:26:44\", \"date_modified\": \"2021-03-17 09:27:15\"}, {\"_id\": \"604f79a4eec798982293af06\", \"user_id\": \"6017edf6eec798982293a950\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"10528\", \"quantity_in_asset\": \"315.84000\", \"quantity\": \"105.28\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-15 16:13:40\", \"date_modified\": \"2021-03-15 16:15:47\"}]}")

    def test_get_deposits_mutation_8(self):
        task = transaction_service.get_deposits.s(
            None, 20, 5, 'date_added', 'desc', None, None, None
        ).apply()
        self.assertEqual(task.result, "{\"total_elements\": 339, \"total_pages\": 17, \"current_page\": 5, \"content\": [{\"_id\": \"60439c24eec798982293aeed\", \"user_id\": \"6017edf6eec798982293a950\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"7354\", \"quantity_in_asset\": \"441.24000\", \"quantity\": \"73.54\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-06 16:13:40\", \"date_modified\": \"2021-03-06 16:15:54\"}, {\"_id\": \"603ef4afeec798982293ad1e\", \"user_id\": \"6017edf6eec798982293a965\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"16.66667\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b186\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-03 03:30:07\", \"date_modified\": \"2021-03-03 03:30:49\"}, {\"_id\": \"603eae21eec798982293ad2f\", \"user_id\": \"6017edf6eec798982293a936\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"71599\", \"quantity_in_asset\": \"715.99000\", \"quantity\": \"715.99\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-02 22:29:05\", \"date_modified\": \"2021-03-02 22:32:07\"}, {\"_id\": \"603da32feec798982293ad1a\", \"user_id\": \"6017edf6eec798982293a965\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"33.33333\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b185\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-02 03:30:07\", \"date_modified\": \"2021-03-02 03:32:22\"}, {\"_id\": \"603c51afeec798982293ad16\", \"user_id\": \"6017edf6eec798982293a965\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"16.66667\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b184\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-03-01 03:30:07\", \"date_modified\": \"2021-03-01 03:31:31\"}, {\"_id\": \"603b143beec798982293ad02\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"25000\", \"quantity_in_asset\": \"62.50000\", \"quantity\": \"250.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b183\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-28 04:55:39\", \"date_modified\": \"2021-02-28 04:57:55\"}, {\"_id\": \"603b002feec798982293ad12\", \"user_id\": \"6017edf6eec798982293a965\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"11.11111\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b182\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-28 03:30:07\", \"date_modified\": \"2021-02-28 03:32:15\"}, {\"_id\": \"6039c2bbeec798982293acfe\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"400.00000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b181\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-27 04:55:39\", \"date_modified\": \"2021-02-27 04:56:12\"}, {\"_id\": \"6039998beec798982293ad0e\", \"user_id\": \"6017edf6eec798982293a963\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"50.00000\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b180\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-27 01:59:55\", \"date_modified\": \"2021-02-27 02:02:55\"}, {\"_id\": \"6038713beec798982293acfd\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"6.25000\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b17f\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"pending\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-26 04:55:39\", \"date_modified\": \"2021-02-26 04:56:39\"}, {\"_id\": \"6038480beec798982293ad0a\", \"user_id\": \"6017edf6eec798982293a963\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"400.00000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b17e\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-26 01:59:55\", \"date_modified\": \"2021-02-26 02:02:34\"}, {\"_id\": \"60371fbbeec798982293acf9\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"400.00000\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b17d\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-25 04:55:39\", \"date_modified\": \"2021-02-25 04:58:30\"}, {\"_id\": \"6036f68beec798982293ad06\", \"user_id\": \"6017edf6eec798982293a963\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"500.00000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b17c\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-25 01:59:55\", \"date_modified\": \"2021-02-25 02:02:48\"}, {\"_id\": \"6035ce3beec798982293acf8\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"350.00000\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b17b\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"pending\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-24 04:55:39\", \"date_modified\": \"2021-02-24 04:57:23\"}, {\"_id\": \"60347cbbeec798982293acf4\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"abnamro\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"20000\", \"quantity_in_asset\": \"66.66667\", \"quantity\": \"200.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b17a\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-23 04:55:39\", \"date_modified\": \"2021-02-23 04:57:40\"}, {\"_id\": \"60332b3beec798982293acf0\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"300.00000\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b179\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-22 04:55:39\", \"date_modified\": \"2021-02-22 04:58:44\"}, {\"_id\": \"6031d9bbeec798982293acec\", \"user_id\": \"6017edf6eec798982293a962\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"ing\", \"base_asset\": \"msc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"700.00000\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b178\", \"strategy_name\": \"johnsonjoshua.bot\", \"strategy_id\": \"6017edf7eec798982293a99b\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-21 04:55:39\", \"date_modified\": \"2021-02-21 04:55:59\"}, {\"_id\": \"602eb267eec798982293ace8\", \"user_id\": \"6017edf6eec798982293a961\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"5000\", \"quantity_in_asset\": \"150.00000\", \"quantity\": \"50.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b177\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-18 19:31:03\", \"date_modified\": \"2021-02-18 19:33:34\"}, {\"_id\": \"602e2a8aeec798982293ad6d\", \"user_id\": \"6017edf6eec798982293a93a\", \"method\": \"bank\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"internal\", \"bank_name\": \"internal\", \"base_asset\": \"trx\", \"quantity_in_fiat\": \"9202\", \"quantity_in_asset\": \"828.18000\", \"quantity\": \"92.02\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"\", \"strategy_name\": \"michael58.bot\", \"strategy_id\": \"6017edf7eec798982293a99a\", \"order_status\": \"approved\", \"trans_direction\": \"intern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-18 09:51:22\", \"date_modified\": \"2021-02-18 09:53:51\"}, {\"_id\": \"60285323eec798982293ace4\", \"user_id\": \"6017edf6eec798982293a95e\", \"method\": \"ideal\", \"coin\": \"eur\", \"exchange\": \"binance\", \"bank\": \"external\", \"bank_name\": \"bunq\", \"base_asset\": \"ppc\", \"quantity_in_fiat\": \"10000\", \"quantity_in_asset\": \"14.28571\", \"quantity\": \"100.00\", \"intern_address\": \"\", \"extern_address\": \"\", \"transaction_id\": \"6017edf8eec798982293b176\", \"strategy_name\": \"mpowers.bot\", \"strategy_id\": \"6017edf7eec798982293a99e\", \"order_status\": \"approved\", \"trans_direction\": \"extern-transfer\", \"fee\": \"0.200000\", \"comment\": \"\", \"sandbox\": false, \"ip\": \"212.187.38.92\", \"date_added\": \"2021-02-13 23:30:59\", \"date_modified\": \"2021-02-13 23:32:08\"}]}")

    def test_get_deposit_mutation_0(self):
        task = transaction_service.get_deposit.s(
            '60347cbbeec798982293acf4'
        ).apply()
        self.assertEqual(task.result, {"_id": "60347cbbeec798982293acf4", "user_id": "6017edf6eec798982293a962", "method": "ideal", "coin": "eur", "exchange": "binance", "bank": "external", "bank_name": "abnamro", "base_asset": "msc", "quantity_in_fiat": "20000", "quantity_in_asset": "66.66667", "quantity": "200.00", "intern_address": "", "extern_address": "", "transaction_id": "24fe709f846916e451329d4e7585b814d491981e", "strategy_name": "johnsonjoshua.bot", "strategy_id": "6017edf7eec798982293a99b", "order_status": "approved", "trans_direction": "extern-transfer", "fee": "0.200000", "comment": "", "sandbox": False, "ip": "212.187.38.92", "date_added": 1614048939, "date_modified": "2021-02-23 04:57:40", "provider": "paynl", "payment_reference": "20a01657461d482493964fcd2f246ebd5b87e419", "payment_url": "https://ideal.abnamro.com/?authorisationId=803169858395&transactionId=6286623891844269", "order_id": "566684babbc3ab110b10c240f19f02cda3a94ea8", "error_id": "", "error_message": "", "ext_trans_id": "24fe709f846916e451329d4e7585b814d491981e"})

    def test_get_funded_accounts_mutation_1(self):
        task = transaction_service.get_funded_accounts.s(
            1612220400, None
        ).apply()
        self.assertEqual(task.result, {"total_elements": 5, "content": [{"_id": "6017edf6eec798982293a965"}, {"_id": "6017edf6eec798982293a963"}, {"_id": "6017edf6eec798982293a962"}, {"_id": "6017edf6eec798982293a961"}, {"_id": "6017edf6eec798982293a95e"}]})

    def test_get_lost_accounts_count_mutation_1(self):
        task = transaction_service.get_lost_accounts_count.s(
            begin=None, end=None
        ).apply()
        self.assertEqual(task.result, [{"_id": "Lost accounts", "count": 0}])

    def test_get_funded_accounts_count_mutation_1(self):
        task = transaction_service.get_funded_accounts_count.s(
            begin=None, end=None
        ).apply()
        self.assertEqual(task.result, [{"_id": "Funded accounts", "count": 34}, {"_id": "Zero accounts", "count": 5}])

if __name__ == '__main__':
    unittest.main(verbosity=2)